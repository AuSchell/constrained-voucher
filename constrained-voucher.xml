<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.13 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC7049 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7049.xml">
<!ENTITY I-D.ietf-core-yang-cbor SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-yang-cbor.xml">
<!ENTITY I-D.ietf-core-sid SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-sid.xml">
<!ENTITY RFC7950 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml">
<!ENTITY RFC5652 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5652.xml">
<!ENTITY RFC8152 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8152.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8366 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8366.xml">
<!ENTITY RFC3688 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3688.xml">
<!ENTITY RFC6020 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6020.xml">
<!ENTITY I-D.ietf-anima-bootstrapping-keyinfra SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-anima-bootstrapping-keyinfra.xml">
<!ENTITY I-D.ietf-ace-coap-est SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ace-coap-est.xml">
<!ENTITY I-D.ietf-netmod-yang-tree-diagrams SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-netmod-yang-tree-diagrams.xml">
<!ENTITY RFC6690 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6690.xml">
<!ENTITY RFC7030 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-ietf-anima-constrained-voucher-06" category="std">

  <front>
    <title abbrev="Constrained Voucher">Constrained Voucher Artifacts for Bootstrapping Protocols</title>

    <author initials="M." surname="Richardson" fullname="Michael Richardson">
      <organization>Sandelman Software Works</organization>
      <address>
        <email>mcr+ietf@sandelman.ca</email>
      </address>
    </author>
    <author initials="P." surname="van der Stok" fullname="Peter van der Stok">
      <organization>vanderstok consultancy</organization>
      <address>
        <email>consultancy@vanderstok.org</email>
      </address>
    </author>
    <author initials="P." surname="Kampanakis" fullname="Panos Kampanakis">
      <organization>Cisco Systems</organization>
      <address>
        <email>pkampana@cisco.com</email>
      </address>
    </author>

    <date year="2020" month="January" day="14"/>

    <area>Internet</area>
    <workgroup>anima Working Group</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a strategy to securely assign a pledge to an
owner, using an artifact signed, directly or indirectly, by the
pledge’s manufacturer.  This artifact is known as a “voucher”.</t>

<t>This document builds upon the work in <xref target="RFC8366"/>, encoding
the resulting artifact in CBOR.  Use with two signature technologies are
described.</t>

<t>Additionally, this document explains how constrained vouchers may be
transported as an extension to the <xref target="I-D.ietf-ace-coap-est"/> protocol.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>Enrollment of new nodes into constrained networks with constrained nodes
present unique challenges.</t>

<t>There are bandwidth and code space issues to contend.  A solution such as
<xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> may be too large in terms of
code space or bandwidth required.</t>

<t>This document defines a constrained version of <xref target="RFC8366"/>.
Rather than serializing the YANG definition in JSON, it is serialized into
CBOR (<xref target="RFC7049"/>).</t>

<t>This document follows a similar, but not identical structure as
<xref target="RFC8366"/>. Some sections are left out entirely.
Additional sections have been added concerning:</t>

<t><list style="numbers">
  <t>Addition of voucher-request specification as defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>,</t>
  <t>Addition to <xref target="I-D.ietf-ace-coap-est"/> of voucher transport requests over CoAP.</t>
</list></t>

<t>The CBOR definitions for this constrained voucher format are defined using
the mechanism describe in <xref target="I-D.ietf-core-yang-cbor"/> using the SID
mechanism explained in <xref target="I-D.ietf-core-sid"/>.  As the tooling to convert
YANG documents into an list of SID keys is still in its infancy, the table of
SID values presented here should be considered normative rather than the
output of the pyang tool.</t>

<t>Two methods of signing the resulting CBOR object are described in this
document:</t>

<t><list style="numbers">
  <t>One is CMS <xref target="RFC5652"/>.</t>
  <t>The other is COSE_Sign1 <xref target="RFC8152"/> objects.</t>
</list></t>

</section>
<section anchor="Terminology" title="Terminology">

<t>The following terms are defined in <xref target="RFC8366"/>, and are used
identically as in that document: artifact, imprint, domain, Join
Registrar/Coordinator (JRC), Manufacturer Authorized Signing Authority
(MASA), pledge, Trust of First Use (TOFU), and Voucher.</t>

</section>
<section anchor="reqlang" title="Requirements Language">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL
NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”,
“MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they
appear in all capitals, as shown here.</t>

</section>
<section anchor="survey-of-voucher-types" title="Survey of Voucher Types">

<t><xref target="RFC8366"/> provides for vouchers that assert proximity, that
authenticate the registrar and that include different amounts of anti-replay
protection.</t>

<t>This document does not make any extensions to the types of vouchers.</t>

<t>Time based vouchers are included in this definition, but given that
constrained devices are extremely unlikely to have accurate time, their
use is very unlikely.  Most users of these constrained vouchers will be
online and will use live nonces to provide anti-replay protection.</t>

<t><xref target="RFC8366"/> defined only the voucher artifact, and not the
Voucher Request artifact, which was defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<t>This document defines both a constrained voucher and a constrained voucher-request.
They are presented in the order voucher-request, followed by a voucher response
as this is the time order that they occur.</t>

<t>This document defines both CMS-signed voucher requests and responses, and
COSE signed voucher requests and responses.
The use of CMS signatures implies the use of PKIX format certificates.
The pinned-domain-cert present in such a voucher, is the certificate of the Registrar.</t>

<t>The constrained voucher and constrained voucher request MUST be signed.</t>

<t>The use of the two signing formats permit the use of both PKIX format certificates,
and raw public keys (RPK).  When RPKs are used, the voucher produced by
the MASA pins the raw public key of the Registrar: the
pinned-domain-subject-public-key-info in such a voucher, is the raw public
key of the Registrar.
This is described in the YANG definition for the constrained voucher.</t>

</section>
<section anchor="discovery-and-uri" title="Discovery and URI">

<t>This section describes the BRSKI extensions to EST-coaps
<xref target="I-D.ietf-ace-coap-est"/> to transport the voucher between registrar,
proxy and pledge over CoAP. The extensions are targeted to low-resource
networks with small packets. Saving header space is important and the
EST-coaps URI is shorter than the EST URI.</t>

<t>The presence and location of (path to) the management data are discovered by
sending a GET request to “/.well-known/core” including a resource type (RT)
parameter with the value “ace.est” <xref target="RFC6690"/>. Upon success, the return
payload will contain the root resource of the EST resources. It is up to the
implementation to choose its root resource; throughout this document the
example root resource /est is used.</t>

<t>The EST-coaps server URIs differ from the EST URI by replacing the scheme
https by coaps and by specifying shorter resource path names:</t>

<figure><artwork><![CDATA[
  coaps://www.example.com/est/short-name
]]></artwork></figure>

<t>Figure 5 in section 3.2.2 of <xref target="RFC7030"/> enumerates the operations and
corresponding paths which are supported by EST. <xref target="est-uri"/> provides the
mapping from the BRSKI extension URI path to the EST-coaps URI path.</t>

<texttable title="BRSKI path to EST-coaps path" anchor="est-uri">
      <ttcol align='left'>BRSKI</ttcol>
      <ttcol align='left'>EST-coaps</ttcol>
      <c>/requestvoucher</c>
      <c>/rv</c>
      <c>/voucher_status</c>
      <c>/vs</c>
      <c>/enrollstatus</c>
      <c>/es</c>
      <c>/requestauditlog</c>
      <c>/ra</c>
</texttable>

<t>/requestvoucher, /voucher_status and /enrollstatus are needed between
pledge and Registrar.</t>

<t>When discovering the root path for the EST resources, the server MAY return
the full resource paths and the used content types. This is useful when
multiple content types are specified for EST-coaps server. For example, the
following more complete response is possible.</t>

<figure><artwork><![CDATA[
  REQ: GET /.well-known/core?rt=ace.est*

  RES: 2.05 Content
  </est>; rt="ace.est"
  </est/rv>; rt="ace.est/rv";ct=TBD2 TBD3
  </est/vs>; rt="ace.est/vs";ct=50 60
  </est/es>; rt="ace.est/es";ct=50 60
  </est/ra>; rt="ace.est/ra";ct=TBD2 TBD3
]]></artwork></figure>

<t>The return of the content-types allows the client to choose the most appropriate one from multiple content types.</t>

<t>ct=TBD2 stands for Content-Format “application/voucher-cms+cbor,
and ct=TBD3 stands for Content-Format “application/voucher-cose+cbor”.</t>

<t>Content-Formats TBD2 and TBD3 are defined in this document.</t>

<t>The Content-Format (“application/json”) 50 MAY be supported.
Content-Formats (“application/cbor”) 60, TBD2, and TBD3 MUST be supported.</t>

</section>
<section anchor="artifacts" title="Artifacts">

<t>This section describes the abstract (tree) definition as explained
in <xref target="I-D.ietf-netmod-yang-tree-diagrams"/> first.  This provides a high-level
view of the contents of each artifact.</t>

<t>Then the assigned SID values are presented. These have been assigned using
the rules in <xref target="I-D.ietf-core-sid"/>, with an allocation that was made
via the http://comi.space service.</t>

<section anchor="voucher-request-artifact" title="Voucher Request artifact">

<section anchor="tree-diagram" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with the addition of proximity-registrar-subject-public-key-info,
proximity-registrar-cert, and prior-signed-voucher-request.</t>

<t>prior-signed-voucher-request is only used between the Registrar and the MASA.
proximity-registrar-subject-public-key-info replaces proximity-registrar-cert
for the extremely constrained cases.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher-request

  grouping voucher-request-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion
       |       enumeration
       +-- serial-number
       |       string
       +-- idevid-issuer?
       |       binary
       +-- pinned-domain-cert?
       |       binary
       +-- domain-cert-revocation-checks?
       |       boolean
       +-- nonce?
       |       binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- proximity-registrar-subject-public-key-info?
       |       binary
       +-- proximity-registrar-sha256-of-subject-public-key-info?
       |       binary
       +-- proximity-registrar-cert?
       |       binary
       +-- prior-signed-voucher-request?
               binary
]]></artwork></figure>

</section>
<section anchor="sid-values" title="SID values">

<figure><artwork><![CDATA[
           
      SID Assigned to
--------- -------------------------------------------------- 
     2501 data /ietf-constrained-voucher-request:voucher
     2502 data .../assertion
     2503 data .../created-on
     2504 data .../domain-cert-revocation-checks
     2505 data .../expires-on
     2506 data .../idevid-issuer
     2507 data .../last-renewal-date
     2508 data /ietf-constrained-voucher-request:voucher/nonce
     2509 data .../pinned-domain-cert
     2510 data .../prior-signed-voucher-request
     2511 data .../proximity-registrar-cert
     2512 data mity-registrar-sha256-of-subject-public-key-info
     2513 data .../proximity-registrar-subject-public-key-info
     2514 data .../serial-number
           
]]></artwork></figure>

</section>
<section anchor="yang-module" title="YANG Module">

<t>In the constrained-voucher-request YANG module, the voucher is “augmented” within the “used” grouping statement such that one continuous set of SID values is generated for the constrained-voucher-request module name, all voucher attributes, and the constrained-voucher-request attribute. Two attributes of the voucher are “refined” to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher-request@2019-09-01.yang"
module ietf-constrained-voucher-request {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
  description
   "This module defines the format for a voucher request,
    which is produced by a pledge to request a voucher.
    The voucher-request is sent to the potential owner's
    Registrar, which in turn sends the voucher request to
    the manufacturer or delegate (MASA).

    A voucher is then returned to the pledge, binding the
    pledge to the owner.  This is a constrained version of the
    voucher-request present in
    draft-ietf-anima-bootstrap-keyinfra.txt.

    This version provides a very restricted subset appropriate
    for very constrained devices.
    In particular, it assumes that nonce-ful operation is
    always required, that expiration dates are rather weak, as no
    clocks can be assumed, and that the Registrar is identified
    by a pinned Raw Public Key.

    The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
    'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
    and 'OPTIONAL' in the module text are to be interpreted as
    described in RFC 2119.";

  revision "2019-09-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-request-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-request-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-request-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }


      augment "voucher" {
        description "Base the constrained voucher-request upon the
          regular one";

        leaf proximity-registrar-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-subject-public-key-info replaces
 	     the proximit-registrar-cert in constrained uses of
             the voucher-request.
             The proximity-registrar-subject-public-key-info is the
             Raw Public Key of the Registrar. This field is encoded
             as specified in RFC7250, section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is MAY, but due to 
             size is discouraged.";
        }

        leaf proximity-registrar-sha256-of-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-sha256-of-subject-public-key-info
             is an alternative to 
             proximity-registrar-subject-public-key-info.
             and pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement protocol, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash
             types.";
        }

        leaf proximity-registrar-cert {
          type binary;
          description
            "An X.509 v3 certificate structure as specified by
             RFC 5280,
             Section 4 encoded using the ASN.1 distinguished encoding
             rules (DER), as specified in ITU-T X.690.

             The first certificate in the Registrar TLS server
             certificate_list sequence  (see [RFC5246]) presented by
             the Registrar to the Pledge. This MUST be populated in a
             Pledge's voucher request if the proximity assertion is
             populated.";
        }

        leaf prior-signed-voucher-request {
          type binary;
          description
            "If it is necessary to change a voucher, or re-sign and
             forward a voucher that was previously provided along a
             protocol path, then the previously signed voucher
             SHOULD be included in this field.

             For example, a pledge might sign a proximity voucher,
             which an intermediate registrar then re-signs to
             make its own proximity assertion.  This is a simple
             mechanism for a chain of trusted parties to change a
             voucher, while maintaining the prior signature
             information.

             The pledge MUST ignore all prior voucher information
             when accepting a voucher for imprinting. Other
             parties MAY examine the prior signed voucher
             information for the purposes of policy decisions.
             For example this information could be useful to a
             MASA to determine that both pledge and registrar
             agree on proximity assertions. The MASA SHOULD
             remove all prior-signed-voucher-request information when
             signing a voucher for imprinting so as to minimize the
             final voucher size.";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example2" title="Example voucher request artifact">

<t>Below is a CBOR serialization of the constrained-voucher-request is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  2501: {
    +2 : "2016-10-07T19:31:42Z", / SID= 2503, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID= 2505, expires-on /
    +1 : 2,                      / SID= 2502, assertion /
                                 /                "proximity" /
    +13: "JADA123456789",        / SID= 2514, serial-number /
    +5 : h'01020D0F',            / SID= 2506, idevid-issuer /
    +10: h'01020D0F',            / SID=2511, proximity-registrar-cert/
    +3 : true,                   / SID= 2504, domain-cert
                                                  -revocation-checks/
    +6 : "2017-10-07T19:31:42Z", / SID= 2507, last-renewal-date /
    +12: h'01020D0F'             / SID= 2513, proximity-registrar
                                         -subject-public-key-info /
  }
}



]]></artwork></figure>

</section>
</section>
<section anchor="voucher-artifact" title="Voucher artifact">

<t>The voucher’s primary purpose is to securely assign a pledge to an
owner.  The voucher informs the pledge which entity it should
consider to be its owner.</t>

<t>This document defines a voucher that is a CBOR encoded instance of
the YANG module defined in Section 5.3 that has been signed with CMS
or with COSE.</t>

<section anchor="tree-diagram-1" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with only the addition of pinned-domain-subject-public-key-info.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher

  grouping voucher-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion                                   enumeration
       +-- serial-number                               string
       +-- idevid-issuer?                              binary
       +-- pinned-domain-cert?                         binary
       +-- domain-cert-revocation-checks?              boolean
       +-- nonce?                                      binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- pinned-domain-subject-public-key-info?      binary
       +-- pinned-sha256-of-subject-public-key-info?   binary
]]></artwork></figure>

</section>
<section anchor="sid-values-1" title="SID values">

<figure><artwork><![CDATA[
           
      SID Assigned to
--------- -------------------------------------------------- 
     2451 data /ietf-constrained-voucher:voucher
     2452 data /ietf-constrained-voucher:voucher/assertion
     2453 data /ietf-constrained-voucher:voucher/created-on
     2454 data .../domain-cert-revocation-checks
     2455 data /ietf-constrained-voucher:voucher/expires-on
     2456 data /ietf-constrained-voucher:voucher/idevid-issuer
     2457 data .../last-renewal-date
     2458 data /ietf-constrained-voucher:voucher/nonce
     2459 data .../pinned-domain-cert
     2460 data .../pinned-domain-subject-public-key-info
     2461 data .../pinned-sha256-of-subject-public-key-info
     2462 data /ietf-constrained-voucher:voucher/serial-number
           
]]></artwork></figure>

</section>
<section anchor="yang-module-1" title="YANG Module">

<t>In the constrained-voucher YANG module, the voucher is “augmented” within the “used” grouping statement such that one continuous set of SID values is generated for the constrained-voucher module name, all voucher attributes, and the constrained-voucher attribute. Two attributes of the voucher are “refined” to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher@2019-09-01.yang"
module ietf-constrained-voucher {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
description
  "This module defines the format for a voucher, which is produced
   by a pledge's manufacturer or delegate (MASA) to securely assign
   one or more pledges to an 'owner', so that the pledges may
   establis a secure connection to the owner's network
   infrastructure.

   This version provides a very restricted subset appropriate
   for very constrained devices.
   In particular, it assumes that nonce-ful operation is
   always required, that expiration dates are rather weak, as no
   clocks can be assumed, and that the Registrar is identified
   by a pinned Raw Public Key.

   The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
   'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
   and 'OPTIONAL' in the module text are to be interpreted as
   described in RFC 2119.";

  revision "2019-09-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }

      augment "voucher" {
        description "Base the constrained voucher
                                   upon the regular one";
        leaf pinned-domain-subject-public-key-info {
          type binary;
          description
            "The pinned-domain-subject-public-key-info replaces the
             pinned-domain-cert in constrained uses of
             the voucher. The pinned-domain-subject-public-key-info
             is the Raw Public Key of the Registrar.
             This field is encoded as specified in RFC7250,
             section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is a MAY.";
        }

        leaf pinned-sha256-of-subject-public-key-info {
          type binary;
          description
            "The pinned-hash-subject-public-key-info is a second
             alternative to pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement process, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash types";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example1" title="Example voucher artifacts">

<t>Below a the CBOR serialization of the constrained-voucher is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  2451: {
    +2 : "2016-10-07T19:31:42Z", / SID = 2453, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID = 2455, expires-on /
    +1 : 0,                      / SID = 2452, assertion /
                                 /                "verified" /
    +11: "JADA123456789",        / SID = 2462, serial-number /
    +5 : h'01020D0F',            / SID = 2456, idevid-issuer /
    +8 : h'01020D0F',            / SID = 2459, pinned-domain-cert/
    +3 : true,                   / SID = 2454, domain-cert
                                                 -revocation-checks /
    +6 : "2017-10-07T19:31:42Z", / SID = 2457, last-renewal-date /
    +9 : h'01020D0F'             / SID = 2460, pinned-domain
                                           -subject-public-key-info /
  }
}



]]></artwork></figure>

<t>The signing of the example is shown in <xref target="cmssign"/>.</t>

</section>
</section>
<section anchor="signing-voucher-and-voucher-request-artifacts" title="Signing voucher and voucher-request artifacts">

<section anchor="cms-signing" title="CMS signing">

<t>The IETF evolution of PKCS#7 is CMS <xref target="RFC5652"/>.  The CMS signed voucher is
much like the equivalent voucher defined in <xref target="RFC8366"/>.</t>

<t>A different eContentType of TBD1 is used to indicate that the contents are
in a different format than in <xref target="RFC8366"/>.  The id-ct-animaJSONVoucher
allocated by <xref target="RFC8366"/> indicates a voucher and voucher-request encoded in
JSON, and the new value TBD1 indicates that the voucher and voucher-request
are encoded in CBOR.</t>

<t>The ContentInfo structure contains a payload consisting of the CBOR encoded
voucher. The <xref target="I-D.ietf-core-yang-cbor"/> use of delta encoding creates a
canonical ordering for the keys on the wire.  This canonical ordering is not
important as there is no expectation that the content will be reproduced
during the validation process.</t>

<t>Normally the recipient is the pledge and the signer is the MASA.</t>

<t><xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> supports both signed and unsigned
voucher requests from the pledge to the JRC.
In this specification, voucher-request artifact MUST be signed from the
pledge to the registrar.  From the JRC to the MASA, the voucher-request
artifact MUST be signed by the domain owner key which is requesting
ownership.</t>

<t>The considerations of <xref target="RFC5652"/> section 5.1, concerning validating
CMS objects which are really PKCS7 objects (cmsVersion=1) applies.</t>

<t>The CMS structure SHOULD also contain all the certificates leading up
to and including the signer’s trust anchor certificate known to the
recipient.  The inclusion of the trust anchor is unusual in many
applications, but without it third parties can not accurately audit
the transaction.</t>

<t>The CMS structure MAY also contain revocation objects for any
intermediate certificate authorities (CAs) between the voucher-issuer
and the trust anchor known to the recipient.  However, the use of
CRLs and other validity mechanisms is discouraged, as the pledge is
unlikely to be able to perform online checks, and is unlikely to have
a trusted clock source.  As described below, the use of short-lived
vouchers and/or pledge provided nonce provides a freshness guarantee.</t>

<figure><artwork><![CDATA[
[EDnote: compulsory signing algorithms are ......]
]]></artwork></figure>

<t>In <xref target="cmssign"/> an example for the CMS signing of the voucher-request is shown.</t>

</section>
<section anchor="cose-signing" title="COSE signing">

<t>The COSE-Sign1 structure is discussed in section 4.2 of <xref target="RFC8152"></xref>. The CBOR
object that carries the body, the signature, and the
information about the body and signature is called the COSE_Sign1
structure. It is used when only one signature is used on the body.
Support for EdDSA with Ed25519 is compulsory.</t>

<t>The supported COSE-sign1 object stucture is shown in <xref target="fig-cose"/>.</t>

<figure title="cose-sign1 example" align="left" anchor="fig-cose"><artwork><![CDATA[
COSE_Sign1(
  [
    h'a10127',        # { "alg": EDdsa }
    {
      “kid” : h'789'  # hash(pblic key)
    },
    h'123', #voucher-request binary content
    h'456', #voucher-request binary public signature
  ]
)
]]></artwork></figure>

<t>The <xref target="COSE-registry"/> specifies the integers that replace the strings and the mnemonics in <xref target="fig-cose"/>. The value of the “kid” parameter is an example value. Usually a hash of the public key is used to idientify the public key. The distribution of the public key and its hash is done out of band.</t>

<t>In <xref target="cosesign"/> a binary cose-sign1 object is shown based on the voucher-request example of <xref target="example2"/>.</t>

</section>
</section>
</section>
<section anchor="design-considerations" title="Design Considerations">

<t>The design considerations for the CBOR encoding of vouchers is much the same
as for <xref target="RFC8366"/>.</t>

<t>One key difference is that the names of the leaves in the YANG does not have a
material effect on the size of the resulting CBOR, as the SID translation
process assigns integers to the names.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<section anchor="clock-sensitivity" title="Clock Sensitivity">

<t>TBD.</t>

</section>
<section anchor="protect-voucher-pki-in-hsm" title="Protect Voucher PKI in HSM">

<t>TBD.</t>

</section>
<section anchor="test-domain-certificate-validity-when-signing" title="Test Domain Certificate Validity when Signing">

<t>TBD.</t>

</section>
</section>
<section anchor="iana-considerations" title="IANA Considerations">

<section anchor="resource-type-registry" title="Resource Type Registry">

<t>Additions to the sub-registry “CoAP Resource Type”, within the “CoRE parameters” registry are specified below. These can be registered  either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
 ace.rt.rv needs registration with IANA
 ace.rt.vs needs registration with IANA
 ace.rt.es needs registration with IANA
 ace.rt.ra needs registration with IANA
]]></artwork></figure>

</section>
<section anchor="the-ietf-xml-registry" title="The IETF XML Registry">

<t>This document registers two URIs in the IETF XML registry <xref target="RFC3688"/>.
Following the format in <xref target="RFC3688"/>, the following registration is
requested:</t>

<figure><artwork><![CDATA[
  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.

  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.
]]></artwork></figure>

</section>
<section anchor="the-yang-module-names-registry" title="The YANG Module Names Registry">

<t>This document registers two YANG modules in the YANG Module Names
registry <xref target="RFC6020"/>.  Following the format defined in <xref target="RFC6020"/>, the
the following registration is requested:</t>

<figure><artwork><![CDATA[
  name:         ietf-constrained-voucher
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  prefix:       vch
  reference:    RFC XXXX

  name:         ietf-constrained-voucher-request
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained
                                           -voucher-request
  prefix:       vch
  reference:    RFC XXXX
]]></artwork></figure>

</section>
<section anchor="the-rfc-sid-range-assignment-sub-registry" title="The RFC SID range assignment sub-registry">

<figure><artwork><![CDATA[
------------ ------ --------------------------- ------------
Entry-point | Size | Module name               | RFC Number
------------ ------ --------------------------- ------------
2450          50     ietf-constrained-voucher    [ThisRFC]
2500          50     ietf-constrained-voucher    [ThisRFC}
                                 -request
----------- ------  --------------------------- ------------
]]></artwork></figure>

<t>Warning: These SID values are defined in <xref target="I-D.ietf-core-sid"/>.</t>

</section>
<section anchor="the-smi-security-for-smime-cms-content-type-registry" title="The SMI Security for S/MIME CMS Content Type Registry">

<t>This document registers an OID in the “SMI Security for S/MIME CMS
Content Type” registry (1.2.840.113549.1.9.16.1), with the value:</t>

<figure><artwork><![CDATA[
  Decimal  Description                             References
  -------  --------------------------------------  ----------
  TBD1      id-ct-animaCBORVoucher                 [ThisRFC]
]]></artwork></figure>

<t>EDNOTE: should a separate value be used for Voucher Requests?</t>

</section>
<section anchor="media-type-registry" title="Media-Type Registry">

<t>This section registers the ‘application/voucher-cms+cbor’ media type and the ‘application/voucher-cose+cbor’ in the
“Media Types” registry.  These media types are used to indicate that
the content is a CBOR voucher either signed with a cms structure or a COSE_Sign1 structure <xref target="RFC8152"></xref>.</t>

<section anchor="applicationvoucher-cmscbor" title="application/voucher-cms+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cms+cbor
Required parameters:  none
Optional parameters:  none
Encoding considerations:  CMS-signed CBOR vouchers are CBOR
  encoded.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
<section anchor="applicationvoucher-cosecbor" title="application/voucher-cose+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cose+cbor
Required parameters:  none
Optional parameters:  cose-type
Encoding considerations:  COSE_Sign1 CBOR vouchers are COSE objects
                          signed with one signer.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
</section>
<section anchor="coap-content-format-registry" title="CoAP Content-Format Registry">

<t>Additions to the sub-registry “CoAP Content-Formats”, within the “CoRE
Parameters” registry are needed for two media types. These can be registered
either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
Media type                    mime type    Encoding   ID  References
----------------------------  -----------  --------- ---- ----------
application/voucher-cms+cbor      - -        CBOR    TBD2  [This RFC]
application/voucher-cose+cbor "COSE-Sign1"   CBOR    TBD3  [This RFC]
]]></artwork></figure>

</section>
</section>
<section anchor="acknowledgements" title="Acknowledgements">

<t>We are very grateful to Jim Schaad for explaining COSE and CMS choices. Also thanks to Jim Schaad for correctinging earlier version of the COSE Sign1 objects.</t>

<t>Michel Veillette did extensive work on pyang to extend it to support the
SID allocation process, and this document was among the first users.</t>

<t>We are grateful for the suggestions done by Esko Dijk.</t>

</section>
<section anchor="changelog" title="Changelog">

<t>-06
    New SID values assigned; regenerated examples</t>

<t>-04
    voucher and request-voucher MUST be signed
    examples for signed request are added in appendix
    IANA SID registration is updated
    SID values in examples are aligned
    signed cms examples aligned with new SIDs</t>

<t>-03</t>

<figure><artwork><![CDATA[
Examples are inverted.
]]></artwork></figure>

<t>-02</t>

<figure><artwork><![CDATA[
Example of requestvoucher with unsigned appllication/cbor is added
attributes of voucher "refined" to optional
CBOR serialization of vouchers improved
Discovery port numbers are specified
]]></artwork></figure>

<t>-01</t>

<figure><artwork><![CDATA[
application/json is optional, application/cbor is compulsory
Cms and cose mediatypes are introduced
]]></artwork></figure>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC7049;
&I-D.ietf-core-yang-cbor;
&I-D.ietf-core-sid;
&RFC7950;
&RFC5652;
&RFC8152;
&RFC8174;
&RFC8366;
&RFC3688;
&RFC6020;
&I-D.ietf-anima-bootstrapping-keyinfra;
&I-D.ietf-ace-coap-est;


    </references>

    <references title='Informative References'>

&I-D.ietf-netmod-yang-tree-diagrams;
<reference anchor="COSE-registry" target="https://www.iana.org/assignments/cose/cose.xhtml">
  <front>
    <title>CBOR Object Signing and Encryption (COSE) registry</title>
    <author initials="." surname="IANA">
      <organization></organization>
    </author>
    <date year="2017"/>
  </front>
</reference>
&RFC6690;
&RFC7030;


    </references>


<section anchor="est-messages-to-est-coaps" title="EST messages to EST-coaps">

<t>This section extends the examples from Appendix A of <xref target="I-D.ietf-ace-coap-est"/>. The CoAP headers are only worked out for the enrollstatus example.</t>

<section anchor="es" title="enrollstatus">

<t>A coaps enrollstatus message can be :</t>

<figure><artwork><![CDATA[
    GET coaps://[192.0.2.1:8085]/est/es
]]></artwork></figure>

<t>The corresponding coap header fields are shown below.</t>

<figure><artwork><![CDATA[
  Ver = 1
  T = 0 (CON)
  Code = 0x01 (0.01 is GET)
  Options
   Option  (Uri-Path)
     Option Delta = 0xb   (option nr = 11)
     Option Length = 0x3
     Option Value = "est"
   Option  (Uri-Path)
     Option Delta = 0x0   (option nr = 11)
     Option Length = 0x2
     Option Value = "es"
  Payload = [Empty]
]]></artwork></figure>

<t>The Uri-Host and Uri-Port Options are omitted because they coincide with the transport protocol destination address and port respectively.</t>

<t>A 2.05 Content response with an unsigned voucher status (ct=60) will then be:</t>

<figure><artwork><![CDATA[
   2.05 Content (Content-Format: application/cbor)
]]></artwork></figure>

<t>With CoAP fields and payload:</t>

<figure><artwork><![CDATA[
   Ver=1
   T=2 (ACK)
   Code = 0x45 (2.05 Content)
   Options
     Option1 (Content-Format)
     Option Delta = 0xC  (option nr 12)
     Option Length = 0x2
     Option Value = 60 (application/cbor)

     Payload (CBOR diagnostic) =
     {
     "version":"1",
     "Status": 1,   / 1 = Success, 0 = Fail  /
     "Reason":"Informative human readable message",
     "reason-context": "Additional information"
     }
]]></artwork></figure>

<t>The binary payload is:</t>

<figure><artwork><![CDATA[
     A46776657273696F6E6131665374617475730166526561736F6E7822
     496E666F726D61746976652068756D616E207265616461626C65206D
     6573736167656e726561736F6E2D636F6E74657874
     764164646974696F6E616C20696E666F726D6174696F6E
]]></artwork></figure>

<t>The binary payload disassembles to the above CBOR diagnostic code.</t>

</section>
<section anchor="voucherstatus" title="voucher_status">

<t>A coaps voucher_status message can be:</t>

<figure><artwork><![CDATA[
   GET coaps://[2001:db8::2:1]:61616]/est/vs
]]></artwork></figure>

<t>A 2.05 Content response with a non signed CBOR voucher status (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
    A46776657273696F6E6131665374617475730166526561736F6E7822
    496E666F726D61746976652068756D616E207265616461626C65206D
    6573736167656e726561736F6E2D636F6E74657874
    764164646974696F6E616C20696E666F726D6174696F6E
]]></artwork></figure>

</section>
<section anchor="requestvoucher" title="requestvoucher">

<t>Signed request-voucher-request payloads are sent from pledge to Registrar, as explained in Section 5.2 of <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<section anchor="rv" title="signed requestvoucher">

<t>A CMS signed requestvoucher message from JRC to MASA is shown below.
It would be CoAP POSTED to /est/rv.</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/rv
    (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>

<t>The payload would be in binary, but is presented in base64 in this document.</t>

<figure><artwork><![CDATA[
MIIDugYJKoZIhvcNAQcCoIIDqzCCA6cCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggE/MIIBOwIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODEwNDgzNlowLwYJKoZIhvcNAQkEMSIEILEdCTOLs2Zy7w3LgvSZ
XZEadz3LbznoFBs6FMFN91RaMAoGCCqGSM49BAMCBEcwRQIgASjDsIpr0tW/
n6dRHqvvqsqgZlHbtFnErUbWfhS0KD4CIQDDUEqc5wTmRGf0adEQVQzqmIgh
MEgF10vqXv02gL1jLw==
]]></artwork></figure>

<t>A 2.04 Changed response returning CBOR voucher signed with a cms structure(ct=TBD2) will then be:</t>

<figure><artwork><![CDATA[
    2.04 Changed (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>
<figure><artwork><![CDATA[
MIIDuwYJKoZIhvcNAQcCoIIDrDCCA6gCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggFAMIIBPAIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODA3MzQxMFowLwYJKoZIhvcNAQkEMSIEIP2rKa+J8LVdwYEmB2he
uxsz05As0zoAAYkeyNqsh4fiMAoGCCqGSM49BAMCBEgwRgIhALOd2FKbe9FG
kN4Pg7FIgF+//cQv/N+v7tDZMzGBAFN0AiEAu5BI0oQ4o0wZcrDyKoU2GbeX
hlG/g+OgTUftYMJ32so=
]]></artwork></figure>

</section>
</section>
<section anchor="ra" title="requestauditing">

<t>A coaps requestauditing message contains the signed CBOR voucher :</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/ra
    (Content-Format: application/voucher-cms+cbor)
    Payload =
TO BE FILLED
]]></artwork></figure>

<t>A 2.05 Content response returning a log of the voucher (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
{
 "version":"1",
 "events":[
   {
    "date":"<date/time of the entry>",
    "domainID":"<domainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
    "truncated":"<the number of domainID entries truncated>"
   },
   {
    "date":"<date/time of the entry>",
    "domainID":"<anotherDomainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
   }
 ],
  "truncation": {
    "nonced duplicates": "<total number of entries truncated>",
    "nonceless duplicates": "<total number of entries truncated>",
    "arbitrary": "<number of domainID entries removed entirely>"
  }
}

    [EDNOTE: Change JSON to CBOR; Serialize CBOR payload to binary]
]]></artwork></figure>

</section>
</section>
<section anchor="signed-voucher-request-examples" title="Signed voucher-request examples">

<section anchor="cmssign" title="CMS signed voucher-request example">

<t>The voucher-request example, visualized in CBOR diagnostic notation in <xref target="example2"/> is shown as a hexadecimal dump of the binary file.</t>

<figure><artwork><![CDATA[
    a11909c5a90274323031362d31302d30375431393a33313a34325a0474323031
    362d31302d32315431393a33313a34325a01020d6d4a414441313233343536
    373839054401020d0f0a4401020d0f03f50674323031372d31302d30375431
    393a33313a34325a0c4401020d0f
]]></artwork></figure>

<t>The voucher-request example has been signed by using the WT1234 certificate and key pair shown in Appendix C of <xref target="I-D.ietf-ace-coap-est"/>.
The CMS signing of the binary voucher-request leads to a binary signed voucher-request, shown with a hexadecimal representation shown in the payload of the request part of <xref target="rv"/> and <xref target="ra"/>.</t>

<t>The breakdown of the CMS signed binary voucher-request file is visualized below:</t>

<figure><artwork><![CDATA[
CMS_ContentInfo:
  contentType: pkcs7-signedData (1.2.840.113549.1.7.2)
  d.signedData:
    version: 1
    digestAlgorithms:
        algorithm: sha256 (2.16.840.1.101.3.4.2.1)
        parameter: <ABSENT>
    encapContentInfo:
      eContentType: pkcs7-data (1.2.840.113549.1.7.1)
      eContent: <ABSENT>
    certificates:
      d.certificate:
        cert_info:
          version: 2
          serialNumber: 9112578475118446130
          signature:
            algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
            parameter: <ABSENT>
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                  CN=802.1AR CA
          validity:
            notBefore: Jan 31 11:29:16 2019 GMT
            notAfter: Dec 31 23:59:59 9999 GMT
          subject: C=US, ST=CA, L=LA, O=example Inc,
                                     OU=IoT/serialNumber=Wt1234
          key:
            algor:
              algorithm: id-ecPublicKey (1.2.840.10045.2.1)
              parameter: OBJECT:prime256v1 (1.2.840.10045.3.1.7)
            public_key:  (0 unused bits)
              0000 - 04 c8 b4 21 f1 1c 25 e4-7e 3a c5 71 23 bf
              000e - 2d 9f dc 49 4f 02 8b c3-51 cc 80 c0 3f 15
              001c - 0b f5 0c ff 95 8d 75 41-9d 81 a6 a2 45 df
              002a - fa e7 90 be 95 cf 75 f6-02 f9 15 26 18 f8
              0038 - 16 a2 b2 3b 56 38 e5 9f-d9
          issuerUID: <ABSENT>
          subjectUID: <ABSENT>
          extensions:
              object: X509v3 Basic Constraints (2.5.29.19)
              critical: BOOL ABSENT
              value:
                0000 - 30
                0002 - <SPACES/NULS>

              object: X509v3 Subject Key Identifier (2.5.29.14)
              critical: BOOL ABSENT
              value:
                0000 - 04 14 96 60 0d 87 16 bf-7f d0 e7 52 d0
                000d - ac 76 07 77 ad 66 5d 02-a0

              object: X509v3 Authority Key Identifier (2.5.29.35)
              critical: BOOL ABSENT
              value:
                0000 - 30 16 80 14 68 d1 65 51-f9 51 bf c8 2a
                000d - 43 1d 0d 9f 08 bc 2d 20-5b 11 60

              object: X509v3 Key Usage (2.5.29.15)
              critical: TRUE
              value:
                0000 - 03 02 05 a0

              object: X509v3 Subject Alternative Name (2.5.29.17)
              critical: BOOL ABSENT
              value:
                0000 - 30 21 a0 1f 06 08 2b 06-01 05 05 07 08
                000d - 04 a0 13 30 11 06 09 2b-06 01 04 01 b4
                001a - 3b 0a 01 04 04 01 02 03-04
        sig_alg:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:  (0 unused bits)
          0000 - 30 46 02 21 00 c0 d8 19-96 d2 50 7d 69 3f 3c
          000f - 48 ea a5 ee 94 91 bd a6-db 21 40 99 d9 81 17
          001e - c6 3b 36 13 74 cd 86 02-21 00 a7 74 98 9f 4c
          002d - 32 1a 5c f2 5d 83 2a 4d-33 6a 08 ad 67 df 20
          003c - f1 50 64 21 18 8a 0a de-6d 34 92 36
    crls:
      <EMPTY>
    signerInfos:
        version: 1
        d.issuerAndSerialNumber:
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                  CN=802.1AR CA
          serialNumber: 9112578475118446130
        digestAlgorithm:
          algorithm: sha256 (2.16.840.1.101.3.4.2.1)
          parameter: <ABSENT>
        signedAttrs:
            object: contentType (1.2.840.113549.1.9.3)
            value.set:
              OBJECT:pkcs7-data (1.2.840.113549.1.7.1)

            object: signingTime (1.2.840.113549.1.9.5)
            value.set:
              UTCTIME:Jul  3 08:53:30 2019 GMT

            object: messageDigest (1.2.840.113549.1.9.4)
            value.set:
              OCTET STRING:
                0000 - d4 b0 5c dd c8 b4 91 28-4a 18 ca 25 9d
                000d - be d0 60 23 cf ad a0 aa-c2 95 ac e9 3f
                001a - 0b 4f 44 9e 25
                0020 - <SPACES/NULS>
        signatureAlgorithm:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:
          0000 - 30 46 02 21 00 e5 e1 7f-23 c3 aa 14 9f 35 64
          000f - 1e c4 4a 0f 68 fe b0 16-3b e6 7c 06 51 af bf
          001e - 5a a0 99 59 e0 28 1f 02-21 00 b4 07 2f 7c c4
          002d - f9 26 0c 6d 47 a7 93 56-de b8 da f7 23 f0 af
          003c - 2b 59 16 cc 36 63 e7 91-89 39 df df
        unsignedAttrs:
          <EMPTY>
]]></artwork></figure>

</section>
</section>
<section anchor="cosesign" title="COSE examples">

<t>These examples are from the https://minerva.sandelman.ca/ reference code,
using the unit test case key pairs, with a flow between pledge (“reach”
code), JRC (“fountain”) code, and MASA (“highway”) code.  This example
comes from the spec/files/product/00-D0-E5-F2-00-03 directory.</t>

<section anchor="device-registrar-and-masa-keys" title="Device, Registrar and MASA keys">

<t>This first section documents the public and private keys used in the
subsequent test vectors below.  These keys come from test code and are not used in any
production system, and should only be used only to validate implementations.</t>

<section anchor="device-idevid-certificate" title="Device IDevID certificate">

<figure><artwork><![CDATA[
Certificate:
  Data:
    Version: 3 (0x2)
    Serial Number: 787697345 (0x2ef34ec1)
    Signature Algorithm: ecdsa-with-SHA256
    Issuer: C = Canada, ST = Ontario, OU = Sandelman, CN = h
ighway-test.example.com CA
    Validity
      Not Before: Feb 14 17:05:09 2019 GMT
      Not After : Dec 31 00:00:00 2999 GMT
    Subject: serialNumber = 00-D0-E5-F2-00-03
    Subject Public Key Info:
      Public Key Algorithm: id-ecPublicKey
        Public-Key: (256 bit)
        pub:
          04:82:c4:28:5b:7c:f0:37:18:c7:90:14:dc:cb:f4:
          4d:7e:b0:00:ed:c0:de:bd:4d:25:55:4e:35:f9:d5:
          6a:57:14:b4:94:af:ce:6d:53:c8:60:c2:ce:53:3f:
          2c:1b:42:f1:c0:8b:5f:c1:7b:3d:f3:29:54:87:46:
          86:a4:0c:8b:b7
        ASN1 OID: prime256v1
        NIST CURVE: P-256
    X509v3 extensions:
      X509v3 Subject Key Identifier: 
        C8:A3:87:72:82:82:E6:EA:90:D0:E1:81:BC:C7:51:08:78:0
F:D7:52
      X509v3 Basic Constraints: 
        CA:FALSE
      X509v3 Subject Alternative Name: 
        othername:<unsupported>
      1.3.6.1.4.1.46930.2: 
        ..highway-test.example.com:9443
  Signature Algorithm: ecdsa-with-SHA256
     30:65:02:31:00:b2:9a:7a:1a:74:20:8f:e9:e0:5d:fc:af:d6:
     4a:80:1f:66:e3:bf:17:2e:3e:07:87:39:be:65:bd:94:57:71:
     1f:df:e5:fc:4d:ef:96:8a:3a:03:5b:d1:ca:a1:72:55:a3:02:
     30:13:43:08:a4:af:c8:28:19:d2:a0:93:3d:ed:53:fa:09:7d:
     76:9c:b7:0b:95:2b:8f:2f:b4:fa:87:02:ec:b4:2d:19:92:5b:
     b2:bb:79:04:63:6e:17:0e:79:8a:65:f5:a3
]]></artwork></figure>

</section>
<section anchor="device-private-key" title="Device private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIA1sa0l4bkj/rJxPUN1bKSBNYolVVzx+T28wo60cYpuaoAoGCCqGSM49
AwEHoUQDQgAEgsQoW3zwNxjHkBTcy/RNfrAA7cDevU0lVU41+dVqVxS0lK/ObVPI
YMLOUz8sG0LxwItfwXs98ylUh0aGpAyLtw==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="registrar-certificate" title="Registrar Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB0TCCAVagAwIBAgIBAjAKBggqhkjOPQQDAzBxMRIwEAYKCZImiZPyLGQBGRYC
Y2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xQDA+BgNVBAMMNyM8U3lzdGVt
VmFyaWFibGU6MHgwMDAwMDAwNGY5MTFhMD4gVW5zdHJ1bmcgRm91bnRhaW4gQ0Ew
HhcNMTcxMTA3MjM0NTI4WhcNMTkxMTA3MjM0NTI4WjBDMRIwEAYKCZImiZPyLGQB
GRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xEjAQBgNVBAMMCWxvY2Fs
aG9zdDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJZlUHI0up/l3eZf9vCBb+lI
noEMEgc7Ro+XZCtjAI0CD1fJfJR/hIyyDmHWyYiNFbRCH9fyarfkzgX4p0zTizqj
DTALMAkGA1UdEwQCMAAwCgYIKoZIzj0EAwMDaQAwZgIxALQMNurf8tv50lROD5DQ
XHEOJJNW3QV2g9QEdDSk2MY+AoSrBSmGSNjh4olEOhEuLgIxAJ4nWfNw+BjbZmKi
IiUEcTwHMhGVXaMHY/F7n39wwKcBBSOndNPqCpOELl6bq3CZqQ==
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="jrcpriv" title="Registrar private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFZodk+PC5Mu24+ra0sbOjKzan+dW5rvDAR7YuJUOC1YoAoGCCqGSM49
AwEHoUQDQgAElmVQcjS6n+Xd5l/28IFv6UiegQwSBztGj5dkK2MAjQIPV8l8lH+E
jLIOYdbJiI0VtEIf1/Jqt+TOBfinTNOLOg==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="masa-certificate" title="MASA Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB3zCCAWSgAwIBAgIEG5lfVDAKBggqhkjOPQQDAjBdMQ8wDQYDVQQGEwZDYW5h
ZGExEDAOBgNVBAgMB09udGFyaW8xEjAQBgNVBAsMCVNhbmRlbG1hbjEkMCIGA1UE
AwwbaGlnaHdheS10ZXN0LmV4YW1wbGUuY29tIENBMB4XDTE5MDIxMjIyMjI0MVoX
DTIxMDIxMTIyMjI0MVowXzEPMA0GA1UEBhMGQ2FuYWRhMRAwDgYDVQQIDAdPbnRh
cmlvMRIwEAYDVQQLDAlTYW5kZWxtYW4xJjAkBgNVBAMMHWhpZ2h3YXktdGVzdC5l
eGFtcGxlLmNvbSBNQVNBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqgQVo0S5
4kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+gqi4tMFfSJ0iEwt8kszf
WXK4rLgJS2mnpaMQMA4wDAYDVR0TAQH/BAIwADAKBggqhkjOPQQDAgNpADBmAjEA
vVXlmw77/F6VKeOBsxU1qpMYogS+RHKyUX1NbevR1cEQOrI5e1c/xcywow7nmUa6
AjEA9n9EfbcU+tFnatQRw0uu5vuamFb6hSEuXEhM8D/ymz+uiCCnrvly/1v5eGjP
D0jJ
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="masapriv" title="MASA private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFhdd0eDdzip67kXx72K+KHGJQYJHNy8pkiLJ6CcvxMGoAoGCCqGSM49
AwEHoUQDQgAEqgQVo0S54kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+
gqi4tMFfSJ0iEwt8kszfWXK4rLgJS2mnpQ==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
</section>
<section anchor="cose-signed-requestvoucher-with-registrar-certificate-pinned" title="COSE signed requestvoucher with registrar certificate pinned">

<figure><artwork><![CDATA[
EDNote: These examples do not parse
]]></artwork></figure>

<t>This voucher request has been signed by the pledge, and has been sent to the JRC over CoAPS.  This example
uses the proximity-registrar-cert mechanism to request a voucher that
pins the certificate of the registrar.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
D1E49970A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770C5901D4308201D030820157A00
30201020204228ECD27300A06082A8648CE3D040302306E31123010060A0
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
0340F4E6D0F9F702553FA53BE572ACF0EED858275B6AC75994332FB25FB3
A54411E9FA02E6F75FD1AADB7EA9A61F5409E02303E615E75C8F07432A59
0C8D48798BEDA1EB49E5E7D8E0EA118BD17A02D02F0313D144816002F756
B528ABD1B0ADB749D', h'96B82530AC57650346C2BFFB5A6CC16B28F16F
ACFE5A2FD1BCF3D5F5D62733F7F7812D67D43BE1CF9906E356FB0C2BDD36
777FD7DBAE22B8CEB07D51D8F55AD3'])
]]></artwork></figure>

<t>This is the raw binary, shown as hex dump:</t>

<figure><artwork><![CDATA[
0oRBoKBZAhyhGgAPRsKlAWlwcm94aW1pdHkCwRpdHkmXClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwxZAdQwggHQMIIBV6AD
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
NA9ObQ+fcCVT+lO+VyrPDu2FgnW2rHWZQzL7Jfs6VEEen6Aub3X9Gq236pph
9UCeAjA+YV51yPB0MqWQyNSHmL7aHrSeXn2ODqEYvRegLQLwMT0USBYAL3Vr
Uoq9GwrbdJ1YQJa4JTCsV2UDRsK/+1pswWso8W+s/lov0bzz1fXWJzP394Et
Z9Q74c+ZBuNW+wwr3TZ3f9fbriK4zrB9Udj1WtM=
]]></artwork></figure>

</section>
<section anchor="cose-signed-parboiled-requestvoucher" title="COSE signed parboiled requestvoucher">

<figure><artwork><![CDATA[
These example do not parse
]]></artwork></figure>

<t>This voucher request has been signed by the JRC using the private key from
<xref target="jrcpriv"/>.  Contained within this voucher request is the pledge voucher
request above.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
9DD3BFD0A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770B590266D28441A0A059021CA11
A000F46C2A5016970726F78696D69747902C11A5D1E49970A5130302D443
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
AADB7EA9A61F5409E02303E615E75C8F07432A590C8D48798BEDA1EB49E5
E7D8E0EA118BD17A02D02F0313D144816002F756B528ABD1B0ADB749D584
096B82530AC57650346C2BFFB5A6CC16B28F16FACFE5A2FD1BCF3D5F5D62
733F7F7812D67D43BE1CF9906E356FB0C2BDD36777FD7DBAE22B8CEB07D5
1D8F55AD3', h'EAE868ECC176883766C5DC5BA5B8DCA25DAB3C2E56A551
CE5705B793914348E1F93C2B81E88CCBE28E90800F66945EFBBECE4F741D
0EDE18EB1008EF7E9A279C'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZAq6hGgAPRsKlAWlwcm94aW1pdHkCwRpZ3Tv9ClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwtZAmbShEGgoFkCHKEa
AA9GwqUBaXByb3hpbWl0eQLBGl0eSZcKUTAwLUQwLUU1LUYyLTAwLTAzB3Zf
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
U75XKs8O7YWCdbasdZlDMvsl+zpUQR6foC5vdf0arbfqmmH1QJ4CMD5hXnXI
8HQypZDI1IeYvtoetJ5efY4OoRi9F6AtAvAxPRRIFgAvdWtSir0bCtt0nVhA
lrglMKxXZQNGwr/7WmzBayjxb6z+Wi/RvPPV9dYnM/f3gS1n1Dvhz5kG41b7
DCvdNnd/19uuIrjOsH1R2PVa01hA6uho7MF2iDdmxdxbpbjcol2rPC5WpVHO
VwW3k5FDSOH5PCuB6IzL4o6QgA9mlF77vs5PdB0O3hjrEAjvfponnA==
]]></artwork></figure>

</section>
<section anchor="cose-signed-voucher" title="COSE signed voucher">

<t>The resulting voucher is created by the MASA and returned via the JRC to the
Pledge.  It is signed by the MASA’s private key <xref target="masapriv"/> and can be
verified by the pledge using the MASA’s publie key.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F468CA505666C6F6767656406C11A5D1E499
A0E7130302D44302D45352D46322D30302D30330B765F715674477738565
342626C65394D34557036354C770C7902744D49494230544343415661674
177494241674942416A414B42676771686B6A4F50515144417A42784D524
9774541594B435A496D695A50794C4751424752594359324578475441584
2676F4A6B69614A6B2F49735A41455A46676C7A5957356B5A57787459573
4785144412B42674E5642414D4D4E794D3855336C7A64475674566D46796
1574669624755364D4867774D4441774D4441774E4759354D5446684D443
4675657357A64484A31626D6367526D3931626E526861573467513045774
868634E4D5463784D5441334D6A4D304E5449345768634E4D546B784D544
1334D6A4D304E544934576A42444D5249774541594B435A496D695A50794
C47514247525943593245784754415842676F4A6B69614A6B2F49735A414
55A46676C7A5957356B5A57787459573478456A415142674E5642414D4D4
3577876593246736147397A6444425A4D424D4742797147534D343941674
54743437147534D34394177454841304941424A5A6C5548493075702F6C3
3655A6639764342622B6C496E6F454D45676337526F2B585A43746A41493
0434431664A664A522F68497979446D48577959694E46625243483966796
172666B7A67583470307A54697A716A4454414C4D416B474131556445775
1434D414177436759494B6F5A497A6A304541774D44615141775A6749784
14C514D4E75726638747635306C524F443544515848454F4A4A4E5733515
632673951456444536B324D592B416F537242536D47534E6A68346F6C454
F6845754C674978414A346E57664E772B426A625A6D4B694969554563547
7484D68475658614D48592F46376E333977774B634242534F6E644E50714
3704F454C6C36627133435A71513D3D', h'7468FB16A4035FDAF510DBF5
A88F67B6FB849CFBA8B094B77AD5248900E4BCD6E892FE74B39AB787637B
121944BED4D1CB4B8DC8F59212EAC2AD20469C71C1F6'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZArmhGgAPRoylBWZsb2dnZWQGwRpdHkmaDnEwMC1EMC1FNS1GMi0w
MC0wMwt2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwx5AnRNSUlCMFRDQ0FWYWdB
d0lCQWdJQkFqQUtCZ2dxaGtqT1BRUURBekJ4TVJJd0VBWUtDWkltaVpQeUxH
UUJHUllDWTJFeEdUQVhCZ29Ka2lhSmsvSXNaQUVaRmdsellXNWtaV3h0WVc0
eFFEQStCZ05WQkFNTU55TThVM2x6ZEdWdFZtRnlhV0ZpYkdVNk1IZ3dNREF3
TURBd05HWTVNVEZoTUQ0Z1ZXNXpkSEoxYm1jZ1JtOTFiblJoYVc0Z1EwRXdI
aGNOTVRjeE1UQTNNak0wTlRJNFdoY05NVGt4TVRBM01qTTBOVEk0V2pCRE1S
SXdFQVlLQ1pJbWlaUHlMR1FCR1JZQ1kyRXhHVEFYQmdvSmtpYUprL0lzWkFF
WkZnbHpZVzVrWld4dFlXNHhFakFRQmdOVkJBTU1DV3h2WTJGc2FHOXpkREJa
TUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCSlpsVUhJMHVwL2wz
ZVpmOXZDQmIrbElub0VNRWdjN1JvK1haQ3RqQUkwQ0QxZkpmSlIvaEl5eURt
SFd5WWlORmJSQ0g5ZnlhcmZremdYNHAwelRpenFqRFRBTE1Ba0dBMVVkRXdR
Q01BQXdDZ1lJS29aSXpqMEVBd01EYVFBd1pnSXhBTFFNTnVyZjh0djUwbFJP
RDVEUVhIRU9KSk5XM1FWMmc5UUVkRFNrMk1ZK0FvU3JCU21HU05qaDRvbEVP
aEV1TGdJeEFKNG5XZk53K0JqYlptS2lJaVVFY1R3SE1oR1ZYYU1IWS9GN24z
OXd3S2NCQlNPbmROUHFDcE9FTGw2YnEzQ1pxUT09WEB0aPsWpANf2vUQ2/Wo
j2e2+4Sc+6iwlLd61SSJAOS81uiS/nSzmreHY3sSGUS+1NHLS43I9ZIS6sKt
IEacccH2
]]></artwork></figure>

</section>
<section anchor="cose-signed-request-voucher" title="COSE signed request voucher">

<t>The headecimal dump of request-voucher shown in <xref target="cmssign"/> is used for this example. The cose sign1 object of <xref target="fig-cose"/> provides the structure of the cose sign1 example.  To identify the public key a hash of the public key is made using murmur3 with seed 42.</t>

<figure><artwork><![CDATA[
public key:
84 44 de 3a b7 b5 a0 2f 20 ed e7 80 1a f0 76 d6 52 0a e5 c8 a1
04 41 61 b2 64 57 fe 0e ae 08 4d

murmur3 hash of public key: 0x4727e669  or  1193797225
]]></artwork></figure>

<t>Using the values “kid” = 4, EDdsa = -8, “alg” = 2, COSE_Sign1 = 18, and using the murmur3 hash value for the “kid” parameter, the CBOR object is:</t>

<figure><artwork><![CDATA[
18([h'A10127', {4: 1193797225},
  h'A11909C5A90274323031362D31302D30375431393A33313A34325A04743
  23031362D31302D32315431393A33313A34325A01020D6D4A414441313233
  343536373839054401020D0F0A4401020D0F03F50674323031372D31302D3
  0375431393A33313A34325A0C4401020D0F',
h'955D82A26B7C0869EE8FE5A09EE3D68DDFFE8FE39E3BCADFA80F2F9A6E13F
  F0349A2CA131C8F6A9AAF7780BAB671F63CBB158EC17322323C1AB82B1CDC
  B62A06'])
]]></artwork></figure>

<t>The corresponding hexadecimal dump is:</t>

<figure><artwork><![CDATA[
  d28443a10127a1041a4727e669586ca11909c5a90274323031362d31302d
  30375431393a33313a34325a0474323031362d31302d32315431393a3331
  3a34325a01020d6d4a414441313233343536373839054401020d0f0a4401
  020d0f03f50674323031372d31302d30375431393a33313a34325a0c4401
  020d0f5840955d82a26b7c0869ee8fe5a09ee3d68ddffe8fe39e3bcadfa8
  0f2f9a6e13ff0349a2ca131c8f6a9aaf7780bab671f63cbb158ec1732232
  3c1ab82b1cdcb62a06
]]></artwork></figure>

</section>
</section>


  </back>

<!-- ##markdown-source:
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
bTnKiFQh1TmXDloNhlyqXKEWCCdYZf+G2TLlsclRWp89CoBOw8gdhnKXjBFg
ODyNXcnSlGxHkTgsz3pUmvbXLIlrxwwohII0s3RjY3vyclcC8hgoWyeo6gVY
xjG2xkLPzFSDfMQj0ztF7Ag3UI9t9w9iHpNxxE1YO7Dbu/MKSn2OKSC9t2M0
PGeL6G7hLMWDWB4ePETiscJmFBALTnZDwq7RKj0DuTWF6agi71gK8ci5A2a0
ktO6i5WPTTdL2vDYnUCtS8+GU7pF+10U4mGQuwJXD2HnBJDaHgYlEzWk+4eK
KQpUOuYF2xc3y8cv2C0gDlxoQtx2clBhFFUWbWdgzo+FG8kUYhfy7Mzh4YFx
0biVijeZHcc4zPuCDOVIV1tjwCT5D8Q8SVUw62zH4Nh9fwNcFuUfyFBoL74U
qhhbgnFUYzc0+wIk6WtRZnr3EtBWSHtXZHbsOCfgmVJRF1fTyc3t2/OLb9+e
31xfwpdXE6bYZrsmSi2PhKKRv8vZ5Gqs6V0w7pePC1xaHZbCtkuIPeWu30Vc
Ddq2cE89VtSjHMICUWp8c7cieaqRLCi/vIZ0qrE7rNAirxQcEBl5UCBKIoIK
H/kxijfJBhWO2VZQ4grD34mYfMlwV3S5BaiEkZzdOiVATb4gz0GHbXKVJ/no
QKY9KInHxOqu5ahIgcFaU6nnayq1m6zl/teXs8Ofx8PbSYP2NSzCTVSwUU12
mP3p9y+Ue+ORg3gmQDUgErnc79C7hiY6/BgWIp00jmJSLzGY7CiQg8WJjJ5U
iAw+v4rt1LgyNUxpgUgsQxwr4Mtgs+QqdAZE/V2kCfr51g4H9lze4a7BYlXO
OGh71G/4jbYddfQ7TZUb3IlrhZLspCoa6oFblg+jhW3te1tQ/CXqiGjF0ye2
3qTrRDqJn1oTQWbOkh+qVJKWVbWWoRAmz7EwJ1d7YzLRHFECUW4foAqnEZ/b
hza7mJRwN4xAhQ6EVfSAArk9ZzI6Sogs52WqUN9ptORQCzBuZDGVvSTbMbqc
wipVrI95yMYfaLhMbrpkvT4lOfYFUvrPVtYVJf2Zavo/vXr+3Wr5/5U6/jQ1
zE0htdG/rqV/pfP3WQr4v6ji3aVwcQ06Da8WoHNqNhLev4cQDtupCVHgVC97
S2DLjNtRDdJOb3OQey9nv5jcnjPxoAuJaKdjNH3R3bXZL7W3HsTad8CCgRVK
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
IAxmvsfxBKei5f8F5ovemjGPAAA=

-->

</rfc>

