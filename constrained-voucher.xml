<?xml version="1.0" encoding="us-ascii"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.12 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC7049 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7049.xml">
<!ENTITY I-D.ietf-core-yang-cbor SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-yang-cbor.xml">
<!ENTITY I-D.ietf-core-sid SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-sid.xml">
<!ENTITY RFC7250 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7250.xml">
<!ENTITY RFC7252 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7252.xml">
<!ENTITY RFC7950 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml">
<!ENTITY RFC5652 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5652.xml">
<!ENTITY RFC8152 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8152.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8366 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8366.xml">
<!ENTITY RFC3688 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3688.xml">
<!ENTITY RFC6020 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6020.xml">
<!ENTITY I-D.ietf-anima-bootstrapping-keyinfra SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-anima-bootstrapping-keyinfra.xml">
<!ENTITY I-D.ietf-core-object-security SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-object-security.xml">
<!ENTITY I-D.ietf-ace-cbor-web-token SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ace-cbor-web-token.xml">
<!ENTITY I-D.ietf-ace-coap-est SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ace-coap-est.xml">
<!ENTITY I-D.ietf-netmod-yang-tree-diagrams SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-netmod-yang-tree-diagrams.xml">
<!ENTITY RFC6690 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6690.xml">
<!ENTITY RFC7030 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-ietf-anima-constrained-voucher-05" category="std">

  <front>
    <title abbrev="Constrained Voucher">Constrained Voucher Artifacts for Bootstrapping Protocols</title>

    <author initials="M." surname="Richardson" fullname="Michael Richardson">
      <organization>Sandelman Software Works</organization>
      <address>
        <email>mcr+ietf@sandelman.ca</email>
      </address>
    </author>
    <author initials="P." surname="van der Stok" fullname="Peter van der Stok">
      <organization>vanderstok consultancy</organization>
      <address>
        <email>consultancy@vanderstok.org</email>
      </address>
    </author>
    <author initials="P." surname="Kampanakis" fullname="Panos Kampanakis">
      <organization>Cisco Systems</organization>
      <address>
        <email>pkampana@cisco.com</email>
      </address>
    </author>

    <date year="2019" month="July" day="08"/>

    <area>Internet</area>
    <workgroup>anima Working Group</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a strategy to securely assign a pledge to an
owner, using an artifact signed, directly or indirectly, by the
pledge's manufacturer.  This artifact is known as a "voucher".</t>

<t>This document builds upon the work in <xref target="RFC8366"/>, encoding
the resulting artifact in CBOR.  Use with two signature technologies are
described.</t>

<t>Additionally, this document explains how constrained vouchers may be
transported as an extension to the <xref target="I-D.ietf-ace-coap-est"/> protocol.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>Enrollment of new nodes into constrained networks with constrained nodes
present unique challenges.</t>

<t>There are bandwidth and code space issues to contend.  A solution such as
<xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> may be too large in terms of
code space or bandwidth required.</t>

<t>This document defines a constrained version of <xref target="RFC8366"/>.
Rather than serializing the YANG definition in JSON, it is serialized into
CBOR (<xref target="RFC7049"/>).</t>

<t>This document follows a similar, but not identical structure as
<xref target="RFC8366"/>. Some sections are left out entirely.
Additional sections have been added concerning:</t>

<t><list style="numbers">
  <t>Addition of voucher-request specification as defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>,</t>
  <t>Addition to <xref target="I-D.ietf-ace-coap-est"/> of voucher transport requests over CoAP.</t>
</list></t>

<t>The CBOR definitions for this constrained voucher format are defined using
the mechanism describe in <xref target="I-D.ietf-core-yang-cbor"/> using the SID
mechanism explained in <xref target="I-D.ietf-core-sid"/>.  As the tooling to convert
YANG documents into an list of SID keys is still in its infancy, the table of
SID values presented here should be considered normative rather than the
output of the pyang tool.</t>

<t>Two methods of signing the resulting CBOR object are described in this
document:</t>

<t><list style="numbers">
  <t>One is CMS <xref target="RFC5652"/>.</t>
  <t>The other is COSE_Sign1 <xref target="RFC8152"/> objects.</t>
</list></t>

</section>
<section anchor="Terminology" title="Terminology">

<t>The following terms are defined in <xref target="RFC8366"/>, and are used
identically as in that document: artifact, imprint, domain, Join
Registrar/Coordinator (JRC), Manufacturer Authorized Signing Authority
(MASA), pledge, Trust of First Use (TOFU), and Voucher.</t>

</section>
<section anchor="reqlang" title="Requirements Language">

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL 
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", 
"MAY", and "OPTIONAL" in this document are to be interpreted as 
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they 
appear in all capitals, as shown here.</t>

</section>
<section anchor="survey-of-voucher-types" title="Survey of Voucher Types">

<t><xref target="RFC8366"/> provides for vouchers that assert proximity, that
authenticate the registrar and that include different amounts of anti-replay
protection.</t>

<t>This document does not make any extensions to the types of vouchers.</t>

<t>Time based vouchers are included in this definition, but given that
constrained devices are extremely unlikely to have accurate time, their
use is very unlikely.  Most users of these constrained vouchers will be
online and will use live nonces to provide anti-replay protection.</t>

<t><xref target="RFC8366"/> defined only the voucher artifact, and not the
Voucher Request artifact, which was defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<t>This document defines both a constrained voucher and a constrained voucher-request.
They are presented in the order voucher-request, followed by a voucher response
as this is the time order that they occur.</t>

<t>This document defines both CMS-signed voucher requests and responses, and
COSE signed voucher requests and responses.
The use of CMS signatures implies the use of PKIX format certificates.
The pinned-domain-cert present in such a voucher, is the certificate of the Registrar.</t>

<t>The constrained voucher and constrained voucher request MUST be signed.</t>

<t>The use of the two signing formats permit the use of both PKIX format certificates,
and raw public keys (RPK).  When RPKs are used, the voucher produced by
the MASA pins the raw public key of the Registrar: the
pinned-domain-subject-public-key-info in such a voucher, is the raw public
key of the Registrar.
This is described in the YANG definition for the constrained voucher.</t>

</section>
<section anchor="discovery-and-uri" title="Discovery and URI">

<t>This section describes the BRSKI extensions to EST-coaps
<xref target="I-D.ietf-ace-coap-est"/> to transport the voucher between registrar,
proxy and pledge over CoAP. The extensions are targeted to low-resource
networks with small packets. Saving header space is important and the
EST-coaps URI is shorter than the EST URI.</t>

<t>The presence and location of (path to) the management data are discovered by
sending a GET request to "/.well-known/core" including a resource type (RT)
parameter with the value "ace.est" <xref target="RFC6690"/>. Upon success, the return
payload will contain the root resource of the EST resources. It is up to the
implementation to choose its root resource; throughout this document the
example root resource /est is used.</t>

<t>The EST-coaps server URIs differ from the EST URI by replacing the scheme
https by coaps and by specifying shorter resource path names:</t>

<figure><artwork><![CDATA[
  coaps://www.example.com/est/short-name
]]></artwork></figure>

<t>Figure 5 in section 3.2.2 of <xref target="RFC7030"/> enumerates the operations and
corresponding paths which are supported by EST. <xref target="est-uri"/> provides the
mapping from the BRSKI extension URI path to the EST-coaps URI path.</t>

<texttable title="BRSKI path to EST-coaps path" anchor="est-uri">
      <ttcol align='left'>BRSKI</ttcol>
      <ttcol align='left'>EST-coaps</ttcol>
      <c>/requestvoucher</c>
      <c>/rv</c>
      <c>/voucher_status</c>
      <c>/vs</c>
      <c>/enrollstatus</c>
      <c>/es</c>
      <c>/requestauditlog</c>
      <c>/ra</c>
</texttable>

<t>/requestvoucher, /voucher_status and /enrollstatus are needed between 
pledge and Registrar.</t>

<t>When discovering the root path for the EST resources, the server MAY return
the full resource paths and the used content types. This is useful when
multiple content types are specified for EST-coaps server. For example, the
following more complete response is possible.</t>

<figure><artwork><![CDATA[
  REQ: GET /.well-known/core?rt=ace.est*

  RES: 2.05 Content
  </est>; rt="ace.est"
  </est/rv>; rt="ace.est/rv";ct=TBD2 TBD3
  </est/vs>; rt="ace.est/vs";ct=50 60
  </est/es>; rt="ace.est/es";ct=50 60
  </est/ra>; rt="ace.est/ra";ct=TBD2 TBD3
]]></artwork></figure>

<t>The return of the content-types allows the client to choose the most appropriate one from multiple content types.</t>

<t>ct=TBD2 stands for Content-Format "application/voucher-cms+cbor,
and ct=TBD3 stands for Content-Format "application/voucher-cose+cbor".</t>

<t>Content-Formats TBD2 and TBD3 are defined in this document.</t>

<t>The Content-Format ("application/json") 50 MAY be supported.
Content-Formats ("application/cbor") 60, TBD2, and TBD3 MUST be supported.</t>

</section>
<section anchor="artifacts" title="Artifacts">

<t>This section describes the abstract (tree) definition as explained
in <xref target="I-D.ietf-netmod-yang-tree-diagrams"/> first.  This provides a high-level
view of the contents of each artifact.</t>

<t>Then the assigned SID values are presented. These have been assigned using
the rules in <xref target="I-D.ietf-core-sid"/>, with an allocation that was made
via the http://comi.space service.</t>

<section anchor="voucher-request-artifact" title="Voucher Request artifact">

<section anchor="tree-diagram" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with the addition of proximity-registrar-subject-public-key-info,
proximity-registrar-cert, and prior-signed-voucher-request.</t>

<t>prior-signed-voucher-request is only used between the Registrar and the MASA.
proximity-registrar-subject-public-key-info replaces proximity-registrar-cert
for the extremely constrained cases.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher-request

  grouping voucher-request-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion
       |       enumeration
       +-- serial-number
       |       string
       +-- idevid-issuer?
       |       binary
       +-- pinned-domain-cert?
       |       binary
       +-- domain-cert-revocation-checks?
       |       boolean
       +-- nonce?
       |       binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- proximity-registrar-subject-public-key-info?
       |       binary
       +-- proximity-registrar-sha256-of-subject-public-key-info?
       |       binary
       +-- proximity-registrar-cert?
       |       binary
       +-- prior-signed-voucher-request?
               binary
]]></artwork></figure>

</section>
<section anchor="sid-values" title="SID values">

<figure><artwork><![CDATA[
Base SID value for voucher request: 1001150.

      SID Assigned to
--------- --------------------------------------------------
  1001167 module ietf-constrained-voucher-request
  1001168 module ietf-restconf
  1001169 module ietf-voucher
  1001170 module ietf-yang-types
  1001171 data /ietf-constrained-voucher-request:voucher
  1001154 data .../ietf-constrained-voucher-request:voucher
  1001155 data .../assertion
  1001156 data .../created-on
  1001157 data .../domain-cert-revocation-checks
  1001158 data .../expires-on
  1001159 data .../idevid-issuer
  1001160 data .../last-renewal-date
  1001161 data .../nonce
  1001162 data .../pinned-domain-cert
  1001165 data .../prior-signed-voucher-request
  1001166 data .../proximity-registrar-cert
  1001163 data .../proximity-registrar-subject-public-key-info
  1001164 data .../serial-number
  1001172 data .../assertion
  1001173 data .../created-on
  1001174 data .../domain-cert-revocation-checks
  1001175 data .../expires-on
  1001176 data .../idevid-issuer
  1001177 data .../last-renewal-date
  1001178 data /ietf-constrained-voucher-request:voucher/nonce
  1001179 data .../pinned-domain-cert
  1001180 data .../prior-signed-voucher-request
  1001181 data .../proximity-registrar-cert
  1001182 data .../proximity-registrar-subject-public-key-info
  1001183 data .../serial-number
  1001150 data ietf-constrained-voucher-request
  1001151 data ietf-restconf
  1001152 data ietf-voucher
  1001153 data ietf-yang-types

 WARNING, obsolete definitions


]]></artwork></figure>

</section>
<section anchor="yang-module" title="YANG Module">

<t>In the constrained-voucher-request YANG module, the voucher is "augmented" within the "used" grouping statement such that one continuous set of SID values is generated for the constrained-voucher-request module name, all voucher attributes, and the constrained-voucher-request attribute. Two attributes of the voucher are "refined" to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher-request@2018-09-01.yang"
module ietf-constrained-voucher-request {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
  description
   "This module defines the format for a voucher request,
    which is produced by a pledge to request a voucher.
    The voucher-request is sent to the potential owner's
    Registrar, which in turn sends the voucher request to
    the manufacturer or delegate (MASA).

    A voucher is then returned to the pledge, binding the
    pledge to the owner.  This is a constrained version of the
    voucher-request present in
    draft-ietf-anima-bootstrap-keyinfra.txt.

    This version provides a very restricted subset appropriate
    for very constrained devices.
    In particular, it assumes that nonce-ful operation is
    always required, that expiration dates are rather weak, as no
    clocks can be assumed, and that the Registrar is identified
    by a pinned Raw Public Key.

    The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
    'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
    and 'OPTIONAL' in the module text are to be interpreted as
    described in RFC 2119.";

  revision "2018-09-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-request-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-request-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-request-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }


      augment "voucher" {
        description "Base the constrained voucher-request upon the
          regular one";

        leaf proximity-registrar-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-subject-public-key-info replaces
 	     the proximit-registrar-cert in constrained uses of
             the voucher-request.
             The proximity-registrar-subject-public-key-info is the
             Raw Public Key of the Registrar. This field is encoded
             as specified in RFC7250, section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is MAY, but due to 
             size is discouraged.";
        }

        leaf proximity-registrar-sha256-of-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-sha256-of-subject-public-key-info
             is an alternative to 
             proximity-registrar-subject-public-key-info.
             and pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement protocol, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash
             types.";
        }

        leaf proximity-registrar-cert {
          type binary;
          description
            "An X.509 v3 certificate structure as specified by
             RFC 5280,
             Section 4 encoded using the ASN.1 distinguished encoding
             rules (DER), as specified in ITU-T X.690.

             The first certificate in the Registrar TLS server
             certificate_list sequence  (see [RFC5246]) presented by
             the Registrar to the Pledge. This MUST be populated in a
             Pledge's voucher request if the proximity assertion is
             populated.";
        }

        leaf prior-signed-voucher-request {
          type binary;
          description
            "If it is necessary to change a voucher, or re-sign and
             forward a voucher that was previously provided along a
             protocol path, then the previously signed voucher
             SHOULD be included in this field.

             For example, a pledge might sign a proximity voucher,
             which an intermediate registrar then re-signs to
             make its own proximity assertion.  This is a simple
             mechanism for a chain of trusted parties to change a
             voucher, while maintaining the prior signature
             information.

             The pledge MUST ignore all prior voucher information
             when accepting a voucher for imprinting. Other
             parties MAY examine the prior signed voucher
             information for the purposes of policy decisions.
             For example this information could be useful to a
             MASA to determine that both pledge and registrar
             agree on proximity assertions. The MASA SHOULD
             remove all prior-signed-voucher-request information when
             signing a voucher for imprinting so as to minimize the
             final voucher size.";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example2" title="Example voucher request artifact">

<t>Below is a CBOR serialization of the constrained-voucher-request is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  1001154: {
    +2 : "2016-10-07T19:31:42Z", / SID= 1001156, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID= 1001158, expires-on /
    +1 : 2,                      / SID= 1001155, assertion /
                                 /                "proximity" /
    +13: "JADA123456789",        / SID= 1001167, serial-number /
    +5 : h'01020D0F',            / SID= 1001159, idevid-issuer /
    +10: h'01020D0F',        / SID=1001064, proximity-registrar-cert/
    +3 : true,                   / SID= 1001157, domain-cert
                                                  -revocation-checks/
    +6 : "2017-10-07T19:31:42Z", / SID= 1001160, last-renewal-date /
    +12: h'01020D0F'             / SID= 1001166, proximity-registrar
                                         -subject-public-key-info /
  }
}


]]></artwork></figure>

</section>
</section>
<section anchor="voucher-artifact" title="Voucher artifact">

<t>The voucher's primary purpose is to securely assign a pledge to an
owner.  The voucher informs the pledge which entity it should
consider to be its owner.</t>

<t>This document defines a voucher that is a CBOR encoded instance of
the YANG module defined in Section 5.3 that has been signed with CMS
or with COSE.</t>

<section anchor="tree-diagram-1" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with only the addition of pinned-domain-subject-public-key-info.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher

  grouping voucher-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion                                   enumeration
       +-- serial-number                               string
       +-- idevid-issuer?                              binary
       +-- pinned-domain-cert?                         binary
       +-- domain-cert-revocation-checks?              boolean
       +-- nonce?                                      binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- pinned-domain-subject-public-key-info?      binary
       +-- pinned-sha256-of-subject-public-key-info?   binary
]]></artwork></figure>

</section>
<section anchor="sid-values-1" title="SID values">

<figure><artwork><![CDATA[
Base SID value for voucher request: 1001101.

      SID Assigned to
--------- --------------------------------------------------
  1001115 module ietf-constrained-voucher
  1001116 module ietf-restconf
  1001117 module ietf-voucher
  1001118 module ietf-yang-types
  1001119 data /ietf-constrained-voucher:voucher
  1001104 data .../ietf-constrained-voucher:voucher
  1001105 data .../assertion
  1001106 data .../created-on
  1001107 data .../domain-cert-revocation-checks
  1001108 data .../expires-on
  1001109 data .../idevid-issuer
  1001110 data .../last-renewal-date
  1001111 data .../nonce
  1001112 data .../pinned-domain-cert
  1001113 data .../pinned-domain-subject-public-key-info
  1001114 data .../serial-number
]]></artwork></figure>

</section>
<section anchor="yang-module-1" title="YANG Module">

<t>In the constrained-voucher YANG module, the voucher is "augmented" within the "used" grouping statement such that one continuous set of SID values is generated for the constrained-voucher module name, all voucher attributes, and the constrained-voucher attribute. Two attributes of the voucher are "refined" to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher@2018-09-01.yang"
module ietf-constrained-voucher {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
description
  "This module defines the format for a voucher, which is produced
   by a pledge's manufacturer or delegate (MASA) to securely assign
   one or more pledges to an 'owner', so that the pledges may
   establis a secure connection to the owner's network
   infrastructure.

   This version provides a very restricted subset appropriate
   for very constrained devices.
   In particular, it assumes that nonce-ful operation is
   always required, that expiration dates are rather weak, as no
   clocks can be assumed, and that the Registrar is identified
   by a pinned Raw Public Key.

   The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
   'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
   and 'OPTIONAL' in the module text are to be interpreted as
   described in RFC 2119.";

  revision "2018-09-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }

      augment "voucher" {
        description "Base the constrained voucher
                                   upon the regular one";
        leaf pinned-domain-subject-public-key-info {
          type binary;
          description
            "The pinned-domain-subject-public-key-info replaces the
             pinned-domain-cert in constrained uses of
             the voucher. The pinned-domain-subject-public-key-info
             is the Raw Public Key of the Registrar.
             This field is encoded as specified in RFC7250,
             section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is a MAY.";
        }

        leaf pinned-sha256-of-subject-public-key-info {
          type binary;
          description
            "The pinned-hash-subject-public-key-info is a second
             alternative to pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement process, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash types";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example1" title="Example voucher artifacts">

<t>Below a the CBOR serialization of the constrained-voucher is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  1001104: {
    +2 : "2016-10-07T19:31:42Z", / SID = 1001106, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID = 1001108, expires-on /
    +1 : 0,                      / SID = 1001105, assertion /
                                 /                "verified" /
    +11: "JADA123456789",        / SID = 1001115, serial-number /
    +5 : h'01020D0F',            / SID = 1001109, idevid-issuer /
    +8 : h'01020D0F',            / SID = 1001112, pinned-domain-cert/
    +3 : true,                   / SID = 1001107, domain-cert
                                                 -revocation-checks /
    +6 : "2017-10-07T19:31:42Z", / SID = 1001110, last-renewal-date /
    +9 : h'01020D0F'             / SID = 1001113, pinned-domain
                                           -subject-public-key-info /
  }
}


]]></artwork></figure>

<t>The signing of the example is shown in <xref target="cmssign"/>.</t>

</section>
</section>
<section anchor="signing-voucher-and-voucher-request-artifacts" title="Signing voucher and voucher-request artifacts">

<section anchor="cms-signing" title="CMS signing">

<t>The IETF evolution of PKCS#7 is CMS <xref target="RFC5652"/>.  The CMS signed voucher is
much like the equivalent voucher defined in <xref target="RFC8366"/>.</t>

<t>A different eContentType of TBD1 is used to indicate that the contents are
in a different format than in <xref target="RFC8366"/>.</t>

<t>The ContentInfo structure contains a payload consisting of the CBOR encoded
voucher. The <xref target="I-D.ietf-core-yang-cbor"/> use of delta encoding creates a
canonical ordering for the keys on the wire.  This canonical ordering is not
important as there is no expectation that the content will be reproduced
during the validation process.</t>

<t>Normally the recipient is the pledge and the signer is the MASA.</t>

<t><xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> supports both signed and unsigned
voucher requests from the pledge to the JRC.
In this specification, voucher-request artifact MUST be signed from the
pledge to the registrar.  From the JRC to the MASA, the voucher-request
artifact MUST be signed by the domain owner key which is requesting
ownership.</t>

<t>The considerations of <xref target="RFC5652"/> section 5.1, concerning validating
CMS objects which are really PKCS7 objects (cmsVersion=1) applies.</t>

<t>The CMS structure SHOULD also contain all the certificates leading up
to and including the signer's trust anchor certificate known to the
recipient.  The inclusion of the trust anchor is unusual in many
applications, but without it third parties can not accurately audit
the transaction.</t>

<t>The CMS structure MAY also contain revocation objects for any
intermediate certificate authorities (CAs) between the voucher-issuer
and the trust anchor known to the recipient.  However, the use of
CRLs and other validity mechanisms is discouraged, as the pledge is
unlikely to be able to perform online checks, and is unlikely to have
a trusted clock source.  As described below, the use of short-lived
vouchers and/or pledge provided nonce provides a freshness guarantee.</t>

<figure><artwork><![CDATA[
[EDnote: compulsory signing algorithms are ....]
]]></artwork></figure>

<t>In <xref target="cmssign"/> an example for the CMS signing of the voucher-request is shown.</t>

</section>
<section anchor="cose-signing" title="COSE signing">

<t>The COSE-Sign1 structure is discussed in section 4.2 of <xref target="RFC8152"></xref>. The CBOR
object that carries the body, the signature, and the
information about the body and signature is called the COSE_Sign1
structure. It is used when only one signature is used on the body.
Support for EdDSA 256 with Ed25519 is compulsory.</t>

<t>The supported COSE-sign1 object stucture is shown in <xref target="fig-cose"/>.</t>

<figure title="The cose-sign1 structure." align="left" anchor="fig-cose"><artwork><![CDATA[
COSE_Sign1(
[
 h'a10126',         #{ "alg":  EDdsa 256 }
{
 "crv": Ed25519,
 "kty": OKP,
 "key_ops": "verify"
},
h'123', #voucher-request binary content
h'456', #voucher-request binary public signature
]
)
]]></artwork></figure>

<t>The <xref target="COSE-registry"/> specifies the integers that replace the strings and the mnemonics in <xref target="fig-cose"/>. In <xref target="cosesign"/> a binary cose-sign1 object is shown based on the voucher-request example of <xref target="example2"/>.</t>

</section>
</section>
</section>
<section anchor="design-considerations" title="Design Considerations">

<t>The design considerations for the CBOR encoding of vouchers is much the same
as for <xref target="RFC8366"/>.</t>

<t>One key difference is that the names of the leaves in the YANG does not have a
material effect on the size of the resulting CBOR, as the SID translation
process assigns integers to the names.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<section anchor="clock-sensitivity" title="Clock Sensitivity">

<t>TBD.</t>

</section>
<section anchor="protect-voucher-pki-in-hsm" title="Protect Voucher PKI in HSM">

<t>TBD.</t>

</section>
<section anchor="test-domain-certificate-validity-when-signing" title="Test Domain Certificate Validity when Signing">

<t>TBD.</t>

</section>
</section>
<section anchor="iana-considerations" title="IANA Considerations">

<section anchor="resource-type-registry" title="Resource Type Registry">

<t>Additions to the sub-registry "CoAP Resource Type", within the "CoRE parameters" registry are specified below. These can be registered  either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
 ace.rt.rv needs registration with IANA
 ace.rt.vs needs registration with IANA
 ace.rt.es needs registration with IANA
 ace.rt.ra needs registration with IANA
]]></artwork></figure>

</section>
<section anchor="the-ietf-xml-registry" title="The IETF XML Registry">

<t>This document registers two URIs in the IETF XML registry <xref target="RFC3688"/>.
Following the format in <xref target="RFC3688"/>, the following registration is
requested:</t>

<figure><artwork><![CDATA[
  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.

  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.
]]></artwork></figure>

</section>
<section anchor="the-yang-module-names-registry" title="The YANG Module Names Registry">

<t>This document registers two YANG modules in the YANG Module Names
registry <xref target="RFC6020"/>.  Following the format defined in <xref target="RFC6020"/>, the
the following registration is requested:</t>

<figure><artwork><![CDATA[
  name:         ietf-constrained-voucher
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  prefix:       vch
  reference:    RFC XXXX

  name:         ietf-constrained-voucher-request
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained
                                           -voucher-request
  prefix:       vch
  reference:    RFC XXXX
]]></artwork></figure>

</section>
<section anchor="the-rfc-sid-range-assignment-sub-registry" title="The RFC SID range assignment sub-registry">

<figure><artwork><![CDATA[
------------ ------ --------------------------- ------------
Entry-point | Size | Module name               | RFC Number
------------ ------ --------------------------- ------------
1001100       50     ietf-constrained-voucher    [ThisRFC]
1001150       50     ietf-constrained-voucher    [ThisRFC}
                                 -request
----------- ------  --------------------------- ------------
]]></artwork></figure>

<t>Warning: These SID values will change when they transfer to the range 1000 - 59,999 allocated for SIDs in YANG modules defined in RFCs.</t>

</section>
<section anchor="the-smi-security-for-smime-cms-content-type-registry" title="The SMI Security for S/MIME CMS Content Type Registry">

<t>This document registers an OID in the "SMI Security for S/MIME CMS
Content Type" registry (1.2.840.113549.1.9.16.1), with the value:</t>

<figure><artwork><![CDATA[
  Decimal  Description                             References
  -------  --------------------------------------  ----------
  TBD1      id-ct-animaCBORVoucher                 [ThisRFC]
]]></artwork></figure>

<t>EDNOTE: should a separate value be used for Voucher Requests?</t>

</section>
<section anchor="media-type-registry" title="Media-Type Registry">

<t>This section registers the 'application/voucher-cms+cbor' media type and the 'application/voucher-cose+cbor' in the
"Media Types" registry.  These media types are used to indicate that
the content is a CBOR voucher either signed with a cms structure or a COSE_Sign1 structure <xref target="RFC8152"></xref>.</t>

<section anchor="applicationvoucher-cmscbor" title="application/voucher-cms+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cms+cbor
Required parameters:  none
Optional parameters:  none
Encoding considerations:  CMS-signed CBOR vouchers are CBOR
  encoded.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
<section anchor="applicationvoucher-cosecbor" title="application/voucher-cose+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cose+cbor
Required parameters:  none
Optional parameters:  cose-type
Encoding considerations:  COSE_Sign1 CBOR vouchers are COSE objects
                          signed with one signer.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
</section>
<section anchor="coap-content-format-registry" title="CoAP Content-Format Registry">

<t>Additions to the sub-registry "CoAP Content-Formats", within the "CoRE
Parameters" registry are needed for two media types. These can be registered
either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
Media type                    mime type    Encoding   ID  References
----------------------------  -----------  --------- ---- ----------
application/voucher-cms+cbor      - -        CBOR    TBD2  [This RFC]
application/voucher-cose+cbor "COSE-Sign1"   CBOR    TBD3  [This RFC]
]]></artwork></figure>

</section>
</section>
<section anchor="acknowledgements" title="Acknowledgements">

<t>We are very grateful to Jim Schaad for explaining COSE and CMS choices.</t>

<t>Michel Veillette did extensive work on pyang to extend it to support the
SID allocation process, and this document was among the first users.</t>

<t>We are grateful for the suggestions done by Esko Dijk.</t>

</section>
<section anchor="changelog" title="Changelog">

<t>-04
    voucher and request-voucher MUST be signed
    examples for signed request are added in appendix
    IANA SID registration is updated
    SID values in examples are aligned
    signed cms examples aligned with new SIDs</t>

<t>-03</t>

<figure><artwork><![CDATA[
Examples are inverted.
]]></artwork></figure>

<t>-02</t>

<figure><artwork><![CDATA[
Example of requestvoucher with unsigned appllication/cbor is added
attributes of voucher "refined" to optional
CBOR serialization of vouchers improved
Discovery port numbers are specified
]]></artwork></figure>

<t>-01</t>

<figure><artwork><![CDATA[
application/json is optional, application/cbor is compulsory
Cms and cose mediatypes are introduced
]]></artwork></figure>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC7049;
&I-D.ietf-core-yang-cbor;
&I-D.ietf-core-sid;
&RFC7250;
&RFC7252;
&RFC7950;
&RFC5652;
&RFC8152;
&RFC8174;
&RFC8366;
&RFC3688;
&RFC6020;
&I-D.ietf-anima-bootstrapping-keyinfra;
&I-D.ietf-core-object-security;
&I-D.ietf-ace-cbor-web-token;
&I-D.ietf-ace-coap-est;
<reference anchor="ieee802-1AR" target="http://standards.ieee.org/findstds/standard/802.1AR-2009.html">
  <front>
    <title>IEEE 802.1AR Secure Device Identifier</title>
    <author initials="." surname="IEEE Standard">
      <organization></organization>
    </author>
    <date year="2009"/>
  </front>
</reference>


    </references>

    <references title='Informative References'>

&I-D.ietf-netmod-yang-tree-diagrams;
<reference anchor="pledge" target="http://dictionary.reference.com/browse/pledge">
  <front>
    <title>Dictionary.com Unabridged</title>
    <author initials="." surname="Dictionary.com" fullname="Dictionary.com">
      <organization></organization>
    </author>
    <date year="2015"/>
  </front>
</reference>
<reference anchor="duckling" target="https://www.cl.cam.ac.uk/~fms27/papers/1999-StajanoAnd-duckling.pdf">
  <front>
    <title>The resurrecting duckling: security issues for ad-hoc wireless networks</title>
    <author initials="F." surname="Stajano" fullname="Frank Stajano">
      <organization></organization>
    </author>
    <author initials="R." surname="Anderson" fullname="Ross Anderson">
      <organization></organization>
    </author>
    <date year="1999"/>
  </front>
</reference>
<reference anchor="COSE-registry" target="https://www.iana.org/assignments/cose/cose.xhtml">
  <front>
    <title>CBOR Object Signing and Encryption (COSE) registry</title>
    <author initials="." surname="IANA">
      <organization></organization>
    </author>
    <date year="2017"/>
  </front>
</reference>
&RFC6690;
&RFC7030;


    </references>


<section anchor="est-messages-to-est-coaps" title="EST messages to EST-coaps">

<t>This section extends the examples from Appendix A of <xref target="I-D.ietf-ace-coap-est"/>. The CoAP headers are only worked out for the enrollstatus example.</t>

<section anchor="es" title="enrollstatus">

<t>A coaps enrollstatus message can be :</t>

<figure><artwork><![CDATA[
    GET coaps://[192.0.2.1:8085]/est/es
]]></artwork></figure>

<t>The corresponding coap header fields are shown below.</t>

<figure><artwork><![CDATA[
  Ver = 1
  T = 0 (CON)
  Code = 0x01 (0.01 is GET)
  Options
   Option  (Uri-Path)
     Option Delta = 0xb   (option nr = 11)
     Option Length = 0x3
     Option Value = "est"
   Option  (Uri-Path)
     Option Delta = 0x0   (option nr = 11)
     Option Length = 0x2
     Option Value = "es"
  Payload = [Empty]
]]></artwork></figure>

<t>The Uri-Host and Uri-Port Options are omitted because they coincide with the transport protocol destination address and port respectively.</t>

<t>A 2.05 Content response with an unsigned voucher status (ct=60) will then be:</t>

<figure><artwork><![CDATA[
   2.05 Content (Content-Format: application/cbor)

]]></artwork></figure>

<t>With CoAP fields and payload:</t>

<figure><artwork><![CDATA[
   Ver=1
   T=2 (ACK)
   Code = 0x45 (2.05 Content)
   Options
     Option1 (Content-Format)
     Option Delta = 0xC  (option nr 12)
     Option Length = 0x2
     Option Value = 60 (application/cbor)

     Payload (CBOR diagnostic) =
     {
     "version":"1",
     "Status": 1,   / 1 = Success, 0 = Fail  /
     "Reason":"Informative human readable message",
     "reason-context": "Additional information"
     }

     Payload (binary) =
     A46776657273696F6E6131665374617475730166526561736F6E7822
     496E666F726D61746976652068756D616E207265616461626C65206D
     6573736167656e726561736F6E2D636F6E74657874
     764164646974696F6E616C20696E666F726D6174696F6E
~~~

##voucher_status

A coaps voucher_status message can be :

]]></artwork></figure>
<t>GET coaps://[2001:db8::2:1]:61616]/est/vs
~~~~</t>

<t>A 2.05 Content response with a non signed CBOR voucher (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
    A46776657273696F6E6131665374617475730166526561736F6E7822
    496E666F726D61746976652068756D616E207265616461626C65206D
    6573736167656e726561736F6E2D636F6E74657874
    764164646974696F6E616C20696E666F726D6174696F6E

]]></artwork></figure>

</section>
<section anchor="requestvoucher" title="requestvoucher">

<t>Signed request-voucher-request payloads are sent from pledge to Registrar, as explained in Section 5.2 of <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<section anchor="rv" title="signed requestvoucher">

<t>A CMS signed requestvoucher message from JRC to MASA is shown below.
It would be CoAP POSTED to /est/rv.</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/rv
    (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>

<t>The payload would be in binary, but is presented in base64 in this document.</t>

<figure><artwork><![CDATA[
MIIDugYJKoZIhvcNAQcCoIIDqzCCA6cCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggE/MIIBOwIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODEwNDgzNlowLwYJKoZIhvcNAQkEMSIEILEdCTOLs2Zy7w3LgvSZ
XZEadz3LbznoFBs6FMFN91RaMAoGCCqGSM49BAMCBEcwRQIgASjDsIpr0tW/
n6dRHqvvqsqgZlHbtFnErUbWfhS0KD4CIQDDUEqc5wTmRGf0adEQVQzqmIgh
MEgF10vqXv02gL1jLw==
]]></artwork></figure>

<t>A 2.04 Changed response returning CBOR voucher signed with a cms structure(ct=TBD2) will then be:</t>

<figure><artwork><![CDATA[
    2.04 Changed (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>
<figure><artwork><![CDATA[
MIIDuwYJKoZIhvcNAQcCoIIDrDCCA6gCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggFAMIIBPAIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODA3MzQxMFowLwYJKoZIhvcNAQkEMSIEIP2rKa+J8LVdwYEmB2he
uxsz05As0zoAAYkeyNqsh4fiMAoGCCqGSM49BAMCBEgwRgIhALOd2FKbe9FG
kN4Pg7FIgF+//cQv/N+v7tDZMzGBAFN0AiEAu5BI0oQ4o0wZcrDyKoU2GbeX
hlG/g+OgTUftYMJ32so=
]]></artwork></figure>

</section>
</section>
<section anchor="ra" title="requestauditing">

<t>A coaps requestauditing message contains the signed CBOR voucher :</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/ra
    (Content-Format: application/voucher-cms+cbor)
    Payload =
308203ba06092a864886f70d010702a08203ab308203a7020101310d300b
0609608648016503040201300b06092a864886f70d010701a08202413082
023d308201e2a00302010202087e7661d7b54e4632300a06082a8648ce3d
040302305d310b3009060355040613025553310b300906035504080c0243
4131143012060355040a0c0b4578616d706c6520496e6331163014060355
040b0c0d63657274696669636174696f6e3113301106035504030c0a3830
322e3141522043413020170d3139303133313131323931365a180f393939
39313233313233353935395a305c310b3009060355040613025553310b30
0906035504080c024341310b300906035504070c024c4131143012060355
040a0c0b6578616d706c6520496e63310c300a060355040b0c03496f5431
0f300d060355040513065774313233343059301306072a8648ce3d020106
082a8648ce3d03010703420004c8b421f11c25e47e3ac57123bf2d9fdc49
4f028bc351cc80c03f150bf50cff958d75419d81a6a245dffae790be95cf
75f602f9152618f816a2b23b5638e59fd9a3818a30818730090603551d13
04023000301d0603551d0e0416041496600d8716bf7fd0e752d0ac760777
ad665d02a0301f0603551d2304183016801468d16551f951bfc82a431d0d
9f08bc2d205b1160300e0603551d0f0101ff0404030205a0302a0603551d
1104233021a01f06082b06010505070804a013301106092b06010401b43b
0a01040401020304300a06082a8648ce3d0403020349003046022100c0d8
1996d2507d693f3c48eaa5ee9491bda6db214099d98117c63b361374cd86
022100a774989f4c321a5cf25d832a4d336a08ad67df20f1506421188a0a
de6d3492363182013f3082013b0201013069305d310b3009060355040613
025553310b300906035504080c02434131143012060355040a0c0b457861
6d706c6520496e6331163014060355040b0c0d6365727469666963617469
6f6e3113301106035504030c0a3830322e31415220434102087e7661d7b5
4e4632300b0609608648016503040201a069301806092a864886f70d0109
03310b06092a864886f70d010701301c06092a864886f70d010905310f17
0d3139303430383130343833365a302f06092a864886f70d010904312204
20b11d09338bb36672ef0dcb82f4995d911a773dcb6f39e8141b3a14c14d
f7545a300a06082a8648ce3d0403020447304502200128c3b08a6bd2d5bf
9fa7511eabefaacaa06651dbb459c4ad46d67e14b4283e022100c3504a9c
e704e64467f469d110550cea988821304805d74bea5efd3680bd632f
]]></artwork></figure>

<t>A 2.05 Content response returning a log of the voucher (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
{
 "version":"1",
 "events":[
   {
    "date":"<date/time of the entry>",
    "domainID":"<domainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
    "truncated":"<the number of domainID entries truncated>"
   },
   {
    "date":"<date/time of the entry>",
    "domainID":"<anotherDomainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
   }
 ],
  "truncation": {
    "nonced duplicates": "<total number of entries truncated>",
    "nonceless duplicates": "<total number of entries truncated>",
    "arbitrary": "<number of domainID entries removed entirely>"
  }
}

    [EDNOTE: Change JSON to CBOR; Serialize CBOR payload to binary]
]]></artwork></figure>

</section>
</section>
<section anchor="signed-voucher-request-examples" title="Signed voucher-request examples">

<section anchor="cmssign" title="CMS signed voucher-request example">

<t>The voucher-request example, visualized in CBOR diagnostic notation in <xref target="example2"/> is shown as a hexadecimal dump of the binary file.</t>

<figure><artwork><![CDATA[
    A11A000F46C2A90274323031362D31302D30375431393A33313A34325A0
    474323031362D31302D32315431393A33313A34325A01020d6d4A414441
    313233343536373839054401020D0F0A4401020D0F03F50674323031372
    D31302D30375431393A33313A34325A0c4401020D0F
]]></artwork></figure>

<t>The voucher-request example has been signed by using the WT1234 certificate and key pair shown in Appendix C of <xref target="I-D.ietf-ace-coap-est"/>.
The CMS signing of the binary voucher-request leads to a binary signed voucher-request, shown with a hexadecimal representation shown in the payload of the request part of <xref target="rv"/> and <xref target="ra"/>.</t>

<t>The breakdown of the CMS signed binary voucher-request file is visualized below:</t>

<figure><artwork><![CDATA[
CMS_ContentInfo:
  contentType: pkcs7-signedData (1.2.840.113549.1.7.2)
  d.signedData:
    version: 1
    digestAlgorithms:
        algorithm: sha256 (2.16.840.1.101.3.4.2.1)
        parameter: <ABSENT>
    encapContentInfo:
      eContentType: pkcs7-data (1.2.840.113549.1.7.1)
      eContent: <ABSENT>
    certificates:
      d.certificate:
        cert_info:
          version: 2
          serialNumber: 9112578475118446130
          signature:
            algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
            parameter: <ABSENT>
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                       CN=802.1AR CA
          validity:
            notBefore: Jan 31 11:29:16 2019 GMT
            notAfter: Dec 31 23:59:59 9999 GMT
          subject: C=US, ST=CA, L=LA, O=example Inc,
                                          OU=IoT/serialNumber=Wt1234
          key:
            algor:
              algorithm: id-ecPublicKey (1.2.840.10045.2.1)
              parameter: OBJECT:prime256v1 (1.2.840.10045.3.1.7)
            public_key:  (0 unused bits)
              0000 - 04 c8 b4 21 f1 1c 25 e4-7e 3a c5 71 23 bf
              000e - 2d 9f dc 49 4f 02 8b c3-51 cc 80 c0 3f 15
              001c - 0b f5 0c ff 95 8d 75 41-9d 81 a6 a2 45 df
              002a - fa e7 90 be 95 cf 75 f6-02 f9 15 26 18 f8
              0038 - 16 a2 b2 3b 56 38 e5 9f-d9
          issuerUID: <ABSENT>
          subjectUID: <ABSENT>
          extensions:
              object: X509v3 Basic Constraints (2.5.29.19)
              critical: BOOL ABSENT
              value:
                0000 - 30
                0002 - <SPACES/NULS>

              object: X509v3 Subject Key Identifier (2.5.29.14)
              critical: BOOL ABSENT
              value:
                0000 - 04 14 96 60 0d 87 16 bf-7f d0 e7 52 d0
                000d - ac 76 07 77 ad 66 5d 02-a0

              object: X509v3 Authority Key Identifier (2.5.29.35)
              critical: BOOL ABSENT
              value:
                0000 - 30 16 80 14 68 d1 65 51-f9 51 bf c8 2a
                000d - 43 1d 0d 9f 08 bc 2d 20-5b 11 60

              object: X509v3 Key Usage (2.5.29.15)
              critical: TRUE
              value:
                0000 - 03 02 05 a0

              object: X509v3 Subject Alternative Name (2.5.29.17)
              critical: BOOL ABSENT
              value:
                0000 - 30 21 a0 1f 06 08 2b 06-01 05 05 07 08
                000d - 04 a0 13 30 11 06 09 2b-06 01 04 01 b4
                001a - 3b 0a 01 04 04 01 02 03-04
        sig_alg:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:  (0 unused bits)
          0000 - 30 46 02 21 00 c0 d8 19-96 d2 50 7d 69 3f 3c
          000f - 48 ea a5 ee 94 91 bd a6-db 21 40 99 d9 81 17
          001e - c6 3b 36 13 74 cd 86 02-21 00 a7 74 98 9f 4c
          002d - 32 1a 5c f2 5d 83 2a 4d-33 6a 08 ad 67 df 20
          003c - f1 50 64 21 18 8a 0a de-6d 34 92 36
    crls:
      <EMPTY>
    signerInfos:
        version: 1
        d.issuerAndSerialNumber:
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                     CN=802.1AR CA
          serialNumber: 9112578475118446130
        digestAlgorithm:
          algorithm: sha256 (2.16.840.1.101.3.4.2.1)
          parameter: <ABSENT>
        signedAttrs:
            object: contentType (1.2.840.113549.1.9.3)
            value.set:
              OBJECT:pkcs7-data (1.2.840.113549.1.7.1)

            object: signingTime (1.2.840.113549.1.9.5)
            value.set:
              UTCTIME:Jul  3 08:53:30 2019 GMT

            object: messageDigest (1.2.840.113549.1.9.4)
            value.set:
              OCTET STRING:
                0000 - d4 b0 5c dd c8 b4 91 28-4a 18 ca 25 9d
                000d - be d0 60 23 cf ad a0 aa-c2 95 ac e9 3f
                001a - 0b 4f 44 9e 25
                0020 - <SPACES/NULS>
        signatureAlgorithm:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:
          0000 - 30 46 02 21 00 e5 e1 7f-23 c3 aa 14 9f 35 64
          000f - 1e c4 4a 0f 68 fe b0 16-3b e6 7c 06 51 af bf
          001e - 5a a0 99 59 e0 28 1f 02-21 00 b4 07 2f 7c c4
          002d - f9 26 0c 6d 47 a7 93 56-de b8 da f7 23 f0 af
          003c - 2b 59 16 cc 36 63 e7 91-89 39 df df
        unsignedAttrs:
          <EMPTY>



]]></artwork></figure>

</section>
</section>
<section anchor="cosesign" title="COSE examples">

<t>These examples are from the https://minerva.sandelman.ca/ reference code,
using the unit test case key pairs, with a flow between pledge ("reach"
code), JRC ("fountain") code, and MASA ("highway") code.  This example
comes from the spec/files/product/00-D0-E5-F2-00-03 directory.</t>

<t>Thanks to Jim Schaad for verifying the COSE Sign1 objects: faults were found
and corrected.</t>

<section anchor="device-registrar-and-masa-keys" title="Device, Registrar and MASA keys">

<t>This first section documents the public and private keys used in the
subsequent test vectors below.  These keys come from test code and are not used in any
production system, and should only be used only to validate implementations.</t>

<section anchor="device-idevid-certificate" title="Device IDevID certificate">

<figure><artwork><![CDATA[
Certificate:
  Data:
    Version: 3 (0x2)
    Serial Number: 787697345 (0x2ef34ec1)
    Signature Algorithm: ecdsa-with-SHA256
    Issuer: C = Canada, ST = Ontario, OU = Sandelman, CN = h
ighway-test.example.com CA
    Validity
      Not Before: Feb 14 17:05:09 2019 GMT
      Not After : Dec 31 00:00:00 2999 GMT
    Subject: serialNumber = 00-D0-E5-F2-00-03
    Subject Public Key Info:
      Public Key Algorithm: id-ecPublicKey
        Public-Key: (256 bit)
        pub:
          04:82:c4:28:5b:7c:f0:37:18:c7:90:14:dc:cb:f4:
          4d:7e:b0:00:ed:c0:de:bd:4d:25:55:4e:35:f9:d5:
          6a:57:14:b4:94:af:ce:6d:53:c8:60:c2:ce:53:3f:
          2c:1b:42:f1:c0:8b:5f:c1:7b:3d:f3:29:54:87:46:
          86:a4:0c:8b:b7
        ASN1 OID: prime256v1
        NIST CURVE: P-256
    X509v3 extensions:
      X509v3 Subject Key Identifier: 
        C8:A3:87:72:82:82:E6:EA:90:D0:E1:81:BC:C7:51:08:78:0
F:D7:52
      X509v3 Basic Constraints: 
        CA:FALSE
      X509v3 Subject Alternative Name: 
        othername:<unsupported>
      1.3.6.1.4.1.46930.2: 
        ..highway-test.example.com:9443
  Signature Algorithm: ecdsa-with-SHA256
     30:65:02:31:00:b2:9a:7a:1a:74:20:8f:e9:e0:5d:fc:af:d6:
     4a:80:1f:66:e3:bf:17:2e:3e:07:87:39:be:65:bd:94:57:71:
     1f:df:e5:fc:4d:ef:96:8a:3a:03:5b:d1:ca:a1:72:55:a3:02:
     30:13:43:08:a4:af:c8:28:19:d2:a0:93:3d:ed:53:fa:09:7d:
     76:9c:b7:0b:95:2b:8f:2f:b4:fa:87:02:ec:b4:2d:19:92:5b:
     b2:bb:79:04:63:6e:17:0e:79:8a:65:f5:a3
]]></artwork></figure>

</section>
<section anchor="device-private-key" title="Device private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIA1sa0l4bkj/rJxPUN1bKSBNYolVVzx+T28wo60cYpuaoAoGCCqGSM49
AwEHoUQDQgAEgsQoW3zwNxjHkBTcy/RNfrAA7cDevU0lVU41+dVqVxS0lK/ObVPI
YMLOUz8sG0LxwItfwXs98ylUh0aGpAyLtw==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="registrar-certificate" title="Registrar Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB0TCCAVagAwIBAgIBAjAKBggqhkjOPQQDAzBxMRIwEAYKCZImiZPyLGQBGRYC
Y2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xQDA+BgNVBAMMNyM8U3lzdGVt
VmFyaWFibGU6MHgwMDAwMDAwNGY5MTFhMD4gVW5zdHJ1bmcgRm91bnRhaW4gQ0Ew
HhcNMTcxMTA3MjM0NTI4WhcNMTkxMTA3MjM0NTI4WjBDMRIwEAYKCZImiZPyLGQB
GRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xEjAQBgNVBAMMCWxvY2Fs
aG9zdDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJZlUHI0up/l3eZf9vCBb+lI
noEMEgc7Ro+XZCtjAI0CD1fJfJR/hIyyDmHWyYiNFbRCH9fyarfkzgX4p0zTizqj
DTALMAkGA1UdEwQCMAAwCgYIKoZIzj0EAwMDaQAwZgIxALQMNurf8tv50lROD5DQ
XHEOJJNW3QV2g9QEdDSk2MY+AoSrBSmGSNjh4olEOhEuLgIxAJ4nWfNw+BjbZmKi
IiUEcTwHMhGVXaMHY/F7n39wwKcBBSOndNPqCpOELl6bq3CZqQ==
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="jrcpriv" title="Registrar private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFZodk+PC5Mu24+ra0sbOjKzan+dW5rvDAR7YuJUOC1YoAoGCCqGSM49
AwEHoUQDQgAElmVQcjS6n+Xd5l/28IFv6UiegQwSBztGj5dkK2MAjQIPV8l8lH+E
jLIOYdbJiI0VtEIf1/Jqt+TOBfinTNOLOg==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="masa-certificate" title="MASA Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB3zCCAWSgAwIBAgIEG5lfVDAKBggqhkjOPQQDAjBdMQ8wDQYDVQQGEwZDYW5h
ZGExEDAOBgNVBAgMB09udGFyaW8xEjAQBgNVBAsMCVNhbmRlbG1hbjEkMCIGA1UE
AwwbaGlnaHdheS10ZXN0LmV4YW1wbGUuY29tIENBMB4XDTE5MDIxMjIyMjI0MVoX
DTIxMDIxMTIyMjI0MVowXzEPMA0GA1UEBhMGQ2FuYWRhMRAwDgYDVQQIDAdPbnRh
cmlvMRIwEAYDVQQLDAlTYW5kZWxtYW4xJjAkBgNVBAMMHWhpZ2h3YXktdGVzdC5l
eGFtcGxlLmNvbSBNQVNBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqgQVo0S5
4kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+gqi4tMFfSJ0iEwt8kszf
WXK4rLgJS2mnpaMQMA4wDAYDVR0TAQH/BAIwADAKBggqhkjOPQQDAgNpADBmAjEA
vVXlmw77/F6VKeOBsxU1qpMYogS+RHKyUX1NbevR1cEQOrI5e1c/xcywow7nmUa6
AjEA9n9EfbcU+tFnatQRw0uu5vuamFb6hSEuXEhM8D/ymz+uiCCnrvly/1v5eGjP
D0jJ
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="masapriv" title="MASA private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFhdd0eDdzip67kXx72K+KHGJQYJHNy8pkiLJ6CcvxMGoAoGCCqGSM49
AwEHoUQDQgAEqgQVo0S54kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+
gqi4tMFfSJ0iEwt8kszfWXK4rLgJS2mnpQ==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
</section>
<section anchor="cose-signed-requestvoucher-with-registrar-certificate-pinned" title="COSE signed requestvoucher with registrar certificate pinned">

<t>This voucher request has been signed by the pledge, using the private key
given above, and has been sent to the JRC over CoAPS.  This example
uses the proximity-registrar-cert mechanism to request a voucher that
pins the certificate of the registrar.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
D1E49970A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770C5901D4308201D030820157A00
30201020204228ECD27300A06082A8648CE3D040302306E31123010060A0
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
0340F4E6D0F9F702553FA53BE572ACF0EED858275B6AC75994332FB25FB3
A54411E9FA02E6F75FD1AADB7EA9A61F5409E02303E615E75C8F07432A59
0C8D48798BEDA1EB49E5E7D8E0EA118BD17A02D02F0313D144816002F756
B528ABD1B0ADB749D', h'96B82530AC57650346C2BFFB5A6CC16B28F16F
ACFE5A2FD1BCF3D5F5D62733F7F7812D67D43BE1CF9906E356FB0C2BDD36
777FD7DBAE22B8CEB07D51D8F55AD3'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZAhyhGgAPRsKlAWlwcm94aW1pdHkCwRpdHkmXClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwxZAdQwggHQMIIBV6AD
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
NA9ObQ+fcCVT+lO+VyrPDu2FgnW2rHWZQzL7Jfs6VEEen6Aub3X9Gq236pph
9UCeAjA+YV51yPB0MqWQyNSHmL7aHrSeXn2ODqEYvRegLQLwMT0USBYAL3Vr
Uoq9GwrbdJ1YQJa4JTCsV2UDRsK/+1pswWso8W+s/lov0bzz1fXWJzP394Et
Z9Q74c+ZBuNW+wwr3TZ3f9fbriK4zrB9Udj1WtM=
]]></artwork></figure>

</section>
<section anchor="cose-signed-parboiled-requestvoucher" title="COSE signed parboiled requestvoucher">

<t>This voucher request has been signed by the JRC using the private key from
<xref target="jrcpriv"/>.  Contained within this voucher request is the pledge voucher
request above.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
9DD3BFD0A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770B590266D28441A0A059021CA11
A000F46C2A5016970726F78696D69747902C11A5D1E49970A5130302D443
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
AADB7EA9A61F5409E02303E615E75C8F07432A590C8D48798BEDA1EB49E5
E7D8E0EA118BD17A02D02F0313D144816002F756B528ABD1B0ADB749D584
096B82530AC57650346C2BFFB5A6CC16B28F16FACFE5A2FD1BCF3D5F5D62
733F7F7812D67D43BE1CF9906E356FB0C2BDD36777FD7DBAE22B8CEB07D5
1D8F55AD3', h'EAE868ECC176883766C5DC5BA5B8DCA25DAB3C2E56A551
CE5705B793914348E1F93C2B81E88CCBE28E90800F66945EFBBECE4F741D
0EDE18EB1008EF7E9A279C'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZAq6hGgAPRsKlAWlwcm94aW1pdHkCwRpZ3Tv9ClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwtZAmbShEGgoFkCHKEa
AA9GwqUBaXByb3hpbWl0eQLBGl0eSZcKUTAwLUQwLUU1LUYyLTAwLTAzB3Zf
 ** KNOWN TO BE BAD, NOT YET VALIDATED **
U75XKs8O7YWCdbasdZlDMvsl+zpUQR6foC5vdf0arbfqmmH1QJ4CMD5hXnXI
8HQypZDI1IeYvtoetJ5efY4OoRi9F6AtAvAxPRRIFgAvdWtSir0bCtt0nVhA
lrglMKxXZQNGwr/7WmzBayjxb6z+Wi/RvPPV9dYnM/f3gS1n1Dvhz5kG41b7
DCvdNnd/19uuIrjOsH1R2PVa01hA6uho7MF2iDdmxdxbpbjcol2rPC5WpVHO
VwW3k5FDSOH5PCuB6IzL4o6QgA9mlF77vs5PdB0O3hjrEAjvfponnA==
]]></artwork></figure>

</section>
<section anchor="cose-signed-voucher" title="COSE signed voucher">

<t>The resulting voucher is created by the MASA and returned via the JRC to the
Pledge.  It is signed by the MASA's private key <xref target="masapriv"/> and can be
verified by the pledge using the MASA's publie key.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F468CA505666C6F6767656406C11A5D1E499
A0E7130302D44302D45352D46322D30302D30330B765F715674477738565
342626C65394D34557036354C770C7902744D49494230544343415661674
177494241674942416A414B42676771686B6A4F50515144417A42784D524
9774541594B435A496D695A50794C4751424752594359324578475441584
2676F4A6B69614A6B2F49735A41455A46676C7A5957356B5A57787459573
4785144412B42674E5642414D4D4E794D3855336C7A64475674566D46796
1574669624755364D4867774D4441774D4441774E4759354D5446684D443
4675657357A64484A31626D6367526D3931626E526861573467513045774
868634E4D5463784D5441334D6A4D304E5449345768634E4D546B784D544
1334D6A4D304E544934576A42444D5249774541594B435A496D695A50794
C47514247525943593245784754415842676F4A6B69614A6B2F49735A414
55A46676C7A5957356B5A57787459573478456A415142674E5642414D4D4
3577876593246736147397A6444425A4D424D4742797147534D343941674
54743437147534D34394177454841304941424A5A6C5548493075702F6C3
3655A6639764342622B6C496E6F454D45676337526F2B585A43746A41493
0434431664A664A522F68497979446D48577959694E46625243483966796
172666B7A67583470307A54697A716A4454414C4D416B474131556445775
1434D414177436759494B6F5A497A6A304541774D44615141775A6749784
14C514D4E75726638747635306C524F443544515848454F4A4A4E5733515
632673951456444536B324D592B416F537242536D47534E6A68346F6C454
F6845754C674978414A346E57664E772B426A625A6D4B694969554563547
7484D68475658614D48592F46376E333977774B634242534F6E644E50714
3704F454C6C36627133435A71513D3D', h'7468FB16A4035FDAF510DBF5
A88F67B6FB849CFBA8B094B77AD5248900E4BCD6E892FE74B39AB787637B
121944BED4D1CB4B8DC8F59212EAC2AD20469C71C1F6'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZArmhGgAPRoylBWZsb2dnZWQGwRpdHkmaDnEwMC1EMC1FNS1GMi0w
MC0wMwt2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwx5AnRNSUlCMFRDQ0FWYWdB
d0lCQWdJQkFqQUtCZ2dxaGtqT1BRUURBekJ4TVJJd0VBWUtDWkltaVpQeUxH
UUJHUllDWTJFeEdUQVhCZ29Ka2lhSmsvSXNaQUVaRmdsellXNWtaV3h0WVc0
eFFEQStCZ05WQkFNTU55TThVM2x6ZEdWdFZtRnlhV0ZpYkdVNk1IZ3dNREF3
TURBd05HWTVNVEZoTUQ0Z1ZXNXpkSEoxYm1jZ1JtOTFiblJoYVc0Z1EwRXdI
aGNOTVRjeE1UQTNNak0wTlRJNFdoY05NVGt4TVRBM01qTTBOVEk0V2pCRE1S
SXdFQVlLQ1pJbWlaUHlMR1FCR1JZQ1kyRXhHVEFYQmdvSmtpYUprL0lzWkFF
WkZnbHpZVzVrWld4dFlXNHhFakFRQmdOVkJBTU1DV3h2WTJGc2FHOXpkREJa
TUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCSlpsVUhJMHVwL2wz
ZVpmOXZDQmIrbElub0VNRWdjN1JvK1haQ3RqQUkwQ0QxZkpmSlIvaEl5eURt
SFd5WWlORmJSQ0g5ZnlhcmZremdYNHAwelRpenFqRFRBTE1Ba0dBMVVkRXdR
Q01BQXdDZ1lJS29aSXpqMEVBd01EYVFBd1pnSXhBTFFNTnVyZjh0djUwbFJP
RDVEUVhIRU9KSk5XM1FWMmc5UUVkRFNrMk1ZK0FvU3JCU21HU05qaDRvbEVP
aEV1TGdJeEFKNG5XZk53K0JqYlptS2lJaVVFY1R3SE1oR1ZYYU1IWS9GN24z
OXd3S2NCQlNPbmROUHFDcE9FTGw2YnEzQ1pxUT09WEB0aPsWpANf2vUQ2/Wo
j2e2+4Sc+6iwlLd61SSJAOS81uiS/nSzmreHY3sSGUS+1NHLS43I9ZIS6sKt
IEacccH2
]]></artwork></figure>

</section>
</section>


  </back>

<!-- ##markdown-source:
H4sIACFsI10AA+19e3PbRrbn//gUXXTVWtpLUniQ4GPGM6NIcqLEsryinMxU
KuVqAk0JYxLgAKAUjeP72fd3TnfjQVKynUzm7t26TGyT6Pd5n9OnG71ezymT
cqmm4iRLizKXSapi8X22iW5VLo7zMlnIqCzEIsvFV1lWUpX1OklvxJs8K7Mo
WxaOnM9zdbe3ByfOolSu0H2cy0XZS1S56Mk0WcleVNfu3enaPXfoOM9EUco0
fieXWYp2Zb5RjpOsc/5alL7rTlzfkbmSU3GelipPVenc30wFdyt+yPL3NL2v
82yzdt7f15V6pzQFJ5LlFEPEjhNlMWpOxaboySJKEmedTAU+z0QkUzxVQua5
fBAHyULI5VI8qOJQAA63srgVmK5yhAAIplSAr0WWl7laFFPuIlYLuVkCcmVm
yx9Wuph+OnJT3mb51HGcnkhSPL3oi6skupV5XGQpqmuwXdAjtWwXZTlmPQOQ
1HKFmc6yRXkPgPDaaSS1kslyKlZR/h8E8L8Utmo/ktV4b/riDo1joHlWZu+r
Ed8ogGu7iEe8o27yAk8EIQ+rk2n0UI/XePiXum4fbZuDfidXa5nK90lRDynT
rGgX8IAnSRFlYvZQlGrVWNf6va75l4jK+1G2cpw0y1eyTO7UFPWuXp74njcx
X0fugL+e9077TH9Rlqveg0xvetGcULBdVCSxbeoP3fqrb79OqqfDsHo69hpf
RwP7NQhD8zUIx2PzNXR9tzWuZol5k8F679VDki5yuTvBbP53FZW9QkWbPCkf
2j1FipfVu1fzHsCv0t3iTK57qiipIFFKjV2/5x1f0U8QtMxvFDikc1uW6+nR
ETMjUV6fqhIyjxZJGoOBiqrsCD300UOPmLN/W66WHd2Xliyd87OzM2HqiBnN
WolTdZdESpzHKoWMSVSum1i2EPxhmtHNZ2YsXS2WJTqm4SAb0kUT+dVSwfKr
LNaIBmOqXpzIm1yuCqq1Xqr4Rk1b0zxNojLJUpk/EE2Jt6mc5wlqmTG3IRPX
1cHXEAdppKjh0TzP7gt1pIfYt6ye+dfSf3vg1gI9SET82kTvlySrWvO9vlUi
V8Umz0ENJPOqasKShkiKYqO0+JZx7zaLxH2Sq6UqCgH43JPA2LO6Asu7v7/v
R0tIjFVfRv3N+6P/XKwKf3S0lmsw9pE3mUx6QMrfwbvHadyzY/fX8eLpNTNS
X/aFabwFi5e5TN9vlW21veqLY5YuLAybja8yrKtVpuFIkyU4nlzOznq5uknA
ZQ9tYJ58dXklLpmxxCy5SQmeoDhxlkb5w5rQIw6o+aGw7Z+AWwLpxKwiiwJ9
rUDjxVGUgSjor/7PNYvspffj18dtMvdGRm6Ek0oeuQG+Or1eT8g5CY2odJzr
26QQULkbGpFUELRrIaSg8lLdPJAyYtJQyweh54ZSTahUJlMnu09V3oX20wCA
CtQmgKDKKu6KOCFyQ3uQFASB+dUVc/R+qxzd2fNCQN1sqCEGy/tC8NSqzvD9
fYqhMAlMoGP0f6e/vYT5JlnGhdisAX70LohgMar48MHI1o8fuwKMx5rcKQ1D
LJkb6sFSQdjFJN5Cp98n5a0A5fOCJE1PlCq6TbNldpMQtKDXY1VEeTJXMSZ0
HMcJc+eSVlm2pqd+Xi9hwRTiNrsXDYNGmAURFB7EXDl4nhZrGAgooyWnaFqq
tCCyAtxp4h8+7BXSHz+KtbG0+hrdqySOl4oMJVg2eQbGo+k5zlmaZ8slzytb
gLvvRZphIVg+RmhOzjK+BkWrhBo4a8CQetmkyT82SsDwWC5VeqMKRg8EHcFI
zMEd90mMHohNgAElijVmbkWOHhSLjAH4Y1hHyw1zUQHIAAZOc71PaD+sX8MQ
HWZiSdxGCIWNsiqwTqcxMAiynlSu/rEBbcY7JFVzRQthQBbNDpBr0FbfuZIl
GcLlLVBWqDyRy+SfRFyEsb8dv/5ad8cEQtP6dnb5uisSJnBbHb0TChyWMAfc
O5kkHz8e7sxtAQRCdxDHJqsEiwVbbUqgBR2yoozkkph5w2yloVhPFobgShF/
02yYkMVSLUAN6IIaE9f3G/RcV72Vd0CoUuDHOFaETeiyPGWN43gQt6YNgcfa
6gRg0CdgryIocJjVVAHErQEcazb9TBx3Hb8xCkjncW6opyAqrhJmMqAIIBKO
yPEbTavM+A0caU3ITLyHXYU2JBhydhUsCFmyrCAlsIpiJax42Fpi267EVLUQ
pbaz81Onbm/Exg6MrPVJuBTHBbcE1S+5F2YnrK50NN0ZmjH8DfJcQisRdDCW
AGQLpsEygeOCURKuuCDbvKv7lfOlIgai6ndySSxrGB/zYi4vbrPNMibWI1iB
AHMWEcbWEnmDNUjyg8zWG54B9b8mQPDsCRMQtysFTRcTz7LktZCp5TWjSpu2
BgNGCDO/A2WOXbMmysuUZI04uZhpliVbnFgWlESYz3h2VAFa+x2pdM+wtkf1
zEgk056Ja0iThDXAg6g+H541Hn/U5KQZlOfOAqhJKdtqicQilcORjJ2KfVnx
6hWB0qoVVdoK0mO1zoFTaNoM/k7aFd9mSepcaatD5kcnWZZD3ckSlHzw7dXJ
YVdcNHStOGaTguWONWTMo/LBObg4nh2jhVbTXXFNPjXh5GUCb40V5MH15cu3
h3r+xo1nIF1piaqJ7hWwu5GQxR+egfeW+GUgBMojLQ1Edy7ezq47Xf2veH3J
36/O/s/b86uzU/o+++b41avqi3BMldk3l29fndbf6qYnlxcXZ69PdWs8Fe1H
Tufi+G8dPfHO5Zvr88vXx686lnpqKUtIAcsw/wKNoHqjlp0WyX118kZ4A41T
cidBM4Z+RgN8v79VqR4rS4FU/RM09yAciDclyTrisEEk10kpl0WXhgBPweoh
9mKYzjb5HVoA/jbkcv2wpvBAg5JI/98lsbHiK8uC6Qc2HCQC1fgZCqNk3pYl
Bxc0vZXKcJmhHp4wN03SaLmB7oyTBTsv6GyVbQi3mI1EY0h4iKkHh8wPrSh2
dWmGWZF2Wsn3UEfpQ23WFNauKWlBDanNVkSyIgOiaFpKhBUzp7jGWSW5tSa8
geDRrOM05XfMzqTuAzMgIgVKNukyeU9fMBPWcDKC6csgwfiMrCR3KM6DkSBZ
6xYQvxcZ2AFleWEkWqH2W3j3JGFh4oEKUMDw5UfU75LkZErKlMFhENmErmhB
t4l1K1aYugiQVknVkoLGIuiT9LX0c2XUcl3r/jaBxXX/KzXzo/bTPCPTb68a
Zcm3r8QaDX0SFQ+MrlrnJNrEh+xQ+XaDrpG8qAY/Q1YjoTFcg0I5stAEkxit
SQSme2JiZ77MCP1PrwfKpKcdncYQxrSgVdnxCga+Q6pFfFZ9XjHTBKiJVFbl
fRQk8JfkeZR1jTffnf/VWiOwxEptYNlugCKKmmr90Iu0BNA2e2INbDufrgVJ
oxuroyudYoylx3C577k1/1i4Q5RqKJiOzCoYE8bTIjWkFwQ7g/Rq2VwvA/+x
RXcdBqW8F+vNfJlE2ro5uHrz3SEY9QdIOoHvRaVsuy12WbOLxITDZhwpQIKg
hkq71x3ATLVP24J3sdHhN92MWKVHIagnQF8P4uwbpK8pksVdy+TZdTG09boX
U6xPTikiyqKMQPb26txQu7H0qwH0vL66mn13viWyz2bXbG23HbS2CU6SvTK9
m7Cew7MkL6JSN13SHj/r2ZgwQ22hs5nWGJ31ModTsCqMAX4H/xfZJo+U03Za
ixVpVnh97xVMODGTd0Rft0oSx1s3lBgLM5Sk2ljrKadaHcGGDeRbcsprK5bW
T2WGkDVbRVqsLzPj5ACBB2tJYYTskButZApbSIsTWUptFhpUaMpDLzEHJcTX
Z9cV82CRnaP+vVouexwOOSIPoGPUoK5uAcB6FER/feisZS5XHKXXsQxCABnw
ooN199FvRxsqFC0iV+LtWrvd0EJF15gDkDwpOnpYZtLoK3LWpSG7HMqgHtnQ
K0HGPgPMz9nJ3ayNnndIijEIpPXhotssI+UKjm91+AfUz7PNzS05pm3TjDpS
P0vqamsSRwQvGrCopEyNTKhpoirgrTD2jFjk2aqJUNIbrHIj63kUINmVcjhu
R6W6K0I0fmiv9oHqWhKppsKop4BjAUfkP/FxhG5son9mARwLxqyPuIMeNdC1
nZfJDbnvQxYZhjODvt/3q/ADRffAaCoFWMhi0fyaremH5hVoHxCL1i9MKjSr
wih7or9iszYBJywHQOijZ8ymt8mTpk1JEF+ZLb0KZluCgeFnCN7CtMFGVAKU
/GKa/dIo/gVPjwy1GyFBD+50gXnyrgDNbFAZT0wTxbGs+jkm2upLgj1K+GVU
lksUfZiKZ2Z1OqT74rmejZ12PSd68hzeyta8ujvzIVJoz4TgmipFFqoVdSbg
yZWb+pTVkpUBlbNLJM0zsoK8xVSaOQ0xw5exfEpPFxvwaIsECyvVmCdMsK3U
9nZfWJWCMjRl98RZkadNrNWqq6lFR3HQD81sm7P64iWeGrrmWTq1J7yCzEKP
VFSqyuKhsddZUSTzJbk6hk3g/k1ZAu5IvT/n5Qsjvv63wzVnU+H33SFtK9Nk
8eyPxE5/+oNA1UrU2ccgqnYJHnT+EJUvrr869QX+Cqqad8VWzbuCaw5dEbpV
LbVdS+2rlcvtUeXWqJrlryupa8WpwUHP4EAH/rgAxmBaNgQoaxhyR8CmebbO
Ezbh4Gswv+5HKkBuZ8G7dNp5NKDsvdRGVgcdLk3kzhJ/L1oV/0HxK2116U6C
L+4E8+ZeKKTfblAInhV1zj1vhVBa+sAG8dojHrSG/HuRpZ1DAbQQx8wbgq+/
M3K7Jc/vENjs8pS69Zwqo7buCsZVlQ3xpFFld2PEAW06HjatNzgpVejPaTth
j25WQlYvKDRjt1AqwS3FbXJz21uqO7V07hJ1v0VY7LcqydpAz1tDU2t4vflD
IaI6/Ndyx9g6A/E1QsO2SR0SzTdL3mDYH8TsavtEchjE2k7sjpEzuoKthnlL
no7ZUoUUSfrafCPBA5+eAP9MPObcUuEzcQ14wfJleG2H6QwYSRrx3gGF30S8
0USg9oGsGcNzKgNLNiLgVbSlV9m5jzkF2v7drkzOjaY2MHOWG4+zt+MkO08V
05I4NsDS36qjlmNRKQjyefp7p/KYM6NNJY4J75+/YzVYHW9pOiWRZKfXOX89
O7u6fvfy/Ot3L68uL/Dl1ZkwdLKb/2OWxhzQL38uxdnrU43jmkx/bZ8gyXaX
7FtdwDmkzbTzdNuv2oE3119x/baHCUR05OZmxXzTYaI3dnSHcNMRN5SLxKYk
zAjtJrCnyLxAgpzoL0k32YaEShXEN2yJ7m9UymZgvM8B3JmoniNbqF2OQFa+
fFlCTm1KE774ZEdVfQgDuPF1c8s3dUgKa821EO+Y2Gq21rtMv5YI/nJ6fH3W
512ECmVnxjXYDkJUW70fnhkjxYeB95WCECDwSb23YDfkKifuU+tPbLw2SVmQ
pFDCSaQ7SzPt6BgvFoa6ccJMvzoyyz57opYx9RXJZbRZSuPdAkT/VHlG1nlj
V4FaLm8oVn+7aocDrLaZ9MP+oOkqTIYuh+n2QtmAozjaZgdT4DV5opKztXy9
rrH8nIRBspL5g1hv8nWmbbzPzChg9dVgGc7Z0QrTVNaeC0WtKW2lNLtPjt16
shF7EtLc4eP7utX2IIe5K/RzmgDDkowZ9mudKsZieKZhiMwMvIf9QPd0C6XF
itCoQdYNJxczJzOOOEUD+/8elVQFhVt66XPCVF/Mjv9KWdySwV8ihP+fF76/
Wej+1wjbzxGyskoCrqSrV0lXbb59kXj9/1Ks7opTmr8NfJvJ28hWEwAfPsDh
ono8GHGXadMMwO8o5toTIYzZ/QQyy3nc87Prl0Ld2ZQb3lA4mT0b7dsv14LZ
dtGI8CeFsyJGoS0xPf1/bBIggzjI1tm/901ZU419RWXcMNrapLnAxfJsKI9Q
RllkZqdSb9XUwo+SsWgbtdGb2SDggO3OsA1v8ZzM2DpXxoQ3SRvYsCerlqJs
IKipJxwbV2f4PJ3mwcuK1bKUVTKaiHLFgTvpRDLNUk7d4R0psxPCA/JOhs1t
S3Jlvbw9TRLeaXUaMW1Wn7nSJeRZgpQbTlYDkHaTksx6sx3ixJsqLAWkJrFu
iWIKEwOUrwnOS6NmchUlaw5LJC2lbQUak05uC7W78QUZXsbPNptwhg6p702q
fzhbFl9RxyprW4N+fXt10td6hJismZrUfZSLtvawqq6ddteV/wMkvbSjYzxb
Tqtu6SY7kPPYQDpl0uR5aLNG50+wKYQFmA6Ir7m0uE3Wjb06sotMPNiKLc3U
lVQb9r1uI5urwjQ6JI43OTCNqDGIlnBO4mJUFR9ARH2vE+ReeIeCYyg2G1BL
jorNTMqGXBZZtaNA2nBrBxKmj5LMJpu1w2Zi3Nj1qCkKNief+kCF6BY809zE
1AmkZvehIlAjz7izoqGIWt2Q8Ek3xUZybtRKpg9OIzBU6FwDMiVoh4J3KpMc
zjrhUTFz8ra7TScgA47i0Y4eR6aFrNMltgFEQaoWdHLIabuvZODN2dqYE6en
rFTMAb/m0qXJ56HZHJwcF4ct/9+SHydi5o7l0RYEmsATTeB9k92rO4qG17uz
zsnVKx1s1jlVTERkpVcZbXrzkoLdAMgN7cDKlpiAKmkmY8wpSrZkxlqrnAS6
MNkTmHf03hhKjKR2Bocj9SoowLDMovdCh8N1tlyt1udkmjRXoPdwepSOUYkS
XtERQGHmaAJrsc7XaMbZFrkqblNKmb/ZSKC3VCai7fx4dgpCUFMOf2+AVfhG
VudX9oYOrPXx+YkbkXhqaH2dDKwNA6sWGgp9y/rb8U2Nw1FlIlQ2AOe667S3
mvoMmjZF0bZ+jOXzo0mP+0krPVKHjsnIY5USyTy3mQrzLDaphFUqQ2Xg1mcy
KOo51/t8uglXqVOvtf22VJpE61Q9p5pztdNIU6ZtDO38kOXe6obLjSqlgfrO
TGsVvaMRn86OhT8Mtat2FvvDoTfh4SvUGX6tN84YhAWD0EChKGtANky4RXLD
IW+2QTjgX6/kwPnREbfPped6fvi8W6UXPvsAx2V505kKcXYaF5In99H54IhO
lN/hsZljFw/elw94cPndG/6hHt5l6wIPOrS1tHjoOHALb597foDun20Tyjyh
gyXWEkC9wTB8op5JhqhA6/zkHOol0RabXajdY9OaqFAGSjXSnoP+8ehFhzKQ
OyY38MOH1gEM0lNm20mTFMm7myq3zYQgNYmVZKzUO16rVK3IQCp24C80d+GH
Za8aAtU8DTYrJOpUtCzdy2mWOVnFVuGljzrfgkfhk4+1MtaLjXXRlp6uOLyy
NA2PV1IJk1pp/xTLpj1jqVu1DV1KfiVTwdrFOuGhsvt4d9qKDqjaO1W0U0ps
4p7Oi3PAquy9CYXuotKCokj+WXle7UTdSsKTr8w6b8krdIwBaWJBRQOnWT0z
nftozyhtQ4/EGUv3GW0/l8kdJa468Bq0g/RGZ8xVwao3353T2r6ZXTQqXRPm
TrVhddLQnN9b3cWSZFYJTN1O0NGbffO5shuv7MOYAPtDfTikWl6xmVf0LTqU
5tJu2+m2QhQn2dWZqPI5ik51uGhrU5Y1mt2SIftjbu1RTjARKil1WE1vKsMV
gNy7UrwtBORAvR24PYgTPr/K3mG7ELKnN8GHjiSwdKLtzLzs53e8311Uxi9L
dBahBKpW3bvi8+uqL6iby6frMrqt0/vXi1cN9LQjhBZgBSelcbKIAVjVtAI/
cxud2CRue9kKJBgH1PqeulLXFNmKrbnC/DHCRMVTA2Aafyo2eTolB2nKNFBM
f14tp2kxJe9y+ljMxrS3uzxYGHm8MDmnDIbj1+cXx+KHry3f0tr6pg2WOBWv
j45tFpCZk02GAl0REJhFaROu/5vnWrlA/845G3pohBbFa5aHn0cYjVBjW2g2
+3LalEIHejmWspdUtqMkurbOo3iSbMQu2eiDjtV5yKdppIIKt/gNxLameOPP
dty76NY8rw6+chGWJv6Kz5fNdYtGfv2cq8Ogn/l5ZAJfulZDbvSAlKGWqPXB
z5ZK0JDpNT6i9c/eT6uMOzhL0VdvnUG5il+gxaClf7HkSfDbWugvPLnXm9Xc
IPQ3T8BzXQ9/TP9D90kEU9mPxHGYxU918+GvaP7x83DcwuietX7+Yp0fpD4H
Z3RvY2tAZ03eMrrvTV7Fg7aFFnq/igUWl2PBruiJ4aQLJWvTIcyOArpkOdOS
Ow2RgWUXtVSbXZzXlhM3P7o4vzhjl9FEPreNlMeEHUTnJZZjbZEnenaaPTeM
lAOv7/fHA7fvecFwMOl7ffwJ+95hdys1tRJfp7BoVrAzyXKGt64PVj/1ubJc
V9jD4J+BwyY6G/VMDxx/1iQX96JSByfJqP2+JrjWpyZe5+z09eX12dSejZPw
oEkylTYFd26y8Qh+W1krxZ8d3vQSFxTR6e1DknXHGwoJEHz+VJrWc8EBIp0e
bN2j/S1sTtZzg3KnwzPRR45qrOoIWqEaHde59TvxeqcZZq43Wy3vGsO0uWUq
BebeiElQsKt5SK8uqcMROsjxFBw0gTFQjdpp1Oay2WZeNop3OtDUpk8NN2xy
VE2zVHHxpdlme6T4rIr9tzwIVGmcK2mCR8OVwyya0szeg7Z9Kmbc6W6m1GPu
U9duXHMXfPcNpw3Pk+Xerq4bFm1hnFa7k2YmNc8zGS8f9Gk53RnldFLRG4oW
FLdo0Iq1U7/fnM9IdOl6x43oqvZSN5zYSM5uRWVoxYZgV4RlUkS33TrmaGZC
O3u9kmBnT0nyxm51QYwQjdPNjRiUvV/hQt4kkUhZER4UhxjwtcUdTLdk2TiO
oIv7tfq/oMzxMituxYIqMikRsnTFigbe8N0T4n/py2pofz4nd9ichqdNABIN
i01e1nkQFmZk9prRrEVcYTGNOfNO3hCYXp1fnF+fnRqSpeCIOcidpVWd15ev
zzRI9BUTW32eaMVFk6IEZ5U3x39Dwc9Cg7Fpkv5ZHFT3wQhKDOBYHMPx8gkW
tYLn1/No1cOvZlKO/lDfn+LUWhDt4VSKspoo/ScskabEs7FKylr5H8b+H8b+
78fYfGBrOw/7y8JgW7nYewJhzpvHAmHmzAUHT/kqgcoweTQm5vyrQ2IXtZm1
57OiA6e2sJIugPzpjgn7udZq84fY8kz03UFPmEN6VmhiJ8jCTAidfK8tWlH5
Y09KbSCn2krqtHsKWj1xjnxEO4u8o8YXBcCB0tfF8KHEG7KU6TgKyOTbZCVm
cJ+kxqtJjOf4MklZkhDk00S3GR3tBhLoKjy1FN8r+F2qLOmEXWzZ+s5cDUQZ
DObiCV0U8/ZtZjd12OwlH66RkW4i1nbzqukrUZ66XGU2msNXJPCZ8H61rmpJ
NrJfbG5uaM+euCEmyU/Hr4r3mThN/v6eg8yaQ5cZXYvnDhgBzWQfm6Fpn7WT
Bri6TT/iQY1gr7MalLnFhbbe12s6ePizljYU3OYQxVaUabOmi6Z0183ct7Qe
iHtd1jMwg5IlX9dZNnQe3T9Eni2tMdAcdNbsLOG7TPhkRc/1WxUoCtg+m6W7
tMkgTK6tUxzseNCaNTW3UudsF62UOZsv51SssZO9Vm/IrGgv2PRdH7BlctIa
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

-->

</rfc>

