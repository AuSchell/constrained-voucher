<?xml version="1.0" encoding="us-ascii"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.1.2 -->

<!DOCTYPE rfc SYSTEM "rfc2629.dtd" [
<!ENTITY RFC2119 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.2119.xml">
<!ENTITY RFC7049 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7049.xml">
<!ENTITY I-D.ietf-core-yang-cbor SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-yang-cbor.xml">
<!ENTITY I-D.ietf-core-sid SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-core-sid.xml">
<!ENTITY RFC7950 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7950.xml">
<!ENTITY RFC5652 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.5652.xml">
<!ENTITY RFC8152 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8152.xml">
<!ENTITY RFC8174 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8174.xml">
<!ENTITY RFC8366 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.8366.xml">
<!ENTITY RFC3688 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.3688.xml">
<!ENTITY RFC6020 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6020.xml">
<!ENTITY I-D.ietf-anima-bootstrapping-keyinfra SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-anima-bootstrapping-keyinfra.xml">
<!ENTITY I-D.ietf-ace-coap-est SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-ace-coap-est.xml">
<!ENTITY I-D.ietf-netmod-yang-tree-diagrams SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml3/reference.I-D.ietf-netmod-yang-tree-diagrams.xml">
<!ENTITY RFC6690 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.6690.xml">
<!ENTITY RFC7030 SYSTEM "https://xml2rfc.tools.ietf.org/public/rfc/bibxml/reference.RFC.7030.xml">
]>

<?rfc toc="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>

<rfc ipr="trust200902" docName="draft-ietf-anima-constrained-voucher-06" category="std">

  <front>
    <title abbrev="Constrained Voucher">Constrained Voucher Artifacts for Bootstrapping Protocols</title>

    <author initials="M." surname="Richardson" fullname="Michael Richardson">
      <organization>Sandelman Software Works</organization>
      <address>
        <email>mcr+ietf@sandelman.ca</email>
      </address>
    </author>
    <author initials="P." surname="van der Stok" fullname="Peter van der Stok">
      <organization>vanderstok consultancy</organization>
      <address>
        <email>consultancy@vanderstok.org</email>
      </address>
    </author>
    <author initials="P." surname="Kampanakis" fullname="Panos Kampanakis">
      <organization>Cisco Systems</organization>
      <address>
        <email>pkampana@cisco.com</email>
      </address>
    </author>

    <date year="2019" month="December" day="02"/>

    <area>Internet</area>
    <workgroup>anima Working Group</workgroup>
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document defines a strategy to securely assign a pledge to an
owner, using an artifact signed, directly or indirectly, by the
pledge's manufacturer.  This artifact is known as a "voucher".</t>

<t>This document builds upon the work in <xref target="RFC8366"/>, encoding
the resulting artifact in CBOR.  Use with two signature technologies are
described.</t>

<t>Additionally, this document explains how constrained vouchers may be
transported as an extension to the <xref target="I-D.ietf-ace-coap-est"/> protocol.</t>



    </abstract>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>Enrollment of new nodes into constrained networks with constrained nodes
present unique challenges.</t>

<t>There are bandwidth and code space issues to contend.  A solution such as
<xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> may be too large in terms of
code space or bandwidth required.</t>

<t>This document defines a constrained version of <xref target="RFC8366"/>.
Rather than serializing the YANG definition in JSON, it is serialized into
CBOR (<xref target="RFC7049"/>).</t>

<t>This document follows a similar, but not identical structure as
<xref target="RFC8366"/>. Some sections are left out entirely.
Additional sections have been added concerning:</t>

<t><list style="numbers">
  <t>Addition of voucher-request specification as defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>,</t>
  <t>Addition to <xref target="I-D.ietf-ace-coap-est"/> of voucher transport requests over CoAP.</t>
</list></t>

<t>The CBOR definitions for this constrained voucher format are defined using
the mechanism describe in <xref target="I-D.ietf-core-yang-cbor"/> using the SID
mechanism explained in <xref target="I-D.ietf-core-sid"/>.  As the tooling to convert
YANG documents into an list of SID keys is still in its infancy, the table of
SID values presented here should be considered normative rather than the
output of the pyang tool.</t>

<t>Two methods of signing the resulting CBOR object are described in this
document:</t>

<t><list style="numbers">
  <t>One is CMS <xref target="RFC5652"/>.</t>
  <t>The other is COSE_Sign1 <xref target="RFC8152"/> objects.</t>
</list></t>

</section>
<section anchor="Terminology" title="Terminology">

<t>The following terms are defined in <xref target="RFC8366"/>, and are used
identically as in that document: artifact, imprint, domain, Join
Registrar/Coordinator (JRC), Manufacturer Authorized Signing Authority
(MASA), pledge, Trust of First Use (TOFU), and Voucher.</t>

</section>
<section anchor="reqlang" title="Requirements Language">

<t>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL 
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", 
"MAY", and "OPTIONAL" in this document are to be interpreted as 
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they 
appear in all capitals, as shown here.</t>

</section>
<section anchor="survey-of-voucher-types" title="Survey of Voucher Types">

<t><xref target="RFC8366"/> provides for vouchers that assert proximity, that
authenticate the registrar and that include different amounts of anti-replay
protection.</t>

<t>This document does not make any extensions to the types of vouchers.</t>

<t>Time based vouchers are included in this definition, but given that
constrained devices are extremely unlikely to have accurate time, their
use is very unlikely.  Most users of these constrained vouchers will be
online and will use live nonces to provide anti-replay protection.</t>

<t><xref target="RFC8366"/> defined only the voucher artifact, and not the
Voucher Request artifact, which was defined in <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<t>This document defines both a constrained voucher and a constrained voucher-request.
They are presented in the order voucher-request, followed by a voucher response
as this is the time order that they occur.</t>

<t>This document defines both CMS-signed voucher requests and responses, and
COSE signed voucher requests and responses.
The use of CMS signatures implies the use of PKIX format certificates.
The pinned-domain-cert present in such a voucher, is the certificate of the Registrar.</t>

<t>The constrained voucher and constrained voucher request MUST be signed.</t>

<t>The use of the two signing formats permit the use of both PKIX format certificates,
and raw public keys (RPK).  When RPKs are used, the voucher produced by
the MASA pins the raw public key of the Registrar: the
pinned-domain-subject-public-key-info in such a voucher, is the raw public
key of the Registrar.
This is described in the YANG definition for the constrained voucher.</t>

</section>
<section anchor="discovery-and-uri" title="Discovery and URI">

<t>This section describes the BRSKI extensions to EST-coaps
<xref target="I-D.ietf-ace-coap-est"/> to transport the voucher between registrar,
proxy and pledge over CoAP. The extensions are targeted to low-resource
networks with small packets. Saving header space is important and the
EST-coaps URI is shorter than the EST URI.</t>

<t>The presence and location of (path to) the management data are discovered by
sending a GET request to "/.well-known/core" including a resource type (RT)
parameter with the value "ace.est" <xref target="RFC6690"/>. Upon success, the return
payload will contain the root resource of the EST resources. It is up to the
implementation to choose its root resource; throughout this document the
example root resource /est is used.</t>

<t>The EST-coaps server URIs differ from the EST URI by replacing the scheme
https by coaps and by specifying shorter resource path names:</t>

<figure><artwork><![CDATA[
  coaps://www.example.com/est/short-name
]]></artwork></figure>

<t>Figure 5 in section 3.2.2 of <xref target="RFC7030"/> enumerates the operations and
corresponding paths which are supported by EST. <xref target="est-uri"/> provides the
mapping from the BRSKI extension URI path to the EST-coaps URI path.</t>

<texttable title="BRSKI path to EST-coaps path" anchor="est-uri">
      <ttcol align='left'>BRSKI</ttcol>
      <ttcol align='left'>EST-coaps</ttcol>
      <c>/requestvoucher</c>
      <c>/rv</c>
      <c>/voucher_status</c>
      <c>/vs</c>
      <c>/enrollstatus</c>
      <c>/es</c>
      <c>/requestauditlog</c>
      <c>/ra</c>
</texttable>

<t>/requestvoucher, /voucher_status and /enrollstatus are needed between 
pledge and Registrar.</t>

<t>When discovering the root path for the EST resources, the server MAY return
the full resource paths and the used content types. This is useful when
multiple content types are specified for EST-coaps server. For example, the
following more complete response is possible.</t>

<figure><artwork><![CDATA[
  REQ: GET /.well-known/core?rt=ace.est*

  RES: 2.05 Content
  </est>; rt="ace.est"
  </est/rv>; rt="ace.est/rv";ct=TBD2 TBD3
  </est/vs>; rt="ace.est/vs";ct=50 60
  </est/es>; rt="ace.est/es";ct=50 60
  </est/ra>; rt="ace.est/ra";ct=TBD2 TBD3
]]></artwork></figure>

<t>The return of the content-types allows the client to choose the most appropriate one from multiple content types.</t>

<t>ct=TBD2 stands for Content-Format "application/voucher-cms+cbor,
and ct=TBD3 stands for Content-Format "application/voucher-cose+cbor".</t>

<t>Content-Formats TBD2 and TBD3 are defined in this document.</t>

<t>The Content-Format ("application/json") 50 MAY be supported.
Content-Formats ("application/cbor") 60, TBD2, and TBD3 MUST be supported.</t>

</section>
<section anchor="artifacts" title="Artifacts">

<t>This section describes the abstract (tree) definition as explained
in <xref target="I-D.ietf-netmod-yang-tree-diagrams"/> first.  This provides a high-level
view of the contents of each artifact.</t>

<t>Then the assigned SID values are presented. These have been assigned using
the rules in <xref target="I-D.ietf-core-sid"/>, with an allocation that was made
via the http://comi.space service.</t>

<section anchor="voucher-request-artifact" title="Voucher Request artifact">

<section anchor="tree-diagram" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with the addition of proximity-registrar-subject-public-key-info,
proximity-registrar-cert, and prior-signed-voucher-request.</t>

<t>prior-signed-voucher-request is only used between the Registrar and the MASA.
proximity-registrar-subject-public-key-info replaces proximity-registrar-cert
for the extremely constrained cases.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher-request

  grouping voucher-request-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion
       |       enumeration
       +-- serial-number
       |       string
       +-- idevid-issuer?
       |       binary
       +-- pinned-domain-cert?
       |       binary
       +-- domain-cert-revocation-checks?
       |       boolean
       +-- nonce?
       |       binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- proximity-registrar-subject-public-key-info?
       |       binary
       +-- proximity-registrar-sha256-of-subject-public-key-info?
       |       binary
       +-- proximity-registrar-cert?
       |       binary
       +-- prior-signed-voucher-request?
               binary
]]></artwork></figure>

</section>
<section anchor="sid-values" title="SID values">

<figure><artwork><![CDATA[
 SID  Assigned to: 
----- ------------------------------------------------------------------
 2500 ietf-constrained-voucher-request
 2501 /ietf-constrained-voucher-request:voucher
 2502 /ietf-constrained-voucher-request:voucher/assertion
 2503 /ietf-constrained-voucher-request:voucher/created-on
 2504 /ietf-constrained-voucher-request:voucher
                                        /domain-cert-revocation-checks
 2505 /ietf-constrained-voucher-request:voucher/expires-on
 2506 /ietf-constrained-voucher-request:voucher/idevid-issuer
 2507 /ietf-constrained-voucher-request:voucher/last-renewal-date
 2508 /ietf-constrained-voucher-request:voucher/nonce
 2509 /ietf-constrained-voucher-request:voucher/pinned-domain-cert
 2510 /ietf-constrained-voucher-request:voucher
                                          /prior-signed-voucher-request
 2511 /ietf-constrained-voucher-request:voucher/proximity-registrar-cert
 2512 /ietf-constrained-voucher-request:voucher
                 /proximity-registrar-sha256-of-subject-public-key-info
 2513 /ietf-constrained-voucher-request:voucher
                           /proximity-registrar-subject-public-key-info
 2514 /ietf-constrained-voucher-request:voucher/serial-number 

]]></artwork></figure>

</section>
<section anchor="yang-module" title="YANG Module">

<t>In the constrained-voucher-request YANG module, the voucher is "augmented" within the "used" grouping statement such that one continuous set of SID values is generated for the constrained-voucher-request module name, all voucher attributes, and the constrained-voucher-request attribute. Two attributes of the voucher are "refined" to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher-request@2019-08-01.yang"
module ietf-constrained-voucher-request {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
  description
   "This module defines the format for a voucher request,
    which is produced by a pledge to request a voucher.
    The voucher-request is sent to the potential owner's
    Registrar, which in turn sends the voucher request to
    the manufacturer or delegate (MASA).

    A voucher is then returned to the pledge, binding the
    pledge to the owner.  This is a constrained version of the
    voucher-request present in
    draft-ietf-anima-bootstrap-keyinfra.txt.

    This version provides a very restricted subset appropriate
    for very constrained devices.
    In particular, it assumes that nonce-ful operation is
    always required, that expiration dates are rather weak, as no
    clocks can be assumed, and that the Registrar is identified
    by a pinned Raw Public Key.

    The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
    'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
    and 'OPTIONAL' in the module text are to be interpreted as
    described in RFC 2119.";

  revision "2019-08-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-request-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-request-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-request-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }


      augment "voucher" {
        description "Base the constrained voucher-request upon the
          regular one";

        leaf proximity-registrar-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-subject-public-key-info replaces
 	     the proximit-registrar-cert in constrained uses of
             the voucher-request.
             The proximity-registrar-subject-public-key-info is the
             Raw Public Key of the Registrar. This field is encoded
             as specified in RFC7250, section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is MAY, but due to 
             size is discouraged.";
        }

        leaf proximity-registrar-sha256-of-subject-public-key-info {
          type binary;
          description
            "The proximity-registrar-sha256-of-subject-public-key-info
             is an alternative to 
             proximity-registrar-subject-public-key-info.
             and pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement protocol, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash
             types.";
        }

        leaf proximity-registrar-cert {
          type binary;
          description
            "An X.509 v3 certificate structure as specified by
             RFC 5280,
             Section 4 encoded using the ASN.1 distinguished encoding
             rules (DER), as specified in ITU-T X.690.

             The first certificate in the Registrar TLS server
             certificate_list sequence  (see [RFC5246]) presented by
             the Registrar to the Pledge. This MUST be populated in a
             Pledge's voucher request if the proximity assertion is
             populated.";
        }

        leaf prior-signed-voucher-request {
          type binary;
          description
            "If it is necessary to change a voucher, or re-sign and
             forward a voucher that was previously provided along a
             protocol path, then the previously signed voucher
             SHOULD be included in this field.

             For example, a pledge might sign a proximity voucher,
             which an intermediate registrar then re-signs to
             make its own proximity assertion.  This is a simple
             mechanism for a chain of trusted parties to change a
             voucher, while maintaining the prior signature
             information.

             The pledge MUST ignore all prior voucher information
             when accepting a voucher for imprinting. Other
             parties MAY examine the prior signed voucher
             information for the purposes of policy decisions.
             For example this information could be useful to a
             MASA to determine that both pledge and registrar
             agree on proximity assertions. The MASA SHOULD
             remove all prior-signed-voucher-request information when
             signing a voucher for imprinting so as to minimize the
             final voucher size.";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example2" title="Example voucher request artifact">

<t>Below is a CBOR serialization of the constrained-voucher-request is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  2501: {
    +2 : "2016-10-07T19:31:42Z", / SID= 2503, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID= 2505, expires-on /
    +1 : 2,                      / SID= 2502, assertion /
                                 /                "proximity" /
    +13: "JADA123456789",        / SID= 2514, serial-number /
    +5 : h'01020D0F',            / SID= 2506, idevid-issuer /
    +10: h'01020D0F',            / SID=2511, proximity-registrar-cert/
    +3 : true,                   / SID= 2504, domain-cert
                                                  -revocation-checks/
    +6 : "2017-10-07T19:31:42Z", / SID= 2507, last-renewal-date /
    +12: h'01020D0F'             / SID= 2513, proximity-registrar
                                         -subject-public-key-info /
  }
}



]]></artwork></figure>

</section>
</section>
<section anchor="voucher-artifact" title="Voucher artifact">

<t>The voucher's primary purpose is to securely assign a pledge to an
owner.  The voucher informs the pledge which entity it should
consider to be its owner.</t>

<t>This document defines a voucher that is a CBOR encoded instance of
the YANG module defined in Section 5.3 that has been signed with CMS
or with COSE.</t>

<section anchor="tree-diagram-1" title="Tree Diagram">

<t>The following diagram is largely a duplicate of the contents of <xref target="RFC8366"/>,
with only the addition of pinned-domain-subject-public-key-info.</t>

<figure><artwork><![CDATA[
module: ietf-constrained-voucher

  grouping voucher-constrained-grouping
    +-- voucher
       +-- created-on?
       |       yang:date-and-time
       +-- expires-on?
       |       yang:date-and-time
       +-- assertion                                   enumeration
       +-- serial-number                               string
       +-- idevid-issuer?                              binary
       +-- pinned-domain-cert?                         binary
       +-- domain-cert-revocation-checks?              boolean
       +-- nonce?                                      binary
       +-- last-renewal-date?
       |       yang:date-and-time
       +-- pinned-domain-subject-public-key-info?      binary
       +-- pinned-sha256-of-subject-public-key-info?   binary
]]></artwork></figure>

</section>
<section anchor="sid-values-1" title="SID values">

<figure><artwork><![CDATA[
 SID   Assigned to:
----- ------------------------------------------------------------------
 2450 ietf-constrained-voucher 
 2451 /ietf-constrained-voucher:voucher 
 2452 /ietf-constrained-voucher:voucher/assertion
 2453 /ietf-constrained-voucher:voucher/created-on 
 2454 /ietf-constrained-voucher:voucher/domain-cert-revocation-checks 
 2455 /ietf-constrained-voucher:voucher/expires-on
 2456 /ietf-constrained-voucher:voucher/idevid-issuer
 2457 /ietf-constrained-voucher:voucher/last-renewal-date
 2458 /ietf-constrained-voucher:voucher/nonce
 2459 /ietf-constrained-voucher:voucher/pinned-domain-cert
 2460 /ietf-constrained-voucher:voucher
                            /pinned-domain-subject-public-key-info 
 2461 /ietf-constrained-voucher:voucher
                            /pinned-sha256-of-subject-public-key-info
 2462 /ietf-constrained-voucher:voucher/serial-number 

]]></artwork></figure>

</section>
<section anchor="yang-module-1" title="YANG Module">

<t>In the constrained-voucher YANG module, the voucher is "augmented" within the "used" grouping statement such that one continuous set of SID values is generated for the constrained-voucher module name, all voucher attributes, and the constrained-voucher attribute. Two attributes of the voucher are "refined" to be optional.</t>

<figure><artwork><![CDATA[
<CODE BEGINS> file "ietf-constrained-voucher@2019-08-01.yang"
module ietf-constrained-voucher {
  yang-version 1.1;

  namespace
    "urn:ietf:params:xml:ns:yang:ietf-constrained-voucher";
  prefix "constrained";

  import ietf-restconf {
    prefix rc;
    description
      "This import statement is only present to access
       the yang-data extension defined in RFC 8040.";
    reference "RFC 8040: RESTCONF Protocol";
  }

  import ietf-voucher {
    prefix "v";
  }

  organization
   "IETF ANIMA Working Group";

  contact
   "WG Web:   <http://tools.ietf.org/wg/anima/>
    WG List:  <mailto:anima@ietf.org>
    Author:   Michael Richardson
              <mailto:mcr+ietf@sandelman.ca>
    Author:   Peter van der Stok
              <mailto: consultancy@vanderstok.org>
    Author:   Panos Kampanakis
              <mailto: pkampana@cisco.com>";
description
  "This module defines the format for a voucher, which is produced
   by a pledge's manufacturer or delegate (MASA) to securely assign
   one or more pledges to an 'owner', so that the pledges may
   establis a secure connection to the owner's network
   infrastructure.

   This version provides a very restricted subset appropriate
   for very constrained devices.
   In particular, it assumes that nonce-ful operation is
   always required, that expiration dates are rather weak, as no
   clocks can be assumed, and that the Registrar is identified
   by a pinned Raw Public Key.

   The key words 'MUST', 'MUST NOT', 'REQUIRED', 'SHALL',
   'SHALL NOT', 'SHOULD', 'SHOULD NOT', 'RECOMMENDED', 'MAY',
   and 'OPTIONAL' in the module text are to be interpreted as
   described in RFC 2119.";

  revision "2019-08-01" {
    description
     "Initial version";
    reference
     "RFC XXXX: Voucher Profile for Constrained Devices";
  }

  rc:yang-data voucher-constrained-artifact {
    // YANG data template for a voucher.
    uses voucher-constrained-grouping;
  }

  // Grouping defined for future usage
  grouping voucher-constrained-grouping {
    description
      "Grouping to allow reuse/extensions in future work.";

    uses v:voucher-artifact-grouping {

      refine voucher/created-on {
          mandatory  false;
      }

      refine voucher/pinned-domain-cert {
          mandatory  false;
      }

      augment "voucher" {
        description "Base the constrained voucher
                                   upon the regular one";
        leaf pinned-domain-subject-public-key-info {
          type binary;
          description
            "The pinned-domain-subject-public-key-info replaces the
             pinned-domain-cert in constrained uses of
             the voucher. The pinned-domain-subject-public-key-info
             is the Raw Public Key of the Registrar.
             This field is encoded as specified in RFC7250,
             section 3.
             The ECDSA algorithm MUST be supported.
             The EdDSA algorithm as specified in
             draft-ietf-tls-rfc4492bis-17 SHOULD be supported.
             Support for the DSA algorithm is not recommended.
             Support for the RSA algorithm is a MAY.";
        }

        leaf pinned-sha256-of-subject-public-key-info {
          type binary;
          description
            "The pinned-hash-subject-public-key-info is a second
             alternative to pinned-domain-cert.  In many cases the
             public key of the domain has already been transmitted
             during the key agreement process, and it is wasteful
             to transmit the public key another two times.
             The use of a hash of public key info, at 32-bytes for
             sha256 is a significant savings compared to an RSA
             public key, but is only a minor savings compared to
             a 256-bit ECDSA public-key.
             Algorithm agility is provided by extensions to this
             specifications which define new leaf for other hash types";
        }
      }
    }
  }
}
<CODE ENDS>
]]></artwork></figure>

</section>
<section anchor="example1" title="Example voucher artifacts">

<t>Below a the CBOR serialization of the constrained-voucher is shown in diagnostic CBOR notation. The enum value of the assertion field is calculated to be zero by following the algorithm described in section 9.6.4.2 of <xref target="RFC7950"/>.</t>

<figure><artwork><![CDATA[
{
  2451: {
    +2 : "2016-10-07T19:31:42Z", / SID = 2453, created-on /
    +4 : "2016-10-21T19:31:42Z", / SID = 2455, expires-on /
    +1 : 0,                      / SID = 2452, assertion /
                                 /                "verified" /
    +11: "JADA123456789",        / SID = 2462, serial-number /
    +5 : h'01020D0F',            / SID = 2456, idevid-issuer /
    +8 : h'01020D0F',            / SID = 2459, pinned-domain-cert/
    +3 : true,                   / SID = 2454, domain-cert
                                                 -revocation-checks /
    +6 : "2017-10-07T19:31:42Z", / SID = 2457, last-renewal-date /
    +9 : h'01020D0F'             / SID = 2460, pinned-domain
                                           -subject-public-key-info /
  }
}



]]></artwork></figure>

<t>The signing of the example is shown in <xref target="cmssign"/>.</t>

</section>
</section>
<section anchor="signing-voucher-and-voucher-request-artifacts" title="Signing voucher and voucher-request artifacts">

<section anchor="cms-signing" title="CMS signing">

<t>The IETF evolution of PKCS#7 is CMS <xref target="RFC5652"/>.  The CMS signed voucher is
much like the equivalent voucher defined in <xref target="RFC8366"/>.</t>

<t>A different eContentType of TBD1 is used to indicate that the contents are
in a different format than in <xref target="RFC8366"/>.</t>

<t>The ContentInfo structure contains a payload consisting of the CBOR encoded
voucher. The <xref target="I-D.ietf-core-yang-cbor"/> use of delta encoding creates a
canonical ordering for the keys on the wire.  This canonical ordering is not
important as there is no expectation that the content will be reproduced
during the validation process.</t>

<t>Normally the recipient is the pledge and the signer is the MASA.</t>

<t><xref target="I-D.ietf-anima-bootstrapping-keyinfra"/> supports both signed and unsigned
voucher requests from the pledge to the JRC.
In this specification, voucher-request artifact MUST be signed from the
pledge to the registrar.  From the JRC to the MASA, the voucher-request
artifact MUST be signed by the domain owner key which is requesting
ownership.</t>

<t>The considerations of <xref target="RFC5652"/> section 5.1, concerning validating
CMS objects which are really PKCS7 objects (cmsVersion=1) applies.</t>

<t>The CMS structure SHOULD also contain all the certificates leading up
to and including the signer's trust anchor certificate known to the
recipient.  The inclusion of the trust anchor is unusual in many
applications, but without it third parties can not accurately audit
the transaction.</t>

<t>The CMS structure MAY also contain revocation objects for any
intermediate certificate authorities (CAs) between the voucher-issuer
and the trust anchor known to the recipient.  However, the use of
CRLs and other validity mechanisms is discouraged, as the pledge is
unlikely to be able to perform online checks, and is unlikely to have
a trusted clock source.  As described below, the use of short-lived
vouchers and/or pledge provided nonce provides a freshness guarantee.</t>

<figure><artwork><![CDATA[
[EDnote: compulsory signing algorithms are ......]
]]></artwork></figure>

<t>In <xref target="cmssign"/> an example for the CMS signing of the voucher-request is shown.</t>

</section>
<section anchor="cose-signing" title="COSE signing">

<t>The COSE-Sign1 structure is discussed in section 4.2 of <xref target="RFC8152"></xref>. The CBOR
object that carries the body, the signature, and the
information about the body and signature is called the COSE_Sign1
structure. It is used when only one signature is used on the body.
Support for EdDSA with Ed25519 is compulsory.</t>

<t>The supported COSE-sign1 object stucture is shown in <xref target="fig-cose"/>.</t>

<figure title="cose-sign1 example" align="left" anchor="fig-cose"><artwork><![CDATA[
COSE_Sign1(
  [
    h'a10127',    #{ "alg": EDdsa }
    {
      "kid" : "AsymmetricEd25519"
    },
    h'123', #voucher-request binary content
    h'456', #voucher-request binary public signature
  ]
)
]]></artwork></figure>

<t>The <xref target="COSE-registry"/> specifies the integers that replace the strings and the mnemonics in <xref target="fig-cose"/>. The value of the "kid" parameter is an example value. Usually a hash of the public key is used to idientify the public key. The distribution of the public key and its hash is done out of band.</t>

<t>In <xref target="cosesign"/> a binary cose-sign1 object is shown based on the voucher-request example of <xref target="example2"/>.</t>

</section>
</section>
</section>
<section anchor="design-considerations" title="Design Considerations">

<t>The design considerations for the CBOR encoding of vouchers is much the same
as for <xref target="RFC8366"/>.</t>

<t>One key difference is that the names of the leaves in the YANG does not have a
material effect on the size of the resulting CBOR, as the SID translation
process assigns integers to the names.</t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<section anchor="clock-sensitivity" title="Clock Sensitivity">

<t>TBD.</t>

</section>
<section anchor="protect-voucher-pki-in-hsm" title="Protect Voucher PKI in HSM">

<t>TBD.</t>

</section>
<section anchor="test-domain-certificate-validity-when-signing" title="Test Domain Certificate Validity when Signing">

<t>TBD.</t>

</section>
</section>
<section anchor="iana-considerations" title="IANA Considerations">

<section anchor="resource-type-registry" title="Resource Type Registry">

<t>Additions to the sub-registry "CoAP Resource Type", within the "CoRE parameters" registry are specified below. These can be registered  either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
 ace.rt.rv needs registration with IANA
 ace.rt.vs needs registration with IANA
 ace.rt.es needs registration with IANA
 ace.rt.ra needs registration with IANA
]]></artwork></figure>

</section>
<section anchor="the-ietf-xml-registry" title="The IETF XML Registry">

<t>This document registers two URIs in the IETF XML registry <xref target="RFC3688"/>.
Following the format in <xref target="RFC3688"/>, the following registration is
requested:</t>

<figure><artwork><![CDATA[
  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.

  URI: urn:ietf:params:xml:ns:yang:ietf-constrained-voucher-request
  Registrant Contact: The ANIMA WG of the IETF.
  XML: N/A, the requested URI is an XML namespace.
]]></artwork></figure>

</section>
<section anchor="the-yang-module-names-registry" title="The YANG Module Names Registry">

<t>This document registers two YANG modules in the YANG Module Names
registry <xref target="RFC6020"/>.  Following the format defined in <xref target="RFC6020"/>, the
the following registration is requested:</t>

<figure><artwork><![CDATA[
  name:         ietf-constrained-voucher
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained-voucher
  prefix:       vch
  reference:    RFC XXXX

  name:         ietf-constrained-voucher-request
  namespace:    urn:ietf:params:xml:ns:yang:ietf-constrained
                                           -voucher-request
  prefix:       vch
  reference:    RFC XXXX
]]></artwork></figure>

</section>
<section anchor="the-rfc-sid-range-assignment-sub-registry" title="The RFC SID range assignment sub-registry">

<figure><artwork><![CDATA[
------------ ------ --------------------------- ------------
Entry-point | Size | Module name               | RFC Number
------------ ------ --------------------------- ------------
2450          50     ietf-constrained-voucher    [ThisRFC]
2500          50     ietf-constrained-voucher    [ThisRFC}
                                 -request
----------- ------  --------------------------- ------------
]]></artwork></figure>

<t>Warning: These SID values are defined in <xref target="I-D.ietf-core-sid"/>.</t>

</section>
<section anchor="the-smi-security-for-smime-cms-content-type-registry" title="The SMI Security for S/MIME CMS Content Type Registry">

<t>This document registers an OID in the "SMI Security for S/MIME CMS
Content Type" registry (1.2.840.113549.1.9.16.1), with the value:</t>

<figure><artwork><![CDATA[
  Decimal  Description                             References
  -------  --------------------------------------  ----------
  TBD1      id-ct-animaCBORVoucher                 [ThisRFC]
]]></artwork></figure>

<t>EDNOTE: should a separate value be used for Voucher Requests?</t>

</section>
<section anchor="media-type-registry" title="Media-Type Registry">

<t>This section registers the 'application/voucher-cms+cbor' media type and the 'application/voucher-cose+cbor' in the
"Media Types" registry.  These media types are used to indicate that
the content is a CBOR voucher either signed with a cms structure or a COSE_Sign1 structure <xref target="RFC8152"></xref>.</t>

<section anchor="applicationvoucher-cmscbor" title="application/voucher-cms+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cms+cbor
Required parameters:  none
Optional parameters:  none
Encoding considerations:  CMS-signed CBOR vouchers are CBOR
  encoded.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
<section anchor="applicationvoucher-cosecbor" title="application/voucher-cose+cbor">

<figure><artwork><![CDATA[
Type name:  application
Subtype name:  voucher-cose+cbor
Required parameters:  none
Optional parameters:  cose-type
Encoding considerations:  COSE_Sign1 CBOR vouchers are COSE objects
                          signed with one signer.
Security considerations:  See Security Considerations, Section
Interoperability considerations:  The format is designed to be
  broadly interoperable.
Published specification:  THIS RFC.
Applications that use this media type:  ANIMA, 6tisch, and other
  zero-touch imprinting systems
Additional information:
  Magic number(s):  None
  File extension(s):  .vch
  Macintosh file type code(s):  none
Person & email address to contact for further information:  IETF
  ANIMA WG
Intended usage:  LIMITED
Restrictions on usage:  NONE
Author:  ANIMA WG
Change controller:  IETF
Provisional registration? (standards tree only):  NO
]]></artwork></figure>

</section>
</section>
<section anchor="coap-content-format-registry" title="CoAP Content-Format Registry">

<t>Additions to the sub-registry "CoAP Content-Formats", within the "CoRE
Parameters" registry are needed for two media types. These can be registered
either in the Expert Review range (0-255) or IETF Review range (256-9999).</t>

<figure><artwork><![CDATA[
Media type                    mime type    Encoding   ID  References
----------------------------  -----------  --------- ---- ----------
application/voucher-cms+cbor      - -        CBOR    TBD2  [This RFC]
application/voucher-cose+cbor "COSE-Sign1"   CBOR    TBD3  [This RFC]
]]></artwork></figure>

</section>
</section>
<section anchor="acknowledgements" title="Acknowledgements">

<t>We are very grateful to Jim Schaad for explaining COSE and CMS choices. Also thanks to Jim Schaad for correctinging earlier version of the COSE Sign1 objects.</t>

<t>Michel Veillette did extensive work on pyang to extend it to support the
SID allocation process, and this document was among the first users.</t>

<t>We are grateful for the suggestions done by Esko Dijk.</t>

</section>
<section anchor="changelog" title="Changelog">

<t>-06 
    New SID values assigned; regenerated examples</t>

<t>-04
    voucher and request-voucher MUST be signed
    examples for signed request are added in appendix
    IANA SID registration is updated
    SID values in examples are aligned
    signed cms examples aligned with new SIDs</t>

<t>-03</t>

<figure><artwork><![CDATA[
Examples are inverted.
]]></artwork></figure>

<t>-02</t>

<figure><artwork><![CDATA[
Example of requestvoucher with unsigned appllication/cbor is added
attributes of voucher "refined" to optional
CBOR serialization of vouchers improved
Discovery port numbers are specified
]]></artwork></figure>

<t>-01</t>

<figure><artwork><![CDATA[
application/json is optional, application/cbor is compulsory
Cms and cose mediatypes are introduced
]]></artwork></figure>

</section>


  </middle>

  <back>

    <references title='Normative References'>

&RFC2119;
&RFC7049;
&I-D.ietf-core-yang-cbor;
&I-D.ietf-core-sid;
&RFC7950;
&RFC5652;
&RFC8152;
&RFC8174;
&RFC8366;
&RFC3688;
&RFC6020;
&I-D.ietf-anima-bootstrapping-keyinfra;
&I-D.ietf-ace-coap-est;


    </references>

    <references title='Informative References'>

&I-D.ietf-netmod-yang-tree-diagrams;
<reference anchor="COSE-registry" target="https://www.iana.org/assignments/cose/cose.xhtml">
  <front>
    <title>CBOR Object Signing and Encryption (COSE) registry</title>
    <author initials="." surname="IANA">
      <organization></organization>
    </author>
    <date year="2017"/>
  </front>
</reference>
&RFC6690;
&RFC7030;


    </references>


<section anchor="est-messages-to-est-coaps" title="EST messages to EST-coaps">

<t>This section extends the examples from Appendix A of <xref target="I-D.ietf-ace-coap-est"/>. The CoAP headers are only worked out for the enrollstatus example.</t>

<section anchor="es" title="enrollstatus">

<t>A coaps enrollstatus message can be :</t>

<figure><artwork><![CDATA[
    GET coaps://[192.0.2.1:8085]/est/es
]]></artwork></figure>

<t>The corresponding coap header fields are shown below.</t>

<figure><artwork><![CDATA[
  Ver = 1
  T = 0 (CON)
  Code = 0x01 (0.01 is GET)
  Options
   Option  (Uri-Path)
     Option Delta = 0xb   (option nr = 11)
     Option Length = 0x3
     Option Value = "est"
   Option  (Uri-Path)
     Option Delta = 0x0   (option nr = 11)
     Option Length = 0x2
     Option Value = "es"
  Payload = [Empty]
]]></artwork></figure>

<t>The Uri-Host and Uri-Port Options are omitted because they coincide with the transport protocol destination address and port respectively.</t>

<t>A 2.05 Content response with an unsigned voucher status (ct=60) will then be:</t>

<figure><artwork><![CDATA[
   2.05 Content (Content-Format: application/cbor)
]]></artwork></figure>

<t>With CoAP fields and payload:</t>

<figure><artwork><![CDATA[
   Ver=1
   T=2 (ACK)
   Code = 0x45 (2.05 Content)
   Options
     Option1 (Content-Format)
     Option Delta = 0xC  (option nr 12)
     Option Length = 0x2
     Option Value = 60 (application/cbor)

     Payload (CBOR diagnostic) =
     {
     "version":"1",
     "Status": 1,   / 1 = Success, 0 = Fail  /
     "Reason":"Informative human readable message",
     "reason-context": "Additional information"
     }
]]></artwork></figure>

<t>The binary payload is:</t>

<figure><artwork><![CDATA[
     A46776657273696F6E6131665374617475730166526561736F6E7822
     496E666F726D61746976652068756D616E207265616461626C65206D
     6573736167656e726561736F6E2D636F6E74657874
     764164646974696F6E616C20696E666F726D6174696F6E
]]></artwork></figure>

<t>The binary payload disassembles to the above CBOR diagnostic code.</t>

</section>
<section anchor="voucherstatus" title="voucher_status">

<t>A coaps voucher_status message can be:</t>

<figure><artwork><![CDATA[
   GET coaps://[2001:db8::2:1]:61616]/est/vs
]]></artwork></figure>

<t>A 2.05 Content response with a non signed CBOR voucher status (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
    A46776657273696F6E6131665374617475730166526561736F6E7822
    496E666F726D61746976652068756D616E207265616461626C65206D
    6573736167656e726561736F6E2D636F6E74657874
    764164646974696F6E616C20696E666F726D6174696F6E
]]></artwork></figure>

</section>
<section anchor="requestvoucher" title="requestvoucher">

<t>Signed request-voucher-request payloads are sent from pledge to Registrar, as explained in Section 5.2 of <xref target="I-D.ietf-anima-bootstrapping-keyinfra"/>.</t>

<section anchor="rv" title="signed requestvoucher">

<t>A CMS signed requestvoucher message from JRC to MASA is shown below.
It would be CoAP POSTED to /est/rv.</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/rv
    (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>

<t>The payload would be in binary, but is presented in base64 in this document.</t>

<figure><artwork><![CDATA[
MIIDugYJKoZIhvcNAQcCoIIDqzCCA6cCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggE/MIIBOwIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODEwNDgzNlowLwYJKoZIhvcNAQkEMSIEILEdCTOLs2Zy7w3LgvSZ
XZEadz3LbznoFBs6FMFN91RaMAoGCCqGSM49BAMCBEcwRQIgASjDsIpr0tW/
n6dRHqvvqsqgZlHbtFnErUbWfhS0KD4CIQDDUEqc5wTmRGf0adEQVQzqmIgh
MEgF10vqXv02gL1jLw==
]]></artwork></figure>

<t>A 2.04 Changed response returning CBOR voucher signed with a cms structure(ct=TBD2) will then be:</t>

<figure><artwork><![CDATA[
    2.04 Changed (Content-Format: application/voucher-cms+cbor)
]]></artwork></figure>
<figure><artwork><![CDATA[
MIIDuwYJKoZIhvcNAQcCoIIDrDCCA6gCAQExDTALBglghkgBZQMEAgEwCwYJ
KoZIhvcNAQcBoIICQTCCAj0wggHioAMCAQICCH52Yde1TkYyMAoGCCqGSM49
BAMCMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTEUMBIGA1UECgwLRXhh
bXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRpb24xEzARBgNVBAMMCjgw
Mi4xQVIgQ0EwIBcNMTkwMTMxMTEyOTE2WhgPOTk5OTEyMzEyMzU5NTlaMFwx
CzAJBgNVBAYTAlVTMQswCQYDVQQIDAJDQTELMAkGA1UEBwwCTEExFDASBgNV
BAoMC2V4YW1wbGUgSW5jMQwwCgYDVQQLDANJb1QxDzANBgNVBAUTBld0MTIz
NDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABMi0IfEcJeR+OsVxI78tn9xJ
TwKLw1HMgMA/FQv1DP+VjXVBnYGmokXf+ueQvpXPdfYC+RUmGPgWorI7Vjjl
n9mjgYowgYcwCQYDVR0TBAIwADAdBgNVHQ4EFgQUlmANhxa/f9DnUtCsdgd3
rWZdAqAwHwYDVR0jBBgwFoAUaNFlUflRv8gqQx0Nnwi8LSBbEWAwDgYDVR0P
AQH/BAQDAgWgMCoGA1UdEQQjMCGgHwYIKwYBBQUHCASgEzARBgkrBgEEAbQ7
CgEEBAECAwQwCgYIKoZIzj0EAwIDSQAwRgIhAMDYGZbSUH1pPzxI6qXulJG9
ptshQJnZgRfGOzYTdM2GAiEAp3SYn0wyGlzyXYMqTTNqCK1n3yDxUGQhGIoK
3m00kjYxggFAMIIBPAIBATBpMF0xCzAJBgNVBAYTAlVTMQswCQYDVQQIDAJD
QTEUMBIGA1UECgwLRXhhbXBsZSBJbmMxFjAUBgNVBAsMDWNlcnRpZmljYXRp
b24xEzARBgNVBAMMCjgwMi4xQVIgQ0ECCH52Yde1TkYyMAsGCWCGSAFlAwQC
AaBpMBgGCSqGSIb3DQEJAzELBgkqhkiG9w0BBwEwHAYJKoZIhvcNAQkFMQ8X
DTE5MDQwODA3MzQxMFowLwYJKoZIhvcNAQkEMSIEIP2rKa+J8LVdwYEmB2he
uxsz05As0zoAAYkeyNqsh4fiMAoGCCqGSM49BAMCBEgwRgIhALOd2FKbe9FG
kN4Pg7FIgF+//cQv/N+v7tDZMzGBAFN0AiEAu5BI0oQ4o0wZcrDyKoU2GbeX
hlG/g+OgTUftYMJ32so=
]]></artwork></figure>

</section>
</section>
<section anchor="ra" title="requestauditing">

<t>A coaps requestauditing message contains the signed CBOR voucher :</t>

<figure><artwork><![CDATA[
    POST coaps://[2001:db8::2:1]:61616]/est/ra
    (Content-Format: application/voucher-cms+cbor)
    Payload =
TO BE FILLED
]]></artwork></figure>

<t>A 2.05 Content response returning a log of the voucher (ct=60) will then be:</t>

<figure><artwork><![CDATA[
    2.05 Content (Content-Format: application/cbor)
    Payload =
{
 "version":"1",
 "events":[
   {
    "date":"<date/time of the entry>",
    "domainID":"<domainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
    "truncated":"<the number of domainID entries truncated>"
   },
   {
    "date":"<date/time of the entry>",
    "domainID":"<anotherDomainID extracted from voucher-request>",
    "nonce":"<any nonce if supplied (or the exact string 'NULL')>"
    "assertion":"<the value from the voucher assertion leaf>"
   }
 ],
  "truncation": {
    "nonced duplicates": "<total number of entries truncated>",
    "nonceless duplicates": "<total number of entries truncated>",
    "arbitrary": "<number of domainID entries removed entirely>"
  }
}

    [EDNOTE: Change JSON to CBOR; Serialize CBOR payload to binary]
]]></artwork></figure>

</section>
</section>
<section anchor="signed-voucher-request-examples" title="Signed voucher-request examples">

<section anchor="cmssign" title="CMS signed voucher-request example">

<t>The voucher-request example, visualized in CBOR diagnostic notation in <xref target="example2"/> is shown as a hexadecimal dump of the binary file.</t>

<figure><artwork><![CDATA[
    a11909c5a90274323031362d31302d30375431393a33313a34325a0474323031
    362d31302d32315431393a33313a34325a01020d6d4a414441313233343536
    373839054401020d0f0a4401020d0f03f50674323031372d31302d30375431
    393a33313a34325a0c4401020d0f 
]]></artwork></figure>

<t>The voucher-request example has been signed by using the WT1234 certificate and key pair shown in Appendix C of <xref target="I-D.ietf-ace-coap-est"/>.
The CMS signing of the binary voucher-request leads to a binary signed voucher-request, shown with a hexadecimal representation shown in the payload of the request part of <xref target="rv"/> and <xref target="ra"/>.</t>

<t>The breakdown of the CMS signed binary voucher-request file is visualized below:</t>

<figure><artwork><![CDATA[
CMS_ContentInfo:
  contentType: pkcs7-signedData (1.2.840.113549.1.7.2)
  d.signedData:
    version: 1
    digestAlgorithms:
        algorithm: sha256 (2.16.840.1.101.3.4.2.1)
        parameter: <ABSENT>
    encapContentInfo:
      eContentType: pkcs7-data (1.2.840.113549.1.7.1)
      eContent: <ABSENT>
    certificates:
      d.certificate:
        cert_info:
          version: 2
          serialNumber: 9112578475118446130
          signature:
            algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
            parameter: <ABSENT>
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                  CN=802.1AR CA
          validity:
            notBefore: Jan 31 11:29:16 2019 GMT
            notAfter: Dec 31 23:59:59 9999 GMT
          subject: C=US, ST=CA, L=LA, O=example Inc,
                                     OU=IoT/serialNumber=Wt1234
          key:
            algor:
              algorithm: id-ecPublicKey (1.2.840.10045.2.1)
              parameter: OBJECT:prime256v1 (1.2.840.10045.3.1.7)
            public_key:  (0 unused bits)
              0000 - 04 c8 b4 21 f1 1c 25 e4-7e 3a c5 71 23 bf
              000e - 2d 9f dc 49 4f 02 8b c3-51 cc 80 c0 3f 15
              001c - 0b f5 0c ff 95 8d 75 41-9d 81 a6 a2 45 df
              002a - fa e7 90 be 95 cf 75 f6-02 f9 15 26 18 f8
              0038 - 16 a2 b2 3b 56 38 e5 9f-d9
          issuerUID: <ABSENT>
          subjectUID: <ABSENT>
          extensions:
              object: X509v3 Basic Constraints (2.5.29.19)
              critical: BOOL ABSENT
              value:
                0000 - 30
                0002 - <SPACES/NULS>

              object: X509v3 Subject Key Identifier (2.5.29.14)
              critical: BOOL ABSENT
              value:
                0000 - 04 14 96 60 0d 87 16 bf-7f d0 e7 52 d0
                000d - ac 76 07 77 ad 66 5d 02-a0

              object: X509v3 Authority Key Identifier (2.5.29.35)
              critical: BOOL ABSENT
              value:
                0000 - 30 16 80 14 68 d1 65 51-f9 51 bf c8 2a
                000d - 43 1d 0d 9f 08 bc 2d 20-5b 11 60

              object: X509v3 Key Usage (2.5.29.15)
              critical: TRUE
              value:
                0000 - 03 02 05 a0

              object: X509v3 Subject Alternative Name (2.5.29.17)
              critical: BOOL ABSENT
              value:
                0000 - 30 21 a0 1f 06 08 2b 06-01 05 05 07 08
                000d - 04 a0 13 30 11 06 09 2b-06 01 04 01 b4
                001a - 3b 0a 01 04 04 01 02 03-04
        sig_alg:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:  (0 unused bits)
          0000 - 30 46 02 21 00 c0 d8 19-96 d2 50 7d 69 3f 3c
          000f - 48 ea a5 ee 94 91 bd a6-db 21 40 99 d9 81 17
          001e - c6 3b 36 13 74 cd 86 02-21 00 a7 74 98 9f 4c
          002d - 32 1a 5c f2 5d 83 2a 4d-33 6a 08 ad 67 df 20
          003c - f1 50 64 21 18 8a 0a de-6d 34 92 36
    crls:
      <EMPTY>
    signerInfos:
        version: 1
        d.issuerAndSerialNumber:
          issuer: C=US, ST=CA, O=Example Inc, OU=certification,
                                                  CN=802.1AR CA
          serialNumber: 9112578475118446130
        digestAlgorithm:
          algorithm: sha256 (2.16.840.1.101.3.4.2.1)
          parameter: <ABSENT>
        signedAttrs:
            object: contentType (1.2.840.113549.1.9.3)
            value.set:
              OBJECT:pkcs7-data (1.2.840.113549.1.7.1)

            object: signingTime (1.2.840.113549.1.9.5)
            value.set:
              UTCTIME:Jul  3 08:53:30 2019 GMT

            object: messageDigest (1.2.840.113549.1.9.4)
            value.set:
              OCTET STRING:
                0000 - d4 b0 5c dd c8 b4 91 28-4a 18 ca 25 9d
                000d - be d0 60 23 cf ad a0 aa-c2 95 ac e9 3f
                001a - 0b 4f 44 9e 25
                0020 - <SPACES/NULS>
        signatureAlgorithm:
          algorithm: ecdsa-with-SHA256 (1.2.840.10045.4.3.2)
          parameter: <ABSENT>
        signature:
          0000 - 30 46 02 21 00 e5 e1 7f-23 c3 aa 14 9f 35 64
          000f - 1e c4 4a 0f 68 fe b0 16-3b e6 7c 06 51 af bf
          001e - 5a a0 99 59 e0 28 1f 02-21 00 b4 07 2f 7c c4
          002d - f9 26 0c 6d 47 a7 93 56-de b8 da f7 23 f0 af
          003c - 2b 59 16 cc 36 63 e7 91-89 39 df df
        unsignedAttrs:
          <EMPTY>
]]></artwork></figure>

</section>
</section>
<section anchor="cosesign" title="COSE examples">

<t>These examples are from the https://minerva.sandelman.ca/ reference code,
using the unit test case key pairs, with a flow between pledge ("reach"
code), JRC ("fountain") code, and MASA ("highway") code.  This example
comes from the spec/files/product/00-D0-E5-F2-00-03 directory.</t>

<section anchor="device-registrar-and-masa-keys" title="Device, Registrar and MASA keys">

<t>This first section documents the public and private keys used in the
subsequent test vectors below.  These keys come from test code and are not used in any
production system, and should only be used only to validate implementations.</t>

<section anchor="device-idevid-certificate" title="Device IDevID certificate">

<figure><artwork><![CDATA[
Certificate:
    Data:
        Version: 3 (0x2)
        Serial Number: 787697345 (0x2ef34ec1)
        Signature Algorithm: ecdsa-with-SHA256
        Issuer: C = Canada, ST = Ontario, OU = Sandelman, CN
 = highway-test.example.com CA
        Validity
            Not Before: Feb 14 17:05:09 2019 GMT
            Not After : Dec 31 00:00:00 2999 GMT
        Subject: serialNumber = 00-D0-E5-F2-00-03
        Subject Public Key Info:
            Public Key Algorithm: id-ecPublicKey
                Public-Key: (256 bit)
                pub:
                    04:82:c4:28:5b:7c:f0:37:18:c7:90:14:dc:c
b:f4:
                    4d:7e:b0:00:ed:c0:de:bd:4d:25:55:4e:35:f
9:d5:
                    6a:57:14:b4:94:af:ce:6d:53:c8:60:c2:ce:5
3:3f:
                    2c:1b:42:f1:c0:8b:5f:c1:7b:3d:f3:29:54:8
7:46:
                    86:a4:0c:8b:b7
                ASN1 OID: prime256v1
                NIST CURVE: P-256
        X509v3 extensions:
            X509v3 Subject Key Identifier: 
                C8:A3:87:72:82:82:E6:EA:90:D0:E1:81:BC:C7:51
:08:78:0F:D7:52
            X509v3 Basic Constraints: 
                CA:FALSE
            X509v3 Subject Alternative Name: 
                othername:<unsupported>
            1.3.6.1.4.1.46930.2: 
                ..highway-test.example.com:9443
    Signature Algorithm: ecdsa-with-SHA256
         30:65:02:31:00:b2:9a:7a:1a:74:20:8f:e9:e0:5d:fc:af:
d6:
         4a:80:1f:66:e3:bf:17:2e:3e:07:87:39:be:65:bd:94:57:
71:
         1f:df:e5:fc:4d:ef:96:8a:3a:03:5b:d1:ca:a1:72:55:a3:
02:
         30:13:43:08:a4:af:c8:28:19:d2:a0:93:3d:ed:53:fa:09:
7d:
         76:9c:b7:0b:95:2b:8f:2f:b4:fa:87:02:ec:b4:2d:19:92:
5b:
         b2:bb:79:04:63:6e:17:0e:79:8a:65:f5:a3
]]></artwork></figure>

</section>
<section anchor="device-private-key" title="Device private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIA1sa0l4bkj/rJxPUN1bKSBNYolVVzx+T28wo60cYpuaoAoGCCqGSM49
AwEHoUQDQgAEgsQoW3zwNxjHkBTcy/RNfrAA7cDevU0lVU41+dVqVxS0lK/ObVPI
YMLOUz8sG0LxwItfwXs98ylUh0aGpAyLtw==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="registrar-certificate" title="Registrar Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB0TCCAVagAwIBAgIBAjAKBggqhkjOPQQDAzBxMRIwEAYKCZImiZPyLGQBGRYC
Y2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xQDA+BgNVBAMMNyM8U3lzdGVt
VmFyaWFibGU6MHgwMDAwMDAwNGY5MTFhMD4gVW5zdHJ1bmcgRm91bnRhaW4gQ0Ew
HhcNMTcxMTA3MjM0NTI4WhcNMTkxMTA3MjM0NTI4WjBDMRIwEAYKCZImiZPyLGQB
GRYCY2ExGTAXBgoJkiaJk/IsZAEZFglzYW5kZWxtYW4xEjAQBgNVBAMMCWxvY2Fs
aG9zdDBZMBMGByqGSM49AgEGCCqGSM49AwEHA0IABJZlUHI0up/l3eZf9vCBb+lI
noEMEgc7Ro+XZCtjAI0CD1fJfJR/hIyyDmHWyYiNFbRCH9fyarfkzgX4p0zTizqj
DTALMAkGA1UdEwQCMAAwCgYIKoZIzj0EAwMDaQAwZgIxALQMNurf8tv50lROD5DQ
XHEOJJNW3QV2g9QEdDSk2MY+AoSrBSmGSNjh4olEOhEuLgIxAJ4nWfNw+BjbZmKi
IiUEcTwHMhGVXaMHY/F7n39wwKcBBSOndNPqCpOELl6bq3CZqQ==
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="jrcpriv" title="Registrar private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFZodk+PC5Mu24+ra0sbOjKzan+dW5rvDAR7YuJUOC1YoAoGCCqGSM49
AwEHoUQDQgAElmVQcjS6n+Xd5l/28IFv6UiegQwSBztGj5dkK2MAjQIPV8l8lH+E
jLIOYdbJiI0VtEIf1/Jqt+TOBfinTNOLOg==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
<section anchor="masa-certificate" title="MASA Certificate">

<figure><artwork><![CDATA[
-----BEGIN CERTIFICATE-----
MIIB3zCCAWSgAwIBAgIEG5lfVDAKBggqhkjOPQQDAjBdMQ8wDQYDVQQGEwZDYW5h
ZGExEDAOBgNVBAgMB09udGFyaW8xEjAQBgNVBAsMCVNhbmRlbG1hbjEkMCIGA1UE
AwwbaGlnaHdheS10ZXN0LmV4YW1wbGUuY29tIENBMB4XDTE5MDIxMjIyMjI0MVoX
DTIxMDIxMTIyMjI0MVowXzEPMA0GA1UEBhMGQ2FuYWRhMRAwDgYDVQQIDAdPbnRh
cmlvMRIwEAYDVQQLDAlTYW5kZWxtYW4xJjAkBgNVBAMMHWhpZ2h3YXktdGVzdC5l
eGFtcGxlLmNvbSBNQVNBMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEqgQVo0S5
4kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+gqi4tMFfSJ0iEwt8kszf
WXK4rLgJS2mnpaMQMA4wDAYDVR0TAQH/BAIwADAKBggqhkjOPQQDAgNpADBmAjEA
vVXlmw77/F6VKeOBsxU1qpMYogS+RHKyUX1NbevR1cEQOrI5e1c/xcywow7nmUa6
AjEA9n9EfbcU+tFnatQRw0uu5vuamFb6hSEuXEhM8D/ymz+uiCCnrvly/1v5eGjP
D0jJ
-----END CERTIFICATE-----
]]></artwork></figure>

</section>
<section anchor="masapriv" title="MASA private key">

<figure><artwork><![CDATA[
-----BEGIN EC PRIVATE KEY-----
MHcCAQEEIFhdd0eDdzip67kXx72K+KHGJQYJHNy8pkiLJ6CcvxMGoAoGCCqGSM49
AwEHoUQDQgAEqgQVo0S54kT4yfkbBxumdHOcHrpsqbOpMKmiMln3oB1HAW25MJV+
gqi4tMFfSJ0iEwt8kszfWXK4rLgJS2mnpQ==
-----END EC PRIVATE KEY-----
]]></artwork></figure>

</section>
</section>
<section anchor="cose-signed-requestvoucher-with-registrar-certificate-pinned" title="COSE signed requestvoucher with registrar certificate pinned">

<figure><artwork><![CDATA[
EDNote: These examples do not parse
]]></artwork></figure>

<t>This voucher request has been signed by the pledge, and has been sent to the JRC over CoAPS.  This example
uses the proximity-registrar-cert mechanism to request a voucher that
pins the certificate of the registrar.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
D1E49970A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770C5901D4308201D030820157A00
30201020204228ECD27300A06082A8648CE3D040302306E31123010060A0
992268993F22C6401191602636131193017060A0992268993F22C6401191
60973616E64656C6D616E313D303B06035504030C34666F756E7461696E2
D746573742E6578616D706C652E636F6D0A20556E737472756E6720466F7
56E7461696E20526F6F74204341301E170D3139303431363138353431315
A170D3139303531373034353431315A305331123010060A0992268993F22
C6401191602636131193017060A0992268993F22C640119160973616E646
56C6D616E3122302006035504030C19666F756E7461696E2D746573742E6
578616D706C652E636F6D3059301306072A8648CE3D020106082A8648CE3
D030107034200049665507234BA9FE5DDE65FF6F0816FE9489E810C12073
B468F97642B63008D020F57C97C947F848CB20E61D6C9888D15B4421FD7F
26AB7E4CE05F8A74CD38B3A300A06082A8648CE3D0403020367003064023
0340F4E6D0F9F702553FA53BE572ACF0EED858275B6AC75994332FB25FB3
A54411E9FA02E6F75FD1AADB7EA9A61F5409E02303E615E75C8F07432A59
0C8D48798BEDA1EB49E5E7D8E0EA118BD17A02D02F0313D144816002F756
B528ABD1B0ADB749D', h'96B82530AC57650346C2BFFB5A6CC16B28F16F
ACFE5A2FD1BCF3D5F5D62733F7F7812D67D43BE1CF9906E356FB0C2BDD36
777FD7DBAE22B8CEB07D51D8F55AD3'])
]]></artwork></figure>

<t>This is the raw binary, shown as hex dump:</t>

<figure><artwork><![CDATA[
0oRBoKBZAhyhGgAPRsKlAWlwcm94aW1pdHkCwRpdHkmXClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwxZAdQwggHQMIIBV6AD
AgECAgQijs0nMAoGCCqGSM49BAMCMG4xEjAQBgoJkiaJk/IsZAEZFgJjYTEZ
MBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjE9MDsGA1UEAww0Zm91bnRhaW4t
dGVzdC5leGFtcGxlLmNvbQogVW5zdHJ1bmcgRm91bnRhaW4gUm9vdCBDQTAe
Fw0xOTA0MTYxODU0MTFaFw0xOTA1MTcwNDU0MTFaMFMxEjAQBgoJkiaJk/Is
ZAEZFgJjYTEZMBcGCgmSJomT8ixkARkWCXNhbmRlbG1hbjEiMCAGA1UEAwwZ
Zm91bnRhaW4tdGVzdC5leGFtcGxlLmNvbTBZMBMGByqGSM49AgEGCCqGSM49
AwEHA0IABJZlUHI0up/l3eZf9vCBb+lInoEMEgc7Ro+XZCtjAI0CD1fJfJR/
hIyyDmHWyYiNFbRCH9fyarfkzgX4p0zTizowCgYIKoZIzj0EAwIDZwAwZAIw
NA9ObQ+fcCVT+lO+VyrPDu2FgnW2rHWZQzL7Jfs6VEEen6Aub3X9Gq236pph
9UCeAjA+YV51yPB0MqWQyNSHmL7aHrSeXn2ODqEYvRegLQLwMT0USBYAL3Vr
Uoq9GwrbdJ1YQJa4JTCsV2UDRsK/+1pswWso8W+s/lov0bzz1fXWJzP394Et
Z9Q74c+ZBuNW+wwr3TZ3f9fbriK4zrB9Udj1WtM=
]]></artwork></figure>

</section>
<section anchor="cose-signed-parboiled-requestvoucher" title="COSE signed parboiled requestvoucher">

<figure><artwork><![CDATA[
These example do not parse
]]></artwork></figure>

<t>This voucher request has been signed by the JRC using the private key from
<xref target="jrcpriv"/>.  Contained within this voucher request is the pledge voucher
request above.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F46C2A5016970726F78696D69747902C11A5
9DD3BFD0A5130302D44302D45352D46322D30302D303307765F715674477
738565342626C65394D34557036354C770B590266D28441A0A059021CA11
A000F46C2A5016970726F78696D69747902C11A5D1E49970A5130302D443
02D45352D46322D30302D303307765F715674477738565342626C65394D3
4557036354C770C5901D4308201D030820157A0030201020204228ECD273
00A06082A8648CE3D040302306E31123010060A0992268993F22C6401191
602636131193017060A0992268993F22C640119160973616E64656C6D616
E313D303B06035504030C34666F756E7461696E2D746573742E6578616D7
06C652E636F6D0A20556E737472756E6720466F756E7461696E20526F6F7
4204341301E170D3139303431363138353431315A170D313930353137303
4353431315A305331123010060A0992268993F22C6401191602636131193
017060A0992268993F22C640119160973616E64656C6D616E31223020060
35504030C19666F756E7461696E2D746573742E6578616D706C652E636F6
D3059301306072A8648CE3D020106082A8648CE3D0301070342000496655
07234BA9FE5DDE65FF6F0816FE9489E810C12073B468F97642B63008D020
F57C97C947F848CB20E61D6C9888D15B4421FD7F26AB7E4CE05F8A74CD38
B3A300A06082A8648CE3D04030203670030640230340F4E6D0F9F702553F
A53BE572ACF0EED858275B6AC75994332FB25FB3A54411E9FA02E6F75FD1
AADB7EA9A61F5409E02303E615E75C8F07432A590C8D48798BEDA1EB49E5
E7D8E0EA118BD17A02D02F0313D144816002F756B528ABD1B0ADB749D584
096B82530AC57650346C2BFFB5A6CC16B28F16FACFE5A2FD1BCF3D5F5D62
733F7F7812D67D43BE1CF9906E356FB0C2BDD36777FD7DBAE22B8CEB07D5
1D8F55AD3', h'EAE868ECC176883766C5DC5BA5B8DCA25DAB3C2E56A551
CE5705B793914348E1F93C2B81E88CCBE28E90800F66945EFBBECE4F741D
0EDE18EB1008EF7E9A279C'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZAq6hGgAPRsKlAWlwcm94aW1pdHkCwRpZ3Tv9ClEwMC1EMC1FNS1G
Mi0wMC0wMwd2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwtZAmbShEGgoFkCHKEa
AA9GwqUBaXByb3hpbWl0eQLBGl0eSZcKUTAwLUQwLUU1LUYyLTAwLTAzB3Zf
cVZ0R3c4VlNCYmxlOU00VXA2NUx3DFkB1DCCAdAwggFXoAMCAQICBCKOzScw
CgYIKoZIzj0EAwIwbjESMBAGCgmSJomT8ixkARkWAmNhMRkwFwYKCZImiZPy
LGQBGRYJc2FuZGVsbWFuMT0wOwYDVQQDDDRmb3VudGFpbi10ZXN0LmV4YW1w
bGUuY29tCiBVbnN0cnVuZyBGb3VudGFpbiBSb290IENBMB4XDTE5MDQxNjE4
NTQxMVoXDTE5MDUxNzA0NTQxMVowUzESMBAGCgmSJomT8ixkARkWAmNhMRkw
FwYKCZImiZPyLGQBGRYJc2FuZGVsbWFuMSIwIAYDVQQDDBlmb3VudGFpbi10
ZXN0LmV4YW1wbGUuY29tMFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAElmVQ
cjS6n+Xd5l/28IFv6UiegQwSBztGj5dkK2MAjQIPV8l8lH+EjLIOYdbJiI0V
tEIf1/Jqt+TOBfinTNOLOjAKBggqhkjOPQQDAgNnADBkAjA0D05tD59wJVP6
U75XKs8O7YWCdbasdZlDMvsl+zpUQR6foC5vdf0arbfqmmH1QJ4CMD5hXnXI
8HQypZDI1IeYvtoetJ5efY4OoRi9F6AtAvAxPRRIFgAvdWtSir0bCtt0nVhA
lrglMKxXZQNGwr/7WmzBayjxb6z+Wi/RvPPV9dYnM/f3gS1n1Dvhz5kG41b7
DCvdNnd/19uuIrjOsH1R2PVa01hA6uho7MF2iDdmxdxbpbjcol2rPC5WpVHO
VwW3k5FDSOH5PCuB6IzL4o6QgA9mlF77vs5PdB0O3hjrEAjvfponnA==
]]></artwork></figure>

</section>
<section anchor="cose-signed-voucher" title="COSE signed voucher">

<t>The resulting voucher is created by the MASA and returned via the JRC to the
Pledge.  It is signed by the MASA's private key <xref target="masapriv"/> and can be
verified by the pledge using the MASA's publie key.</t>

<t>This is the CBOR diagnostic format, folded to 60 characters:</t>

<figure><artwork><![CDATA[
18([h'A0', {}, h'A11A000F468CA505666C6F6767656406C11A5D1E499
A0E7130302D44302D45352D46322D30302D30330B765F715674477738565
342626C65394D34557036354C770C7902744D49494230544343415661674
177494241674942416A414B42676771686B6A4F50515144417A42784D524
9774541594B435A496D695A50794C4751424752594359324578475441584
2676F4A6B69614A6B2F49735A41455A46676C7A5957356B5A57787459573
4785144412B42674E5642414D4D4E794D3855336C7A64475674566D46796
1574669624755364D4867774D4441774D4441774E4759354D5446684D443
4675657357A64484A31626D6367526D3931626E526861573467513045774
868634E4D5463784D5441334D6A4D304E5449345768634E4D546B784D544
1334D6A4D304E544934576A42444D5249774541594B435A496D695A50794
C47514247525943593245784754415842676F4A6B69614A6B2F49735A414
55A46676C7A5957356B5A57787459573478456A415142674E5642414D4D4
3577876593246736147397A6444425A4D424D4742797147534D343941674
54743437147534D34394177454841304941424A5A6C5548493075702F6C3
3655A6639764342622B6C496E6F454D45676337526F2B585A43746A41493
0434431664A664A522F68497979446D48577959694E46625243483966796
172666B7A67583470307A54697A716A4454414C4D416B474131556445775
1434D414177436759494B6F5A497A6A304541774D44615141775A6749784
14C514D4E75726638747635306C524F443544515848454F4A4A4E5733515
632673951456444536B324D592B416F537242536D47534E6A68346F6C454
F6845754C674978414A346E57664E772B426A625A6D4B694969554563547
7484D68475658614D48592F46376E333977774B634242534F6E644E50714
3704F454C6C36627133435A71513D3D', h'7468FB16A4035FDAF510DBF5
A88F67B6FB849CFBA8B094B77AD5248900E4BCD6E892FE74B39AB787637B
121944BED4D1CB4B8DC8F59212EAC2AD20469C71C1F6'])
]]></artwork></figure>

<t>This is the raw binary, encoded in base64:</t>

<figure><artwork><![CDATA[
0oRBoKBZArmhGgAPRoylBWZsb2dnZWQGwRpdHkmaDnEwMC1EMC1FNS1GMi0w
MC0wMwt2X3FWdEd3OFZTQmJsZTlNNFVwNjVMdwx5AnRNSUlCMFRDQ0FWYWdB
d0lCQWdJQkFqQUtCZ2dxaGtqT1BRUURBekJ4TVJJd0VBWUtDWkltaVpQeUxH
UUJHUllDWTJFeEdUQVhCZ29Ka2lhSmsvSXNaQUVaRmdsellXNWtaV3h0WVc0
eFFEQStCZ05WQkFNTU55TThVM2x6ZEdWdFZtRnlhV0ZpYkdVNk1IZ3dNREF3
TURBd05HWTVNVEZoTUQ0Z1ZXNXpkSEoxYm1jZ1JtOTFiblJoYVc0Z1EwRXdI
aGNOTVRjeE1UQTNNak0wTlRJNFdoY05NVGt4TVRBM01qTTBOVEk0V2pCRE1S
SXdFQVlLQ1pJbWlaUHlMR1FCR1JZQ1kyRXhHVEFYQmdvSmtpYUprL0lzWkFF
WkZnbHpZVzVrWld4dFlXNHhFakFRQmdOVkJBTU1DV3h2WTJGc2FHOXpkREJa
TUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCSlpsVUhJMHVwL2wz
ZVpmOXZDQmIrbElub0VNRWdjN1JvK1haQ3RqQUkwQ0QxZkpmSlIvaEl5eURt
SFd5WWlORmJSQ0g5ZnlhcmZremdYNHAwelRpenFqRFRBTE1Ba0dBMVVkRXdR
Q01BQXdDZ1lJS29aSXpqMEVBd01EYVFBd1pnSXhBTFFNTnVyZjh0djUwbFJP
RDVEUVhIRU9KSk5XM1FWMmc5UUVkRFNrMk1ZK0FvU3JCU21HU05qaDRvbEVP
aEV1TGdJeEFKNG5XZk53K0JqYlptS2lJaVVFY1R3SE1oR1ZYYU1IWS9GN24z
OXd3S2NCQlNPbmROUHFDcE9FTGw2YnEzQ1pxUT09WEB0aPsWpANf2vUQ2/Wo
j2e2+4Sc+6iwlLd61SSJAOS81uiS/nSzmreHY3sSGUS+1NHLS43I9ZIS6sKt
IEacccH2
]]></artwork></figure>

</section>
<section anchor="cose-signed-request-voucher" title="COSE signed request voucher">

<t>The headecimal dump of request-voucher shown in <xref target="cmssign"/> is used for this example. The cose sign1 object of <xref target="fig-cose"/> provides the structure of the cose sign1 example. Using the values "kid" = 4, EDdsa = -8, "alg" = 2, COSE_Sign1 = 18, and using the same value for the "kid" parameter, the CBOR object is:</t>

<figure><artwork><![CDATA[
18([h'A10127', {4: h'4173796D6D657472696345643235353139'}, 
  h'A11909C5A90274323031362D31302D30375431393A33313A34325A04743
  23031362D31302D32315431393A33313A34325A01020D6D4A414441313233
  343536373839054401020D0F0A4401020D0F03F50674323031372D31302D3
  0375431393A33313A34325A0C4401020D0F',
h'955D82A26B7C0869EE8FE5A09EE3D68DDFFE8FE39E3BCADFA80F2F9A6E13F
  F0349A2CA131C8F6A9AAF7780BAB671F63CBB158EC17322323C1AB82B1CDC
  B62A06'])
]]></artwork></figure>

<t>The corresponding hexadecimal dump is:</t>

<figure><artwork><![CDATA[
  d28443a10127a104514173796d6d657472696345643235353139586ca119
  09c5a90274323031362d31302d30375431393a33313a34325a0474323031
  362d31302d32315431393a33313a34325a01020d6d4a4144413132333435
  36373839054401020d0f0a4401020d0f03f50674323031372d31302d3037
  5431393a33313a34325a0c4401020d0f5840955d82a26b7c0869ee8fe5a0
  9ee3d68ddffe8fe39e3bcadfa80f2f9a6e13ff0349a2ca131c8f6a9aaf77
  80bab671f63cbb158ec17322323c1ab82b1cdcb62a06
]]></artwork></figure>

</section>
</section>


  </back>

<!-- ##markdown-source:
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
8cXAX3hhFC4Cn7cD6WH+X1tBedKriQAA

-->

</rfc>

